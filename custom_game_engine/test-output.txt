
> @ai-village/game-engine@0.1.0 test
> vitest run


 RUN  v1.6.1 /Users/annhoward/src/ai_village/custom_game_engine

 âœ“ packages/core/src/components/__tests__/BehaviorQueue.test.ts  (38 tests) 5ms
 âœ“ packages/core/src/systems/__tests__/BehaviorCompletionSignaling.test.ts  (34 tests) 5ms
 âœ“ packages/core/src/buildings/__tests__/BuildingDefinitions.test.ts  (44 tests) 6ms
 âœ“ packages/core/src/__tests__/AnimalHousingCleanliness.test.ts  (24 tests) 5ms
 âœ“ packages/core/src/__tests__/AnimalHousing.test.ts  (27 tests | 5 skipped) 5ms
stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should change grass tile to dirt terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 76.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.00', phosphorus: '60.80', potassium: '68.40' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.99780830801754,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set tilled flag to true
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 79.62
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.62', phosphorus: '63.70', potassium: '71.66' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.62450957224169,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set plantability counter to 3
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 74.48
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.48', phosphorus: '59.59', potassium: '67.03' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 74.48153390232696,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set fertility based on biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 78.51
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.51', phosphorus: '62.81', potassium: '70.66' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.50665493454396,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should initialize nutrients (N, P, K) based on fertility
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 76.65
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.65', phosphorus: '61.32', potassium: '68.99' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.65143371198802,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Valid Terrain Tilling > should allow tilling grass terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 79.28
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.28', phosphorus: '63.42', potassium: '71.35' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.2807729453057,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Valid Terrain Tilling > should allow tilling dirt terrain (re-tilling)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.49
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.49', phosphorus: '61.99', potassium: '69.74' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.49248739387093,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling stone terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling stone terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling water terrain
[SoilSystem] ===== TILLING TILE AT (3, 8) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling water terrain
[SoilSystem] âŒ ERROR: Cannot till water terrain at (3,8). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling sand terrain
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 20,
  moisture: 10,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling sand terrain
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (10,10). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should NOT modify tile state on invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should NOT modify tile state on invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should emit soil:tilled event when tilling succeeds
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 77.74
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.74', phosphorus: '62.19', potassium: '69.96' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.7370972385919,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include position in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (15, 20) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 0.00 â†’ 66.62
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '66.62', phosphorus: '53.30', potassium: '59.96' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 15, y: 20 },
    fertility: 66.62081424026708,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include fertility in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 77.19
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.19', phosphorus: '61.75', potassium: '69.47' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.18724404633113,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include biome in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 0.00 â†’ 81.88
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '81.88', phosphorus: '65.51', potassium: '73.69' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 81.88141963754593,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should NOT emit soil:tilled event on invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should NOT emit soil:tilled event on invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set plains fertility to ~70-80
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 77.54
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.54', phosphorus: '62.03', potassium: '69.78' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.53544840605767,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set forest fertility to ~60-70
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 0.00 â†’ 64.89
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '64.89', phosphorus: '51.91', potassium: '58.40' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 64.88787121086926,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set river fertility to ~75-85
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 0.00 â†’ 86.69
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '86.69', phosphorus: '69.35', potassium: '78.02' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 86.68504248799204,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set desert fertility to ~20-30
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'desert',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'desert': 0.00 â†’ 25.35
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '25.35', phosphorus: '20.28', potassium: '22.82' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 25.352914775913334,
    biome: 'desert'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set mountains fertility to ~40-50
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'mountains': 0.00 â†’ 42.77
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '42.77', phosphorus: '34.22', potassium: '38.49' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 42.769374124737524,
    biome: 'mountains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set ocean fertility to 0 (not farmable)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'ocean',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'ocean': 0.00 â†’ 0.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '0.00', phosphorus: '0.00', potassium: '0.00' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: { position: { x: 5, y: 5 }, fertility: 0, biome: 'ocean' }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should throw error for undefined biome (CLAUDE.md: no silent fallbacks)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  fertility: 0,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should throw error for undefined biome (CLAUDE.md: no silent fallbacks)
[SoilSystem] âŒ CRITICAL ERROR: Tile at (5,5) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 0,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 0,
    "phosphorus": 0,
    "potassium": 0
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should allow re-tilling already tilled depleted dirt
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 70.80
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.80', phosphorus: '56.64', potassium: '63.72' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 70.79809767899037,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should reset plantability counter to 3 on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.96
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.96', phosphorus: '61.57', potassium: '69.27' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.96126684892576,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should refresh fertility on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 20,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 20.00 â†’ 76.46
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.46', phosphorus: '61.17', potassium: '68.82' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.46409870650128,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should emit tilling event on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 20,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 20.00 â†’ 77.34
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.34', phosphorus: '61.88', potassium: '69.61' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.34375318189075,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till before depletion
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 2
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till before depletion
[SoilSystem] âŒ ERROR: Tile at (5,5) is already tilled. Plantability: 2/3 uses remaining. Wait until depleted to re-till.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till with plantability=1
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 1
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till with plantability=1
[SoilSystem] âŒ ERROR: Tile at (5,5) is already tilled. Plantability: 1/3 uses remaining. Wait until depleted to re-till.

 âœ“ packages/core/src/actions/__tests__/TillAction.test.ts  (50 tests | 8 skipped) 10ms
stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should throw clear error for invalid terrain type
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should throw clear error for invalid terrain type
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include position in error message
[SoilSystem] ===== TILLING TILE AT (15, 20) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include position in error message
[SoilSystem] âŒ ERROR: Cannot till water terrain at (15,20). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include terrain type in error message
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 0,
  moisture: 10,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include terrain type in error message
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should change terrain from grass to dirt when tilled
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 73.70
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.70', phosphorus: '58.96', potassium: '66.33' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.70038650181269,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set tilled flag to true
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 73.62
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.62', phosphorus: '58.89', potassium: '66.26' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.6184224969321,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set plantability counter to 3
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 70.39
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.39', phosphorus: '56.31', potassium: '63.35' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 70.39335493017566,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set fertility based on biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.02
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.02', phosphorus: '57.62', potassium: '64.82' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 72.02157783061708,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should initialize nutrients (N, P, K)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 73.44
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.44', phosphorus: '58.75', potassium: '66.09' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.4374361400649,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 3: Tilling Validation - Valid Terrain > should successfully till grass terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.78
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.78', phosphorus: '62.23', potassium: '70.01' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.78337316351379,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 3: Tilling Validation - Valid Terrain > should successfully till dirt terrain (re-tilling)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.77
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.77', phosphorus: '63.02', potassium: '70.90' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.77426676513615,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till stone terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till stone terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till water terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till water terrain
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till sand terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till sand terrain
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT modify tile state when validation fails
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT modify tile state when validation fails
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT emit tilling event when validation fails
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT emit tilling event when validation fails
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should call SoilSystem.tillTile with correct parameters
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.21
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.21', phosphorus: '60.17', potassium: '67.69' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.20680741678598,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should use existing fertility calculation logic
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 71.31
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.31', phosphorus: '57.04', potassium: '64.17' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.30514052055433,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should initialize nutrients based on fertility
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.16
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.16', phosphorus: '62.53', potassium: '70.34' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.16026227923012,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event when tilling succeeds
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.23
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.23', phosphorus: '62.58', potassium: '70.40' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.22729365464245,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with position data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.99
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.99', phosphorus: '63.19', potassium: '71.09' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.99069773178914,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with fertility data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.60
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.60', phosphorus: '60.48', potassium: '68.04' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.60238806466931,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with biome data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 71.09
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.09', phosphorus: '56.87', potassium: '63.98' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.08641558584131,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 70-80 for plains biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 74.56
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.56', phosphorus: '59.65', potassium: '67.10' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 74.55951914244281,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 60-70 for forest biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 50.00 â†’ 60.85
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '60.85', phosphorus: '48.68', potassium: '54.77' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 60.85022029791805,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 80-90 for river biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 50.00 â†’ 82.64
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '82.64', phosphorus: '66.11', potassium: '74.38' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 82.64288084037743,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 20-30 for desert biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'desert',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'desert': 50.00 â†’ 26.54
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '26.54', phosphorus: '21.23', potassium: '23.89' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 26.543452674220763,
    biome: 'desert'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 40-50 for mountains biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'mountains': 50.00 â†’ 40.37
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '40.37', phosphorus: '32.29', potassium: '36.33' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 40.36610356278176,
    biome: 'mountains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 0 for ocean biome (not tillable)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'ocean',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'ocean': 50.00 â†’ 0.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '0.00', phosphorus: '0.00', potassium: '0.00' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: { position: { x: 5, y: 5 }, fertility: 0, biome: 'ocean' }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when tile is null/undefined
[SoilSystem] ===== TILLING TILE AT (5, 5) =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when position is invalid
[SoilSystem] ===== TILLING TILE AT (NaN, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when position is invalid
[SoilSystem] âŒ ERROR: tillTile requires valid position coordinates, got (NaN,5)

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw clear error message for invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw clear error message for invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT use fallback fertility values
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 70.47
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.47', phosphorus: '56.38', potassium: '63.43' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 70.47288493615596,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT catch and swallow errors
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT catch and swallow errors
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should allow re-tilling an already-tilled depleted tile
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 74.35
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.35', phosphorus: '59.48', potassium: '66.91' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 74.34549500458067,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 74.34549500458067,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 74.35 â†’ 71.93
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.93', phosphorus: '57.54', potassium: '64.73' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.92703523877859,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should reset plantability counter to 3 when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.69
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.69', phosphorus: '61.35', potassium: '69.02' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.69224257220425,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should refresh fertility when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 30,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 30.00 â†’ 71.28
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.28', phosphorus: '57.03', potassium: '64.15' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.28290144174692,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should emit tilling event when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.71
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.71', phosphorus: '61.37', potassium: '69.04' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.70873895396603,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should throw error when tilling tile without biome (CLAUDE.md)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should throw error when tilling tile without biome (CLAUDE.md)
[SoilSystem] âŒ CRITICAL ERROR: Tile at (5,5) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 50,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 0,
    "phosphorus": 0,
    "potassium": 0
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should handle tilling at negative coordinates
[SoilSystem] ===== TILLING TILE AT (-5, -5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.97
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.97', phosphorus: '63.18', potassium: '71.08' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: -5, y: -5 },
    fertility: 78.97482923539076,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should handle tilling at large coordinates
[SoilSystem] ===== TILLING TILE AT (1000, 1000) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.75
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.75', phosphorus: '58.20', potassium: '65.47' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 1000, y: 1000 },
    fertility: 72.74517778412698,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should preserve existing moisture when tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 75,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 79.81
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.81', phosphorus: '63.85', potassium: '71.83' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.80655830607586,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should reset fertilizer state when tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.51
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.51', phosphorus: '62.01', potassium: '69.76' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.50957905060366,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with PlantSystem (planted flag check)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.71
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.71', phosphorus: '58.17', potassium: '65.44' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 72.7146154562815,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with WaterSystem (moisture tracking)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.58
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.58', phosphorus: '62.86', potassium: '70.72' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.57943936662551,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with WeatherSystem (rain effects)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.91
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.91', phosphorus: '62.33', potassium: '70.12' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.91146436859745,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

 âœ“ packages/core/src/systems/__tests__/TillingAction.test.ts  (55 tests) 13ms
 âœ“ packages/core/src/__tests__/TamingSystem.test.ts  (17 tests) 9ms
 âœ“ packages/core/src/__tests__/AnimalHousingIntegration.test.ts  (14 tests | 1 skipped) 5ms
 âœ“ packages/core/src/systems/__tests__/SeedSystem.integration.test.ts  (35 tests) 6ms
 âœ“ packages/core/src/systems/__tests__/ResourceGathering.test.ts  (37 tests) 7ms
stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Memory Formation from Events > should automatically create memory when harvest event fires
[MemoryFormation] ðŸ§  Forming memory for agent 29a349f4-0270-4426-a105-43cbd880a7d9: {
  eventType: 'agent:harvested',
  summary: 'Harvested  wheat',
  emotionalIntensity: 0.6,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Memory Formation from Events > should create memories for both participants in conversation
[MemoryFormation] ðŸ§  Forming memory for agent d548fb12-6e6a-4778-b551-796111b88eac: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0.5,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent 2686bd47-f7f7-435a-84be-891fc6e5e6b7: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0.5,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Memory Formation from Events > should create high-importance memory for survival events
[MemoryFormation] ðŸ§  Forming memory for agent fa1a9135-240e-4f06-b885-fe1e150eb5d8: {
  eventType: 'need:critical',
  summary: 'My hunger became critically low',
  emotionalIntensity: 0.9,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Memory Formation from Events > should handle multiple events in sequence
[MemoryFormation] ðŸ§  Forming memory for agent 9e1ae1b8-0488-41b9-90b1-7a92396255b3: {
  eventType: 'agent:harvested',
  summary: 'Harvested  wheat',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent 9e1ae1b8-0488-41b9-90b1-7a92396255b3: {
  eventType: 'resource:gathered',
  summary: 'Gathered  wood',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent 9e1ae1b8-0488-41b9-90b1-7a92396255b3: {
  eventType: 'agent:sleep_start',
  summary: 'Started sleeping',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Full Memory Lifecycle > should handle complete memory lifecycle: form -> recall -> consolidate -> decay
[MemoryFormation] ðŸ§  Forming memory for agent d58920a4-3252-4230-b92e-10be4e2624c9: {
  eventType: 'agent:harvested',
  summary: 'Harvested  wheat',
  emotionalIntensity: 0.9,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Full Memory Lifecycle > should handle multiple agents with independent memory systems
[MemoryFormation] ðŸ§  Forming memory for agent 486bed76-4320-42ad-a1a4-0bf755d4f511: {
  eventType: 'agent:harvested',
  summary: 'Harvested  wheat',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent eee312ed-4a54-4663-aa62-93f4fe4c3e4c: {
  eventType: 'resource:gathered',
  summary: 'Gathered  wood',
  emotionalIntensity: 0,
  novelty: 0
}

stderr | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Error Handling > should skip events with missing agentId without crashing
[MemoryFormation] Event agent:harvested missing required agentId. Event data: { resourceType: 'wheat' }
[MemoryFormation] This is a programming error - the system emitting 'agent:harvested' events must include agentId in the event data.

 âœ“ packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts  (17 tests) 12ms
stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should automatically increment progress each tick for buildings < 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should calculate progress based on buildTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should not increment progress for completed buildings
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 2: Resource Deduction > should deduct resources from agent inventory on construction start
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 2: Resource Deduction > should deduct multiple resource types correctly
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit building:complete event when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (15, 20) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (15, 20)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 9b3d61eb

stderr | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit building:complete event when progress reaches 100%
Error in event handler for building:complete: Error: Unknown building type: "tent". Add fuel config to BuildingSystem.ts
    at BuildingSystem.getFuelConfiguration (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:130:13)
    at BuildingSystem.handleBuildingComplete (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:87:29)
    at Object.handler (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:61:12)
    at EventBusImpl.dispatchEvent (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/events/EventBus.ts:181:13)
    at EventBusImpl.flush (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/events/EventBus.ts:146:12)
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:214:16
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should mark building as complete when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (10, 10) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity e3eade05

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit event exactly once when crossing 100% threshold
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=30s, increase=33.333%)
[BuildingSystem] ðŸ—ï¸ Construction complete! campfire at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 9b81ca0b
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stderr | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit event exactly once when crossing 100% threshold
Error in event handler for building:complete: Error: Unknown building type: "campfire". Add fuel config to BuildingSystem.ts
    at BuildingSystem.getFuelConfiguration (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:130:13)
    at BuildingSystem.handleBuildingComplete (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:87:29)
    at Object.handler (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:61:12)
    at EventBusImpl.dispatchEvent (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/events/EventBus.ts:181:13)
    at EventBusImpl.flush (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/events/EventBus.ts:146:12)
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:248:16
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: workbench at (42, 84) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=60s, increase=16.667%)
[BuildingSystem] ðŸ—ï¸ Construction complete! workbench at (42, 84)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity eca79255

stderr | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
Error in event handler for building:complete: Error: Unknown building type: "workbench". Add fuel config to BuildingSystem.ts
    at BuildingSystem.getFuelConfiguration (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:130:13)
    at BuildingSystem.handleBuildingComplete (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:87:29)
    at Object.handler (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:61:12)
    at EventBusImpl.dispatchEvent (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/events/EventBus.ts:181:13)
    at EventBusImpl.flush (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/events/EventBus.ts:146:12)
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:266:16
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should create construction site when agent initiates building
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should emit construction:started event when construction begins
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should complete full construction lifecycle
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 0.0% â†’ 100.0% (deltaTime=31.000s, buildTime=30s, increase=103.333%)
[BuildingSystem] ðŸ—ï¸ Construction complete! campfire at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity dbad887e

stderr | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should complete full construction lifecycle
Error in event handler for building:complete: Error: Unknown building type: "campfire". Add fuel config to BuildingSystem.ts
    at BuildingSystem.getFuelConfiguration (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:130:13)
    at BuildingSystem.handleBuildingComplete (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:87:29)
    at Object.handler (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/BuildingSystem.ts:61:12)
    at EventBusImpl.dispatchEvent (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/events/EventBus.ts:181:13)
    at EventBusImpl.flush (/Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/events/EventBus.ts:146:12)
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:341:16
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Resource Deduction Edge Cases > should handle exact resource amounts correctly
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Resource Deduction Edge Cases > should leave excess resources in inventory
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should progress from 0% to 100% over buildTime
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 0.0% â†’ 50.0% (deltaTime=15.000s, buildTime=30s, increase=50.000%)
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 50.0% â†’ 100.0% (deltaTime=15.000s, buildTime=30s, increase=50.000%)
[BuildingSystem] ðŸ—ï¸ Construction complete! campfire at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 9fa125e4

 âœ“ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts  (28 tests) 11ms
stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should handle fractional progress increments
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Multiple Buildings Simultaneously > should handle multiple buildings under construction at once
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood
[World.initiateConstruction] Consumed resources for workbench: 20 wood
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 3 building entities (3 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (10, 10) - 0.0% â†’ 11.1% (deltaTime=5.000s, buildTime=45s, increase=11.111%)
[BuildingSystem] Construction progress: workbench at (20, 10) - 0.0% â†’ 8.3% (deltaTime=5.000s, buildTime=60s, increase=8.333%)
[BuildingSystem] Construction progress: campfire at (30, 10) - 0.0% â†’ 16.7% (deltaTime=5.000s, buildTime=30s, increase=16.667%)

 âœ“ packages/core/src/systems/__tests__/StorageDeposit.test.ts  (14 tests) 6ms
 âœ“ packages/core/src/systems/__tests__/JournalingSystem.test.ts  (22 tests | 17 skipped) 3ms
 âœ“ packages/core/src/metrics/events/__tests__/MetricEvents.test.ts  (26 tests) 5ms
 âœ“ packages/core/src/components/__tests__/EpisodicMemoryComponent.test.ts  (29 tests) 6ms
 âœ“ packages/renderer/src/__tests__/DragDropSystem.test.ts  (29 tests) 7ms
stderr | packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts > Behavior Queue Processing in AISystem > Timeout Safety > should timeout behavior after 5 minutes (300000ms)
Behavior wander timed out after 5 minutes

stderr | packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts > Behavior Queue Processing in AISystem > Timeout Safety > should log warning when behavior times out
Behavior wander timed out after 5 minutes

 âœ“ packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts  (18 tests) 6ms
 âœ“ packages/core/src/__tests__/AnimalProduction.test.ts  (15 tests) 5ms
 âœ“ packages/core/src/buildings/__tests__/CraftingStations.test.ts  (30 tests) 8ms
stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should trigger reflection when agent sleeps
[Reflection] ðŸ’­ Agent 03914cfe is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should generate reflection from today's memories
[Reflection] ðŸ’­ Agent e219b700 is reflecting on 2 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 2 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should mark important memories for consolidation
[Reflection] ðŸ’­ Agent c8b890e9 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should store reflection with timestamp
[Reflection] ðŸ’­ Agent e20f7265 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should generate coherent reflection text via LLM
[Reflection] ðŸ’­ Agent 622e06dc is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > reflection triggers > should trigger after significant event (importance > 0.7)
[Reflection] ðŸ’­ Agent e36a80bc is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > reflection triggers > should NOT reflect if no memories to reflect on
[Reflection] ðŸ’­ Agent 1b34b604 has no memories to reflect on today

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > event emission > should emit reflection:completed when done
[Reflection] ðŸ’­ Agent 8c5abbe1 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > event emission > should include agent ID in reflection:completed event
[Reflection] ðŸ’­ Agent cd1e6003 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

 âœ“ packages/core/src/systems/__tests__/ReflectionSystem.test.ts  (22 tests | 4 skipped) 7ms
 âœ“ packages/core/src/__tests__/AnimalSystem.test.ts  (18 tests) 5ms
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts  (12 tests | 12 failed) 7ms
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should query memory, navigate to location, and arrive successfully
     â†’ memorySystem is not defined
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should navigate across chunk boundaries without issues
     â†’ SteeringSystem failed for entity 4aab2817-1f74-4817-bd9e-62901ff4b1ad: Error: SteeringSystem requires Position component
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should parse gradient from speech, store it, and navigate
     â†’ gradientSystem is not defined
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should blend multiple gradients from different agents
     â†’ gradientSystem is not defined
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should verify accurate claim and increase trust
     â†’ SteeringSystem failed for entity 975cb34f-e15a-43c6-a44d-c2f21214e1a1: Error: SteeringSystem requires Position component
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should detect false claim and decrease trust
     â†’ expected 0.5 to be less than 0.5
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should form belief after 3 accurate claims from agent
     â†’ Unknown component type: EpisodicMemory. Add it to the component registry in World.ts
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should update belief confidence with new evidence
     â†’ Unknown component type: EpisodicMemory. Add it to the component registry in World.ts
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Exploration Flow: Frontier â†’ Navigate â†’ Mark Explored > should explore frontier sectors systematically
     â†’ SteeringSystem failed for entity 59b172c7-85d4-4873-a375-ce8c634d54b3: Error: SteeringSystem requires Position component
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > AC8: Epistemic Humility Emergence > should show epistemic humility after trust violations
     â†’ Unknown component type: EpisodicMemory. Add it to the component registry in World.ts
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Performance Test: 20 Agents @ 20 TPS > should handle 20 agents navigating simultaneously
     â†’ SteeringSystem failed for entity cb9b0122-9ad6-4f38-ab85-840080c3df91: Error: SteeringSystem requires Position component
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Performance Test: 20 Agents @ 20 TPS > should handle 20 agents with full navigation stack
     â†’ memorySystem is not defined
stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance construction progress based on time elapsed
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance different buildings at different rates based on buildTime
[BuildingSystem] Processing 2 building entities (2 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should clamp progress to 100% maximum
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% â†’ 100.0% (deltaTime=1000.000s, buildTime=45s, increase=2222.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity cee8f4fa

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should skip completed buildings
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should handle multiple simultaneous constructions
[BuildingSystem] Processing 3 building entities (3 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 0.0% â†’ 11.1% (deltaTime=5.000s, buildTime=45s, increase=11.111%)
[BuildingSystem] Construction progress: workbench at (10, 0) - 0.0% â†’ 8.3% (deltaTime=5.000s, buildTime=60s, increase=8.333%)
[BuildingSystem] Construction progress: campfire at (20, 0) - 0.0% â†’ 16.7% (deltaTime=5.000s, buildTime=30s, increase=16.667%)

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should mark building as complete when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 3d72b570

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit "building:complete" event on completion
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (16, 32) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (16, 32)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity afa10353

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit event with correct entity ID and building type
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (0, 0) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=30s, increase=33.333%)
[BuildingSystem] ðŸ—ï¸ Construction complete! campfire at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 44f0e525

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should only emit event once when crossing 100% threshold
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 7df33ba4
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when entity missing BuildingComponent
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when entity missing PositionComponent
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when building type is unknown
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle construction at exactly 100% progress
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle progress from 99% to 101% (clamped to 100%)
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% â†’ 100.0% (deltaTime=1000.000s, buildTime=45s, increase=2222.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity b8b3926c

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle zero deltaTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Integration with Building Types > should use correct buildTime for each building type
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

 âœ“ packages/core/src/systems/__tests__/ConstructionProgress.test.ts  (27 tests) 6ms
stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Sequential Execution > should advance queue when behavior completes
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Critical Need Interruption > should pause queue when hunger drops below 10
[AISystem] Queue processing - autonomicResult: { behavior: 'seek_food' } queuePaused: undefined hunger: 5 energy: 50
[AISystem] Autonomic interrupt - hasQueue: true hasBehaviorQueue: true queuePaused: undefined
[AISystem] After update - queuePaused: true queueInterruptedBy: seek_food

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Critical Need Interruption > should resume queue when hunger rises above 40
[AISystem] Queue processing - autonomicResult: { behavior: 'seek_food' } queuePaused: true hunger: 5 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: true hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: false hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: false hunger: 50 energy: 50

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Critical Need Interruption > should pause queue when energy drops to zero
[AISystem] Queue processing - autonomicResult: { behavior: 'forced_sleep' } queuePaused: undefined hunger: 50 energy: 0
[AISystem] Autonomic interrupt - hasQueue: true hasBehaviorQueue: true queuePaused: undefined
[AISystem] After update - queuePaused: true queueInterruptedBy: forced_sleep

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Queue Lifecycle > should emit agent:queue:completed event when queue finishes
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50

 âœ“ packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts  (12 tests) 6ms
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts  (18 tests | 9 failed) 8ms
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should verify resource claim when agent arrives at location
     â†’ expected 0.5 to be greater than 0.5
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect stale information (resource depleted)
     â†’ expected 0.5 to be close to 0.4, received difference is 0.09999999999999998, but expected 0.005
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect misidentified resources
     â†’ expected 0.5 to be close to 0.1, received difference is 0.4, but expected 0.005
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect false reports (no resource at all)
     â†’ expected 0.5 to be close to 0.3, received difference is 0.2, but expected 0.005
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect pattern of unreliable information
     â†’ expected 0.5 to be less than 0.2
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC7: Trust Affects Cooperation - Public Callouts > should broadcast correction for false information
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification range > should verify when agent reaches claimed location
     â†’ expected 0.5 to be greater than 0.5
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_verified event for correct claims
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_violated event for false claims
     â†’ expected 0 to be greater than 0
 âœ“ packages/core/src/buildings/__tests__/PlacementValidator.test.ts  (22 tests) 6ms
stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory automatically on significant event
[MemoryFormation] ðŸ§  Forming memory for agent 9a07161d-c304-40ca-90f8-3194dca78b94: {
  eventType: 'harvest:first',
  summary: 'Harvested first wheat',
  emotionalIntensity: 0.8,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on high emotional intensity (>0.6)
[MemoryFormation] ðŸ§  Forming memory for agent eb9d788a-652d-4ce3-b38e-56626a7e85df: {
  eventType: 'social:conflict',
  summary: 'Had a conflict with bob-123',
  emotionalIntensity: 0.9,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on high novelty
[MemoryFormation] ðŸ§  Forming memory for agent c39c6aca-b068-46e7-966f-62e9bcfbb7f9: {
  eventType: 'discovery:location',
  summary: 'Discovered a new location',
  emotionalIntensity: 0,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on survival threat
[MemoryFormation] ðŸ§  Forming memory for agent 7f9480db-53e1-409b-91a7-ba55d5bce75b: {
  eventType: 'need:critical',
  summary: 'My health became critically low',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on emotional intensity > 0.6
[MemoryFormation] ðŸ§  Forming memory for agent 40cece5e-4402-4af3-9343-488ef60ae8ba: {
  eventType: 'agent:emotion_peak',
  summary: 'Felt strong joy',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on novelty > 0.7
[MemoryFormation] ðŸ§  Forming memory for agent 2a2bb402-5a9d-41a7-b561-a40aa008f7f3: {
  eventType: 'event:novel',
  summary: 'Experienced something completely new',
  emotionalIntensity: 0,
  novelty: 0.8
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on social significance > 0.5
[MemoryFormation] ðŸ§  Forming memory for agent aa1051ca-f556-4ac8-89f9-a18f874be7c3: {
  eventType: 'social:interaction',
  summary: 'Interacted with alice-123',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on survival relevance > 0.5
[MemoryFormation] ðŸ§  Forming memory for agent 74ec82d0-5519-429a-9c72-c5b613723039: {
  eventType: 'survival:close_call',
  summary: 'Close call with starvation',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on goal relevance > 0.7
[MemoryFormation] ðŸ§  Forming memory for agent 5e204853-4625-4428-b691-2effeaa006f4: {
  eventType: 'goal:progress',
  summary: 'Made progress on build-house',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight emotional intensity at 30%
[MemoryFormation] ðŸ§  Forming memory for agent 8bbf8386-73c4-4109-a8dd-86198b9e00b2: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 1,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight novelty at 30%
[MemoryFormation] ðŸ§  Forming memory for agent 2435e019-d7ea-4480-87de-145f5db2b8bf: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0.8
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight goal relevance at 20%
[MemoryFormation] ðŸ§  Forming memory for agent 57daa928-d81a-4276-bef8-c28d40cfc16e: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight social significance at 15%
[MemoryFormation] ðŸ§  Forming memory for agent 71aaaae0-749e-4afe-8e4e-279664b1463b: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight survival relevance at 25%
[MemoryFormation] ðŸ§  Forming memory for agent b453c5e6-63fb-4370-b789-2b85810ba42f: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should combine all factors correctly
[MemoryFormation] ðŸ§  Forming memory for agent baf7d93c-052e-4975-b9e0-b7e67b49e14c: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0.8,
  novelty: 0.85
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should form memory when agent speaks
[MemoryFormation] ðŸ§  Forming memory for agent d76ac380-69fd-4756-877c-4504ef205e5f: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should form memory when agent listens
[MemoryFormation] ðŸ§  Forming memory for agent 69bd38ac-6ce2-4718-be82-d025eb7682c2: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should preserve dialogue text in memory
[MemoryFormation] ðŸ§  Forming memory for agent ac2d672d-c06b-4222-8d5e-ce9a6c93e564: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should reference same conversation in both memories
[MemoryFormation] ðŸ§  Forming memory for agent b1f292ee-5940-4ad6-81f2-5d9ae2800013: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent f6a58a65-bc71-4954-9f4a-481c00d5fefb: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > event emission > should emit memory:formed event when memory created
[MemoryFormation] ðŸ§  Forming memory for agent 0a414b6e-3611-444b-a9d9-a4b86ef8cfe2: {
  eventType: 'harvest:first',
  summary: 'Harvested first crop',
  emotionalIntensity: 0.8,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > event emission > should include agent ID in memory:formed event
[MemoryFormation] ðŸ§  Forming memory for agent 29617629-2397-4d8e-b263-b67c639ac3f3: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0.7,
  novelty: 0
}

stderr | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > error handling > should throw if agent has no EpisodicMemoryComponent
[MemoryFormation] Agent 1f9d692d-8132-48b0-aa89-3a2210ed7f0c missing EpisodicMemoryComponent
[MemoryFormation] Agent has components: []
[MemoryFormation] Event that triggered memory formation: [
  {
    eventType: 'test:event',
    data: {
      agentId: '1f9d692d-8132-48b0-aa89-3a2210ed7f0c',
      emotionalIntensity: 0.8
    }
  }
]

 âœ“ packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts  (25 tests) 8ms
 âœ“ packages/core/src/systems/__tests__/Phase9-SoilWeatherIntegration.test.ts  (39 tests) 5ms
 âœ“ packages/core/src/buildings/__tests__/BuildingPlacement.integration.test.ts  (14 tests) 6ms
stdout | packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > WeatherSystem > should update weather duration over time
[WeatherSystem] Weather changed: clear â†’ clear (intensity: 0%). Temp modifier: 0.0Â°C, Movement modifier: 100%

 âœ“ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts  (19 tests) 7ms
 âœ“ packages/core/src/components/__tests__/SocialMemoryComponent.test.ts  (22 tests) 5ms
 âœ“ packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts  (21 tests) 5ms
 âœ“ packages/core/src/__tests__/WildAnimalSpawning.test.ts  (19 tests) 7ms
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts  (7 tests | 7 failed) 6ms
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should emit events in correct order: time â†’ weather â†’ temperature
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should apply weather temperature modifiers to ambient temperature
     â†’ Cannot read properties of undefined (reading 'currentTemp')
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should show temperature variation over day/night cycle
     â†’ Cannot read properties of undefined (reading 'currentTemp')
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should weather transitions affect temperature over time
     â†’ Cannot read properties of undefined (reading 'currentTemp')
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should handle snow weather with extreme cold temperatures
     â†’ Cannot read properties of undefined (reading 'currentTemp')
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should time speed multiplier affect weather duration correctly
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should thermal inertia prevent instant temperature changes
     â†’ Cannot read properties of undefined (reading 'currentTemp')
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts  (16 tests | 8 failed | 2 skipped) 9ms
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC3: Exploration Covers Territory > should identify frontier sectors correctly
     â†’ expected undefined not to be undefined
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC3: Exploration Covers Territory > should create spiral pattern when exploring
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > frontier exploration algorithm > should prioritize closest frontier sectors
     â†’ expected undefined not to be undefined
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > frontier exploration algorithm > should mark sectors as explored when visited
     â†’ expected false to be true // Object.is equality
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > frontier exploration algorithm > should switch to new frontier target when current reached
     â†’ expected { x: 96, y: 80 } to not deeply equal { x: 96, y: 80 }
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for invalid exploration mode
     â†’ expected [Function] to throw an error
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing home base in spiral mode
     â†’ expected [Function] to throw an error
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > exploration coverage metrics > should emit event when coverage milestone reached
     â†’ expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/AnimalComplete.integration.test.ts  (10 tests | 1 failed) 7ms
   â¯ packages/core/src/systems/__tests__/AnimalComplete.integration.test.ts > AnimalSystem + AnimalProductionSystem + AnimalHousingSystem Integration > should critical hunger cause health loss
     â†’ expected 100 to be less than 100
 âœ“ packages/core/src/buildings/__tests__/BuildingBlueprintRegistry.test.ts  (16 tests) 4ms
 â¯ packages/core/src/systems/__tests__/TamingComplete.integration.test.ts  (9 tests | 2 failed) 8ms
   â¯ packages/core/src/systems/__tests__/TamingComplete.integration.test.ts > TamingSystem + AnimalSystem + InventorySystem Integration > should failed taming still increase trust
     â†’ Unknown animal species: wolf
   â¯ packages/core/src/systems/__tests__/TamingComplete.integration.test.ts > TamingSystem + AnimalSystem + InventorySystem Integration > should taming emit animal_tamed event on success
     â†’ expected +0 to be 1 // Object.is equality
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts  (13 tests | 12 failed) 9ms
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should move agent toward target position (seek behavior)
     â†’ SteeringSystem failed for entity 46fbbb6f-fe2d-401e-b7b0-768eff894ae0: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should slow down when approaching target (arrive behavior)
     â†’ SteeringSystem failed for entity b7005a17-251c-4abb-bbc4-17304419d27b: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should stop when reaching target within tolerance
     â†’ SteeringSystem failed for entity ec1fdfc1-af06-4f0c-ac67-435219586b11: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should avoid obstacles using ray-casting
     â†’ SteeringSystem failed for entity b9d78c41-09f5-4a8f-80fa-0b9573a0f00c: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should navigate across chunk boundaries
     â†’ SteeringSystem failed for entity 00ec4c97-5bcd-44ce-bed3-375e092f93d4: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > wander behavior > should produce coherent wandering (not random jitter)
     â†’ SteeringSystem failed for entity 05ef7c5d-1813-413b-a016-3f37be043153: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > steering force calculation > should limit steering force to maxForce
     â†’ SteeringSystem failed for entity 0bbc1aa1-ffe1-4ff6-9403-7335d900bff2: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > steering force calculation > should limit velocity to maxSpeed
     â†’ SteeringSystem failed for entity 7c36998a-bbd1-4563-9e0e-b87faad3a755: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing target in seek behavior
     â†’ expected [Function] to throw error including 'target' but got 'SteeringSystem failed for entity bc82â€¦'
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for invalid behavior type
     â†’ expected [Function] to throw error including 'behavior' but got 'SteeringSystem failed for entity 7e38â€¦'
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing Velocity component
     â†’ expected [Function] to throw error including 'Velocity' but got 'SteeringSystem failed for entity ed2bâ€¦'
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > combined behaviors > should blend seek and obstacle avoidance
     â†’ SteeringSystem failed for entity 844def7e-9a5a-47a7-a27e-0b3fe0242a17: Error: SteeringSystem requires Position component
stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define all 12 action tools
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'wander',
  thinking: 'test...',
  speaking: '(silent)',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define tools with no parameters
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define tools with no parameters
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should parse structured response with tool call
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'explore',
  thinking: 'I should explore...',
  speaking: 'Let me look around!',
  tokensUsed: 150
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should handle empty thinking field
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'rest',
  thinking: '(no thoughts)',
  speaking: 'Time to rest',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should handle empty speaking (silent action)
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'wander',
  thinking: 'Just going to wander...',
  speaking: '(silent)',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should fall back to text when no tool call
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: 'I will explore the area',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use /api/chat endpoint
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use /api/chat endpoint
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should send correct request format
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should send correct request format
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use default values when not specified
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use default values when not specified
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should throw on HTTP error
[OllamaProvider] Ollama generate error: Error: Ollama API error: 500 Internal Server Error
    at OllamaProvider.generate (/Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/OllamaProvider.ts:142:15)
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/__tests__/OllamaProvider.test.ts:255:7
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:11)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7
    at withEnv (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:83:5)
[OllamaProvider] Error details: {
  message: 'Ollama API error: 500 Internal Server Error',
  model: 'qwen3:4b',
  url: 'http://localhost:11434/api/generate'
}

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should throw on network error
[OllamaProvider] Ollama generate error: Error: Network error
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/__tests__/OllamaProvider.test.ts:260:51
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7
[OllamaProvider] Error details: {
  message: 'Network error',
  model: 'qwen3:4b',
  url: 'http://localhost:11434/api/generate'
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should log empty responses
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

 âœ“ packages/core/src/systems/__tests__/TimeSpeedControls.test.ts  (20 tests) 4ms
 âœ“ packages/llm/src/__tests__/OllamaProvider.test.ts  (15 tests) 9ms
 âœ“ packages/core/src/crafting/__tests__/RecipeRegistry.test.ts  (15 tests) 4ms
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts  (7 tests | 5 failed) 7ms
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should apply steering forces to velocity which affects movement
     â†’ SteeringSystem failed for entity 4b3111e8-345f-4886-9c0a-1a3593c2268d: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should handle obstacle avoidance with buildings
     â†’ Cannot read properties of undefined (reading 'velocityX')
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should arrive behavior slow down near target
     â†’ SteeringSystem failed for entity 61f891cc-b056-4a9b-bc40-ac2a207ef3d5: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should wander behavior create random movement
     â†’ SteeringSystem failed for entity 44f555dd-3b04-4561-8cde-66f8958face2: Error: SteeringSystem requires Position component
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should combined steering behavior use obstacle avoidance
     â†’ SteeringSystem failed for entity 4ab98676-3510-4106-aec6-40c5a711ed16: Error: SteeringSystem requires Position component
stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should track construction progress over time
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should emit building:complete event when construction finishes
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should initialize fuel for forge buildings on completion
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: forge at (10, 10) - 99.0% â†’ 100.0% (deltaTime=2.000s, buildTime=120s, increase=1.667%)
[BuildingSystem] ðŸ—ï¸ Construction complete! forge at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity ebbb7454

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should resources regenerate over time for gathering
[ResourceGatheringSystem] berry regenerated +3.0 (now 8.0/10) on entity b4dc94b8-9c82-488d-a34b-6a5ec45287df

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should resources not regenerate beyond max amount
[ResourceGatheringSystem] wood regenerated +50.0 (now 10.0/10) on entity 16c69eb6-7478-4225-8313-22475538c567
[ResourceGatheringSystem] wood fully regenerated to 10 on entity 16c69eb6-7478-4225-8313-22475538c567

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should emit resource:regenerated event when fully regenerated
[ResourceGatheringSystem] stone regenerated +3.0 (now 10.0/10) on entity 3bbb9d5e-d96d-4b3e-85e6-f7a5b1945b87
[ResourceGatheringSystem] stone fully regenerated to 10 on entity 3bbb9d5e-d96d-4b3e-85e6-f7a5b1945b87

 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts  (9 tests | 4 failed) 6ms
   â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should track construction progress over time
     â†’ Unknown building type: shelter. Cannot determine construction time.
   â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should emit building:complete event when construction finishes
     â†’ Unknown building type: shelter. Cannot determine construction time.
   â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should building placement confirmed event create building entity
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should construction progress be calculated based on buildTime
     â†’ expected 27.77777777777778 to be greater than 40
stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should construction progress be calculated based on buildTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: workshop at (10, 10) - 0.0% â†’ 27.8% (deltaTime=50.000s, buildTime=180s, increase=27.778%)

 âœ“ packages/core/src/parsers/__tests__/GradientParser.test.ts  (31 tests) 7ms
 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts  (9 tests | 8 failed) 7ms
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should propagate events to multiple listening systems
     â†’ Cannot read properties of undefined (reading 'subscribe')
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should maintain event ordering: time â†’ weather â†’ temperature
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should not drop events under rapid emission
     â†’ expected +0 to be 100 // Object.is equality
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should include required fields in event payloads
     â†’ expected +0 to be 1 // Object.is equality
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should allow event listeners to modify world state
     â†’ expected 100 to be 50 // Object.is equality
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should support multiple subscribers to same event
     â†’ expected false to be true // Object.is equality
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should properly unsubscribe event listeners
     â†’ expected +0 to be 1 // Object.is equality
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should handle events with complex data payloads
     â†’ expected +0 to be 1 // Object.is equality
stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants advance growth over time
[PlantSystem] Active with 2 plants, accumulated 1800.00 game hours
[PlantSystem] Hourly update for 2 plants (accumulated 1800.00 hours)

stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plant health affect growth rate
[PlantSystem] Active with 3 plants, accumulated 1800.00 game hours
[PlantSystem] Hourly update for 3 plants (accumulated 1800.00 hours)

stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants emit stage transition events
[PlantSystem] Active with 2 plants, accumulated 500.00 game hours
[PlantSystem] Hourly update for 2 plants (accumulated 500.00 hours)

stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should multiple plants update independently
[PlantSystem] Active with 3 plants, accumulated 1800.00 game hours
[PlantSystem] Hourly update for 3 plants (accumulated 1800.00 hours)

stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should dead plants not grow
[PlantSystem] Active with 2 plants, accumulated 1800.00 game hours
[PlantSystem] Hourly update for 2 plants (accumulated 1800.00 hours)

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should tilling grass create farmable soil
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 80,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 80.00 â†’ 71.26
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.26', phosphorus: '57.01', potassium: '64.14' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 10, y: 10 },
    fertility: 71.2644450245472,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should tilling require grass or dirt terrain
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should tilling require grass or dirt terrain
[SoilSystem] âŒ ERROR: Cannot till water terrain at (10,10). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should prevent re-tilling already tilled soil with plantability remaining
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: true,
  biome: 'plains',
  fertility: 80,
  moisture: 50,
  plantability: 2
}

stderr | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should prevent re-tilling already tilled soil with plantability remaining
[SoilSystem] âŒ ERROR: Tile at (10,10) is already tilled. Plantability: 2/3 uses remaining. Wait until depleted to re-till.

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should allow re-tilling when soil is depleted
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: true,
  biome: 'plains',
  fertility: 80,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 80.00 â†’ 76.32
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.32', phosphorus: '61.06', potassium: '68.69' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 10, y: 10 },
    fertility: 76.32184932516702,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should require biome data for tilling
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  fertility: 80,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should require biome data for tilling
[SoilSystem] âŒ CRITICAL ERROR: Tile at (10,10) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 80,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 50,
    "phosphorus": 50,
    "potassium": 50
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts  (9 tests | 5 failed) 7ms
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants advance growth over time
     â†’ Plant hydration not set - required for lifecycle
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plant health affect growth rate
     â†’ Plant hydration not set - required for lifecycle
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants emit stage transition events
     â†’ Plant hydration not set - required for lifecycle
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should multiple plants update independently
     â†’ Plant hydration not set - required for lifecycle
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should dead plants not grow
     â†’ Plant hydration not set - required for lifecycle
 â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts  (13 tests | 2 failed) 7ms
   â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should weather system emit rain events that affect soil
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should soil system track daily updates
     â†’ Cannot set property tick of #<WorldImpl> which has only a getter
stderr | packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should hunger not decay during sleep
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!
[NeedsSystem] Entity 7ea21c3d-757b-43b7-8555-91eb1f3f972d has no needs component!

 â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts  (7 tests | 3 failed) 7ms
   â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should hunger not decay during sleep
     â†’ expected 0 to be greater than or equal to 75
   â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should extreme cold temperature damage health
     â†’ Cannot read properties of undefined (reading 'currentTemp')
   â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should temperature extremes increase needs decay when awake
     â†’ Cannot read properties of undefined (reading 'currentTemp')
 âœ“ packages/core/src/systems/__tests__/SoilSystem.test.ts  (27 tests) 6ms
stdout | packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts > AnimalHousingSystem + AnimalSystem + BuildingSystem Integration > should building system integrate with housing system
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

 â¯ packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts  (9 tests | 1 failed) 6ms
   â¯ packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts > AnimalHousingSystem + AnimalSystem + BuildingSystem Integration > should building system integrate with housing system
     â†’ Unknown building type: chicken_coop. Cannot determine construction time.
 âœ“ packages/core/src/components/__tests__/BuildingComponent.test.ts  (35 tests) 6ms
 âœ“ packages/core/src/systems/__tests__/FertilizerAction.test.ts  (26 tests) 5ms
 âœ“ packages/core/src/components/__tests__/BeliefComponent.test.ts  (17 tests) 4ms
 âœ“ packages/core/src/components/__tests__/SemanticMemoryComponent.test.ts  (18 tests) 4ms
stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should build complete prompt with all sections
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should include personality traits in prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should describe hunger levels correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should describe energy levels correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should include heard speech in prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1' ],
  seenAgentsCount: 1,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should not show hearing section when no speech
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1' ],
  seenAgentsCount: 1,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should show agents present even if silent
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1', 'agent2' ],
  seenAgentsCount: 2,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should not show empty memories section
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should show memories when present
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should show empty area when nothing nearby
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > instruction clarity > should include "don't overthink" instruction
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > instruction clarity > should end with response prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe trees when wood resources are visible
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'tree1', 'tree2' ],
  seenResourcesCount: 2,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

 âœ“ packages/llm/src/__tests__/StructuredPromptBuilder.test.ts  (15 tests) 5ms
 âœ“ packages/core/src/systems/__tests__/CraftingComplete.integration.test.ts  (10 tests) 3ms
stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe rocks when stone resources are visible
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'rock1' ],
  seenResourcesCount: 1,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe mixed resources correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'tree1', 'rock1', 'food1' ],
  seenResourcesCount: 3,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

 âœ“ packages/core/src/components/__tests__/SocialGradientComponent.test.ts  (17 tests) 4ms
 âœ“ packages/core/src/components/__tests__/ExplorationStateComponent.test.ts  (23 tests) 4ms
 âœ“ packages/core/src/__tests__/AnimalComponent.test.ts  (8 tests) 3ms
 âœ“ packages/core/src/systems/__tests__/AnimalSpawning.integration.test.ts  (10 tests) 3ms
stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce seeds when transitioning vegetative â†’ mature

Test: Plant created - stage=vegetative, seedsProduced=0
Emitting time:day_changed event
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
After emit - daySkipCount should be > 0
Calling plantSystem.update with entities: 1
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] c98022b4: Age increased by 1.0000 days (5.00 â†’ 6.00) from 24.00 hours
[PlantSystem] c98022b4: Test Plant (vegetative) age=6.0d progress=120% health=100
[PlantSystem] c98022b4: test-plant stage vegetative â†’ mature (age=6.0d, health=100)
[PlantSystem] c98022b4: Executing 1 transition effect(s) for vegetative â†’ mature
[PlantSystem] c98022b4: Plant state before effects - seedsProduced=0, flowerCount=0, fruitCount=0
[PlantSystem] c98022b4: Processing effect: produce_seeds
[PlantSystem] c98022b4: produce_seeds effect START - plant.seedsProduced=0
[PlantSystem] c98022b4: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 0 â†’ 10
[PlantSystem] c98022b4: All effects complete - seedsProduced=10, flowerCount=0, fruitCount=0
Test: After update - stage=mature, seedsProduced=10

stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce MORE seeds when transitioning mature â†’ seeding

Test: Plant created - stage=mature, seedsProduced=10
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 690c52a5: Age increased by 1.0000 days (10.00 â†’ 11.00) from 24.00 hours
[PlantSystem] 690c52a5: Test Plant (mature) age=11.0d progress=133% health=100
[PlantSystem] 690c52a5: test-plant stage mature â†’ seeding (age=11.0d, health=100)
[PlantSystem] 690c52a5: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] 690c52a5: Plant state before effects - seedsProduced=10, flowerCount=0, fruitCount=0
[PlantSystem] 690c52a5: Processing effect: produce_seeds
[PlantSystem] 690c52a5: produce_seeds effect START - plant.seedsProduced=10
[PlantSystem] 690c52a5: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 10 â†’ 20
[PlantSystem] 690c52a5: Processing effect: drop_seeds
[PlantSystem] 690c52a5: disperseSeeds called - plant.seedsProduced=20, count param=undefined
[PlantSystem] 690c52a5: Dispersing 6 seeds in 3-tile radius
[PlantSystem] 690c52a5: Dispersed seed at (2.0, -1.0)
[PlantSystem] 690c52a5: Dispersed seed at (0.0, -1.0)
[PlantSystem] 690c52a5: Dispersed seed at (-2.0, -2.0)
[PlantSystem] 690c52a5: Placed 3/6 seeds in 3-tile radius (14 remaining)
[PlantSystem] 690c52a5: All effects complete - seedsProduced=14, flowerCount=0, fruitCount=0
Test: After update - stage=seeding, seedsProduced=14

stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce seeds correctly through full lifecycle vegetative â†’ mature â†’ seeding

Test: Initial - stage=vegetative, seedsProduced=0
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] e7c6c3c8: Age increased by 1.0000 days (5.00 â†’ 6.00) from 24.00 hours
[PlantSystem] e7c6c3c8: Test Plant (vegetative) age=6.0d progress=120% health=100
[PlantSystem] e7c6c3c8: test-plant stage vegetative â†’ mature (age=6.0d, health=100)
[PlantSystem] e7c6c3c8: Executing 1 transition effect(s) for vegetative â†’ mature
[PlantSystem] e7c6c3c8: Plant state before effects - seedsProduced=0, flowerCount=0, fruitCount=0
[PlantSystem] e7c6c3c8: Processing effect: produce_seeds
[PlantSystem] e7c6c3c8: produce_seeds effect START - plant.seedsProduced=0
[PlantSystem] e7c6c3c8: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 0 â†’ 10
[PlantSystem] e7c6c3c8: All effects complete - seedsProduced=10, flowerCount=0, fruitCount=0
Test: After vegetative â†’ mature - stage=mature, seedsProduced=10
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] e7c6c3c8: Age increased by 1.0000 days (6.00 â†’ 7.00) from 24.00 hours
[PlantSystem] e7c6c3c8: Test Plant (mature) age=7.0d progress=133% health=100
[PlantSystem] e7c6c3c8: test-plant stage mature â†’ seeding (age=7.0d, health=100)
[PlantSystem] e7c6c3c8: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] e7c6c3c8: Plant state before effects - seedsProduced=10, flowerCount=0, fruitCount=0
[PlantSystem] e7c6c3c8: Processing effect: produce_seeds
[PlantSystem] e7c6c3c8: produce_seeds effect START - plant.seedsProduced=10
[PlantSystem] e7c6c3c8: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 10 â†’ 20
[PlantSystem] e7c6c3c8: Processing effect: drop_seeds
[PlantSystem] e7c6c3c8: disperseSeeds called - plant.seedsProduced=20, count param=undefined
[PlantSystem] e7c6c3c8: Dispersing 6 seeds in 3-tile radius
[PlantSystem] e7c6c3c8: Dispersed seed at (0.0, -3.0)
[PlantSystem] e7c6c3c8: Dispersed seed at (-2.0, -3.0)
[PlantSystem] e7c6c3c8: Dispersed seed at (0.0, 1.0)
[PlantSystem] e7c6c3c8: Dispersed seed at (-2.0, -1.0)
[PlantSystem] e7c6c3c8: Placed 4/6 seeds in 3-tile radius (14 remaining)
[PlantSystem] e7c6c3c8: All effects complete - seedsProduced=14, flowerCount=0, fruitCount=0
Test: After mature â†’ seeding - stage=seeding, seedsProduced=14

 âœ“ packages/core/src/__tests__/PlantSeedProduction.test.ts  (3 tests) 5ms
 âœ“ packages/renderer/src/__tests__/GhostPreview.test.ts  (19 tests) 6ms
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts  (6 tests | 6 failed) 7ms
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should handle AI behavior updates with behavior queue
     â†’ Cannot read properties of undefined (reading 'lastThinkTick')
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should respect think interval before updating behavior
     â†’ Cannot read properties of undefined (reading 'lastThinkTick')
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should transition hungry agent to seek_food behavior
     â†’ Cannot read properties of undefined (reading 'lastThinkTick')
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should handle behavior queue timeouts
     â†’ Cannot set property tick of #<WorldImpl> which has only a getter
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should enforce LLM rate limiting
     â†’ Cannot set property tick of #<WorldImpl> which has only a getter
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should process behavior queue in FIFO order
     â†’ Cannot read properties of undefined (reading 'lastThinkTick')
 âœ“ packages/core/src/components/__tests__/InventoryComponent.test.ts  (16 tests) 3ms
 âœ“ packages/core/src/systems/__tests__/SleepSystem.integration.test.ts  (5 tests) 3ms
 âœ“ packages/core/src/systems/__tests__/SoilDepletion.test.ts  (14 tests) 5ms
 âœ“ packages/world/src/chunks/__tests__/Tile.test.ts  (10 tests) 2ms
 âœ“ packages/core/src/components/__tests__/TrustNetworkComponent.test.ts  (18 tests) 7ms
 âœ“ packages/world/src/chunks/__tests__/Chunk.test.ts  (16 tests) 5ms
 âœ“ packages/core/src/systems/__tests__/HearingSystem.test.ts  (5 tests) 4ms
 âœ“ packages/core/src/systems/__tests__/SleepSystem.test.ts  (17 tests) 3ms
 âœ“ packages/core/src/crafting/__tests__/CraftingSystem.test.ts  (14 tests) 5ms
 âœ“ packages/core/src/components/__tests__/SpatialMemoryComponent.test.ts  (12 tests) 3ms
 âœ“ packages/world/src/terrain/__tests__/PerlinNoise.test.ts  (10 tests) 4ms
 âœ“ packages/core/src/events/__tests__/EventBus.test.ts  (10 tests) 3ms
 âœ“ packages/core/src/ecs/__tests__/ComponentRegistry.test.ts  (9 tests) 3ms
stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should parse valid structured response
[ResponseParser] Structured response: {
  action: 'explore',
  thinking: 'I should explore to find food',
  speaking: 'Time to look around!'
}

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should handle response with no speaking
[ResponseParser] Structured response: {
  action: 'wander',
  thinking: 'Just going to wander',
  speaking: '(silent)'
}

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should parse all 12 valid actions
[ResponseParser] Structured response: { action: 'wander', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'idle', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'seek_food', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'follow_agent', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'talk', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'gather', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'explore', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'approach', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'observe', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'rest', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'work', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'help', thinking: 'test', speaking: '(silent)' }

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Text Fallback > should parse plain text with action name
[ResponseParser] Text-based match: explore

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Text Fallback > should find action anywhere in text
[ResponseParser] Text-based match: seek_food

 âœ“ packages/llm/src/__tests__/ResponseParser.test.ts  (12 tests) 5ms
stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseBehavior - Legacy API > should extract just the action from structured response
[ResponseParser] Structured response: { action: 'talk', thinking: 'test', speaking: 'hello' }

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseBehavior - Legacy API > should work with text response
[ResponseParser] Text-based match: idle

 âœ“ packages/world/src/chunks/__tests__/ChunkManager.test.ts  (9 tests) 8ms
 âœ“ packages/core/src/systems/__tests__/WateringAction.test.ts  (10 tests) 4ms
 âœ“ packages/core/src/ecs/__tests__/Entity.test.ts  (10 tests) 4ms
 âœ“ packages/core/src/systems/__tests__/BehaviorQueueIntegration.test.ts  (5 tests) 2ms
 âœ“ packages/core/src/actions/__tests__/AgentAction.test.ts  (12 tests) 3ms
 â†“ packages/renderer/src/__tests__/BuildingPlacementUI.test.ts  (1 test | 1 skipped)
 âœ“ packages/core/src/systems/__tests__/VerificationSystem.debug.test.ts  (1 test) 2ms
stdout | packages/core/src/systems/__tests__/VerificationSystem.debug.test.ts > VerificationSystem Debug > should find verifiers with correct component names

=== DEBUG: Component names on entity ===
  "agent": (type field: "agent")
  "position": (type field: "position")
  "social_gradient": (type field: "social_gradient")

=== DEBUG: Component checks ===
  has("agent"): true
  has("position"): true
  has("social_gradient"): true

=== DEBUG: Verifier filter results ===
  Total entities: 1
  Verifiers found: 1

 â†“ packages/renderer/src/__tests__/AgentInfoPanel-thought-speech.test.ts  (19 tests | 19 skipped)
 âœ“ packages/renderer/src/__tests__/CraftingPanelUI.test.ts  (46 tests) 56ms
 âœ“ packages/renderer/src/__tests__/InventoryUI.integration.test.ts  (43 tests) 64ms
 âœ“ packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts  (32 tests) 95ms
stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should render inventory section below needs section when agent is selected
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should render inventory divider line before inventory section
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should not render inventory section if agent has no inventory component
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display wood resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display stone resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display food resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display water resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display all resource types simultaneously
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should not display resources with zero quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 3: Empty Inventory State > should show "(empty)" when inventory has no items
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 3: Empty Inventory State > should show capacity as "Weight: 0/100 Slots: 0/8" when empty
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should display current weight and max weight
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should display current slots and max slots
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should calculate weight correctly for mixed resources
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use white color when weight is below 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use yellow color when weight exceeds 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use red color when weight reaches 100%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use yellow color when slots exceed 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use red color when slots reach 100%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should reflect inventory changes when entity is re-rendered
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should update capacity display when weight changes
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should show empty state when all resources are consumed
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxWeight is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxWeight is undefined
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.slots is not an array
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.slots is null
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.currentWeight is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxSlots is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle inventory with only empty slots
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle inventory with partial slots filled
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle very large resource quantities
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should not overflow panel bounds with many resources
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stderr | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should not overflow panel bounds with many resources
[AgentInfoPanel] World not available or missing getEntity method


âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯ Failed Tests 85 âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should propagate events to multiple listening systems
TypeError: Cannot read properties of undefined (reading 'subscribe')
 â¯ MemoryFormationSystem._setupEventListeners packages/core/src/systems/MemoryFormationSystem.ts:89:21
     87| 
     88|     for (const eventType of eventTypes) {
     89|       this.eventBus.subscribe(eventType, (event) => {
       |                     ^
     90|         this._handleMemoryTrigger(eventType, event.data as MemoryTriggâ€¦
     91|       });
 â¯ new MemoryFormationSystem packages/core/src/systems/MemoryFormationSystem.ts:32:10
 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:37:26

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/85]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should maintain event ordering: time â†’ weather â†’ temperature
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:97:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/85]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should not drop events under rapid emission
AssertionError: expected +0 to be 100 // Object.is equality

- Expected
+ Received

- 100
+ 0

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:127:35
    125| 
    126|     // All events should be captured
    127|     expect(receivedEvents.length).toBe(eventCount);
       |                                   ^
    128| 
    129|     // Events should be in order

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/85]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should include required fields in event payloads
AssertionError: expected +0 to be 1 // Object.is equality

- Expected
+ Received

- 1
+ 0

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:151:27
    149|     const events = harness.getEmittedEvents('action:completed');
    150| 
    151|     expect(events.length).toBe(1);
       |                           ^
    152|     expect(events[0].type).toBe('action:completed');
    153|     expect(events[0].data).toBeDefined();

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/85]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should allow event listeners to modify world state
AssertionError: expected 100 to be 50 // Object.is equality

- Expected
+ Received

- 50
+ 100

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:222:26
    220|     // Agent's state should be modified
    221|     const needs = agent.getComponent('needs') as any;
    222|     expect(needs.hunger).toBe(50);
       |                          ^
    223|   });
    224| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/85]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should support multiple subscribers to same event
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:257:31
    255| 
    256|     // All subscribers should be called
    257|     expect(subscriber1Called).toBe(true);
       |                               ^
    258|     expect(subscriber2Called).toBe(true);
    259|     expect(subscriber3Called).toBe(true);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/85]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should properly unsubscribe event listeners
AssertionError: expected +0 to be 1 // Object.is equality

- Expected
+ Received

- 1
+ 0

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:278:23
    276|     });
    277| 
    278|     expect(callCount).toBe(1);
       |                       ^
    279| 
    280|     // Unsubscribe

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[7/85]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should handle events with complex data payloads
AssertionError: expected +0 to be 1 // Object.is equality

- Expected
+ Received

- 1
+ 0

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:322:27
    320|     const events = harness.getEmittedEvents('test:complex_payload');
    321| 
    322|     expect(events.length).toBe(1);
       |                           ^
    323|     expect(events[0].data).toEqual(complexData);
    324|     expect(events[0].data.agent.needs.hunger).toBe(50);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[8/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should query memory, navigate to location, and arrive successfully
ReferenceError: memorySystem is not defined
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:54:7
     52| 
     53|       // Query memory for wood
     54|       memorySystem.update(world, 100);
       |       ^
     55| 
     56|       // Should have target set from memory query

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[9/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should navigate across chunk boundaries without issues
Error: SteeringSystem failed for entity 4aab2817-1f74-4817-bd9e-62901ff4b1ad: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:89:24

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[10/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should parse gradient from speech, store it, and navigate
ReferenceError: gradientSystem is not defined
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:127:7
    125| 
    126|       // Gradient system parses and stores
    127|       gradientSystem.update(world, 100);
       |       ^
    128| 
    129|       const socialGradient = listener.getComponent('SocialGradient');

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[11/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should blend multiple gradients from different agents
ReferenceError: gradientSystem is not defined
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:163:7
    161|       });
    162| 
    163|       gradientSystem.update(world, 100);
       |       ^
    164| 
    165|       const socialGradient = listener.getComponent('SocialGradient');

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[12/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should verify accurate claim and increase trust
Error: SteeringSystem failed for entity 975cb34f-e15a-43c6-a44d-c2f21214e1a1: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:211:24

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[13/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should detect false claim and decrease trust
AssertionError: expected 0.5 to be less than 0.5
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:257:24
    255| 
    256|       // Trust should decrease
    257|       expect(bobTrust).toBeLessThan(0.5);
       |                        ^
    258|     });
    259|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[14/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should form belief after 3 accurate claims from agent
Error: Unknown component type: EpisodicMemory. Add it to the component registry in World.ts
 â¯ EntityImpl.entity.addComponent packages/core/src/World.ts:125:17
    123|         const factory = componentRegistry[ComponentClassOrInstance];
    124|         if (!factory) {
    125|           throw new Error(`Unknown component type: ${ComponentClassOrIâ€¦
       |                 ^
    126|         }
    127|         const component = factory(data || {});
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:266:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[15/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should update belief confidence with new evidence
Error: Unknown component type: EpisodicMemory. Add it to the component registry in World.ts
 â¯ EntityImpl.entity.addComponent packages/core/src/World.ts:125:17
    123|         const factory = componentRegistry[ComponentClassOrInstance];
    124|         if (!factory) {
    125|           throw new Error(`Unknown component type: ${ComponentClassOrIâ€¦
       |                 ^
    126|         }
    127|         const component = factory(data || {});
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:312:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[16/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Exploration Flow: Frontier â†’ Navigate â†’ Mark Explored > should explore frontier sectors systematically
Error: SteeringSystem failed for entity 59b172c7-85d4-4873-a375-ce8c634d54b3: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:354:24

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[17/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > AC8: Epistemic Humility Emergence > should show epistemic humility after trust violations
Error: Unknown component type: EpisodicMemory. Add it to the component registry in World.ts
 â¯ EntityImpl.entity.addComponent packages/core/src/World.ts:125:17
    123|         const factory = componentRegistry[ComponentClassOrInstance];
    124|         if (!factory) {
    125|           throw new Error(`Unknown component type: ${ComponentClassOrIâ€¦
       |                 ^
    126|         }
    127|         const component = factory(data || {});
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:379:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[18/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Performance Test: 20 Agents @ 20 TPS > should handle 20 agents navigating simultaneously
Error: SteeringSystem failed for entity cb9b0122-9ad6-4f38-ab85-840080c3df91: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:419:24

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[19/85]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Performance Test: 20 Agents @ 20 TPS > should handle 20 agents with full navigation stack
ReferenceError: memorySystem is not defined
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:457:9
    455|       // Run all systems for 20 ticks
    456|       for (let tick = 0; tick < 20; tick++) {
    457|         memorySystem.update(world, world.getAllEntities(), 1.0);
       |         ^
    458|         gradientSystem.update(world, world.getAllEntities(), 1.0);
    459|         explorationSystem.update(world, world.getAllEntities(), 1.0);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[20/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should handle AI behavior updates with behavior queue
TypeError: Cannot read properties of undefined (reading 'lastThinkTick')
 â¯ AISystem.update packages/core/src/systems/AISystem.ts:92:54
     90| 
     91|       // Check if it's time to think
     92|       const ticksSinceLastThink = world.tick - agent.lastThinkTick;
       |                                                      ^
     93|       if (ticksSinceLastThink < agent.thinkInterval) {
     94|         continue;
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:44:14

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[21/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should respect think interval before updating behavior
TypeError: Cannot read properties of undefined (reading 'lastThinkTick')
 â¯ AISystem.update packages/core/src/systems/AISystem.ts:92:54
     90| 
     91|       // Check if it's time to think
     92|       const ticksSinceLastThink = world.tick - agent.lastThinkTick;
       |                                                      ^
     93|       if (ticksSinceLastThink < agent.thinkInterval) {
     94|         continue;
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:66:14

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should transition hungry agent to seek_food behavior
TypeError: Cannot read properties of undefined (reading 'lastThinkTick')
 â¯ AISystem.update packages/core/src/systems/AISystem.ts:92:54
     90| 
     91|       // Check if it's time to think
     92|       const ticksSinceLastThink = world.tick - agent.lastThinkTick;
       |                                                      ^
     93|       if (ticksSinceLastThink < agent.thinkInterval) {
     94|         continue;
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:108:14

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[23/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should handle behavior queue timeouts
TypeError: Cannot set property tick of #<WorldImpl> which has only a getter
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:138:28
    136| 
    137|     // Advance world tick far past timeout
    138|     (harness.world as any).tick = 200;
       |                            ^
    139| 
    140|     const entities = Array.from(harness.world.entities.values());

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[24/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should enforce LLM rate limiting
TypeError: Cannot set property tick of #<WorldImpl> which has only a getter
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:168:28
    166| 
    167|     // First update - might call LLM
    168|     (harness.world as any).tick = 0;
       |                            ^
    169|     aiSystem.update(harness.world, entities, 1 / 60);
    170| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[25/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should process behavior queue in FIFO order
TypeError: Cannot read properties of undefined (reading 'lastThinkTick')
 â¯ AISystem.update packages/core/src/systems/AISystem.ts:92:54
     90| 
     91|       // Check if it's time to think
     92|       const ticksSinceLastThink = world.tick - agent.lastThinkTick;
       |                                                      ^
     93|       if (ticksSinceLastThink < agent.thinkInterval) {
     94|         continue;
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:199:14

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[26/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AnimalComplete.integration.test.ts > AnimalSystem + AnimalProductionSystem + AnimalHousingSystem Integration > should critical hunger cause health loss
AssertionError: expected 100 to be less than 100
 â¯ packages/core/src/systems/__tests__/AnimalComplete.integration.test.ts:175:34
    173| 
    174|     // Health should decrease from starvation
    175|     expect(updatedAnimal.health).toBeLessThan(initialHealth);
       |                                  ^
    176|   });
    177| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[27/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts > AnimalHousingSystem + AnimalSystem + BuildingSystem Integration > should building system integrate with housing system
Error: Unknown building type: chicken_coop. Cannot determine construction time.
 â¯ BuildingSystem.getConstructionTime packages/core/src/systems/BuildingSystem.ts:619:13
    617|     if (time === undefined) {
    618|       // Per CLAUDE.md: No silent fallbacks
    619|       throw new Error(`Unknown building type: ${buildingType}. Cannot â€¦
       |             ^
    620|     }
    621| 
 â¯ BuildingSystem.advanceConstruction packages/core/src/systems/BuildingSystem.ts:264:42
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:240:14
 â¯ packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts:185:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[28/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should track construction progress over time
Error: Unknown building type: shelter. Cannot determine construction time.
 â¯ BuildingSystem.getConstructionTime packages/core/src/systems/BuildingSystem.ts:619:13
    617|     if (time === undefined) {
    618|       // Per CLAUDE.md: No silent fallbacks
    619|       throw new Error(`Unknown building type: ${buildingType}. Cannot â€¦
       |             ^
    620|     }
    621| 
 â¯ BuildingSystem.advanceConstruction packages/core/src/systems/BuildingSystem.ts:264:42
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:240:14
 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts:49:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[29/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should emit building:complete event when construction finishes
Error: Unknown building type: shelter. Cannot determine construction time.
 â¯ BuildingSystem.getConstructionTime packages/core/src/systems/BuildingSystem.ts:619:13
    617|     if (time === undefined) {
    618|       // Per CLAUDE.md: No silent fallbacks
    619|       throw new Error(`Unknown building type: ${buildingType}. Cannot â€¦
       |             ^
    620|     }
    621| 
 â¯ BuildingSystem.advanceConstruction packages/core/src/systems/BuildingSystem.ts:264:42
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:240:14
 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts:75:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[30/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should building placement confirmed event create building entity
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts:242:30
    240|     const finalEntityCount = harness.world.entities.size;
    241| 
    242|     expect(finalEntityCount).toBeGreaterThan(initialEntityCount);
       |                              ^
    243|   });
    244| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[31/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should construction progress be calculated based on buildTime
AssertionError: expected 27.77777777777778 to be greater than 40
 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts:266:38
    264| 
    265|     // Progress should be approximately 50%
    266|     expect(updatedBuilding.progress).toBeGreaterThan(40);
       |                                      ^
    267|     expect(updatedBuilding.progress).toBeLessThan(100);
    268|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[32/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC3: Exploration Covers Territory > should identify frontier sectors correctly
AssertionError: expected undefined not to be undefined
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:38:24
     36| 
     37|       // Should identify adjacent unexplored sectors
     38|       expect(frontier).toBeDefined();
       |                        ^
     39|       if (frontier) {
     40|         expect(frontier.length).toBeGreaterThan(0);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[33/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC3: Exploration Covers Territory > should create spiral pattern when exploring
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:73:43
     71|       // Verify spiral pattern: spiral step should increase
     72|       const explorationState = entity.getComponent('ExplorationState');
     73|       expect(explorationState.spiralStep).toBeGreaterThan(0);
       |                                           ^
     74| 
     75|       // Should have generated targets

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[34/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > frontier exploration algorithm > should prioritize closest frontier sectors
AssertionError: expected undefined not to be undefined
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:131:31
    129| 
    130|       // Should have target set to nearest frontier
    131|       expect(steering.target).toBeDefined();
       |                               ^
    132|       expect(steering.behavior).toBe('arrive');
    133|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[35/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > frontier exploration algorithm > should mark sectors as explored when visited
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:149:59
    147| 
    148|       // Current sector should be marked explored
    149|       expect(explorationState.exploredSectors.has('5,5')).toBe(true);
       |                                                           ^
    150|     });
    151| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[36/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > frontier exploration algorithm > should switch to new frontier target when current reached
AssertionError: expected { x: 96, y: 80 } to not deeply equal { x: 96, y: 80 }

Compared values have no visual difference.

 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:177:50
    175| 
    176|       // Should have new target
    177|       expect(explorationState.currentTarget).not.toEqual({ x: 96, y: 8â€¦
       |                                                  ^
    178|     });
    179|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[37/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for invalid exploration mode
AssertionError: expected [Function] to throw an error

- Expected: 
null

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:210:10
    208|       expect(() => {
    209|         system.update(world, world.getAllEntities(), 1.0);
    210|       }).toThrow('mode');
       |          ^
    211|     });
    212| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[38/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing home base in spiral mode
AssertionError: expected [Function] to throw an error

- Expected: 
null

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:235:10
    233|       expect(() => {
    234|         system.update(world, world.getAllEntities(), 1.0);
    235|       }).toThrow('home');
       |          ^
    236|     });
    237| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > exploration coverage metrics > should emit event when coverage milestone reached
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:318:29
    316|       system.update(world, world.getAllEntities(), 1000);
    317| 
    318|       expect(events.length).toBeGreaterThan(0);
       |                             ^
    319|     });
    320|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[40/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should weather system emit rain events that affect soil
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts:177:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[41/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should soil system track daily updates
TypeError: Cannot set property tick of #<WorldImpl> which has only a getter
 â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts:291:28
    289| 
    290|     // Advance world tick to trigger daily processing
    291|     (harness.world as any).tick = 0;
       |                            ^
    292|     soilSystem.update(harness.world, entities, 1.0);
    293| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[42/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should apply steering forces to velocity which affects movement
Error: SteeringSystem failed for entity 4b3111e8-345f-4886-9c0a-1a3593c2268d: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:63:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[43/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should handle obstacle avoidance with buildings
TypeError: Cannot read properties of undefined (reading 'velocityX')
 â¯ MovementSystem.update packages/core/src/systems/MovementSystem.ts:40:20
     38| 
     39|       // Skip if not moving
     40|       if (movement.velocityX === 0 && movement.velocityY === 0) {
       |                    ^
     41|         continue;
     42|       }
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:176:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[44/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should arrive behavior slow down near target
Error: SteeringSystem failed for entity 61f891cc-b056-4a9b-bc40-ac2a207ef3d5: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:216:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[45/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should wander behavior create random movement
Error: SteeringSystem failed for entity 44f555dd-3b04-4561-8cde-66f8958face2: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:251:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[46/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should combined steering behavior use obstacle avoidance
Error: SteeringSystem failed for entity 4ab98676-3510-4106-aec6-40c5a711ed16: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:295:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[47/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should hunger not decay during sleep
AssertionError: expected 0 to be greater than or equal to 75
 â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts:108:31
    106| 
    107|     // Hunger should not have decayed significantly during sleep
    108|     expect(finalNeeds.hunger).toBeGreaterThanOrEqual(initialHunger - 5â€¦
       |                               ^
    109|   });
    110| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[48/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should extreme cold temperature damage health
TypeError: Cannot read properties of undefined (reading 'currentTemp')
 â¯ TemperatureSystem.update packages/core/src/systems/TemperatureSystem.ts:59:56
     57|       // Gradually adjust body temperature toward environmental temperâ€¦
     58|       // Body temperature changes slowly, not instantly
     59|       const tempDiff = effectiveTemp - currentTempComp.currentTemp;
       |                                                        ^
     60|       const tempChange = tempDiff * this.THERMAL_RATE * deltaTime;
     61|       const newTemp = currentTempComp.currentTemp + tempChange;
 â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts:144:18

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[49/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should temperature extremes increase needs decay when awake
TypeError: Cannot read properties of undefined (reading 'currentTemp')
 â¯ TemperatureSystem.update packages/core/src/systems/TemperatureSystem.ts:59:56
     57|       // Gradually adjust body temperature toward environmental temperâ€¦
     58|       // Body temperature changes slowly, not instantly
     59|       const tempDiff = effectiveTemp - currentTempComp.currentTemp;
       |                                                        ^
     60|       const tempChange = tempDiff * this.THERMAL_RATE * deltaTime;
     61|       const newTemp = currentTempComp.currentTemp + tempChange;
 â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts:259:18

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[50/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants advance growth over time
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:247:13
    245|     }
    246|     if (plant.hydration === undefined) {
    247|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    248|     }
    249|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:167:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:86:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[51/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plant health affect growth rate
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:247:13
    245|     }
    246|     if (plant.hydration === undefined) {
    247|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    248|     }
    249|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:167:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:194:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[52/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants emit stage transition events
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:247:13
    245|     }
    246|     if (plant.hydration === undefined) {
    247|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    248|     }
    249|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:167:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:230:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[53/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should multiple plants update independently
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:247:13
    245|     }
    246|     if (plant.hydration === undefined) {
    247|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    248|     }
    249|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:167:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:281:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[54/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should dead plants not grow
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:247:13
    245|     }
    246|     if (plant.hydration === undefined) {
    247|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    248|     }
    249|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:167:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:314:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[55/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should move agent toward target position (seek behavior)
Error: SteeringSystem failed for entity 46fbbb6f-fe2d-401e-b7b0-768eff894ae0: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:28:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[56/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should slow down when approaching target (arrive behavior)
Error: SteeringSystem failed for entity b7005a17-251c-4abb-bbc4-17304419d27b: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:54:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[57/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should stop when reaching target within tolerance
Error: SteeringSystem failed for entity ec1fdfc1-af06-4f0c-ac67-435219586b11: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:78:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[58/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should avoid obstacles using ray-casting
Error: SteeringSystem failed for entity b9d78c41-09f5-4a8f-80fa-0b9573a0f00c: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:105:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[59/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should navigate across chunk boundaries
Error: SteeringSystem failed for entity 00ec4c97-5bcd-44ce-bed3-375e092f93d4: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:127:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[60/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > wander behavior > should produce coherent wandering (not random jitter)
Error: SteeringSystem failed for entity 05ef7c5d-1813-413b-a016-3f37be043153: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:154:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[61/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > steering force calculation > should limit steering force to maxForce
Error: SteeringSystem failed for entity 0bbc1aa1-ffe1-4ff6-9403-7335d900bff2: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:182:14

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[62/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > steering force calculation > should limit velocity to maxSpeed
Error: SteeringSystem failed for entity 7c36998a-bbd1-4563-9e0e-b87faad3a755: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:202:14

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[63/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing target in seek behavior
AssertionError: expected [Function] to throw error including 'target' but got 'SteeringSystem failed for entity bc82â€¦'

- Expected
+ Received

- target
+ SteeringSystem failed for entity bc823bd9-089a-4b63-952d-8764c0840147: Error: SteeringSystem requires Position component

 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:225:10
    223|       expect(() => {
    224|         system.update(world, world.getAllEntities(), 1.0);
    225|       }).toThrow('target');
       |          ^
    226|     });
    227| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[64/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for invalid behavior type
AssertionError: expected [Function] to throw error including 'behavior' but got 'SteeringSystem failed for entity 7e38â€¦'

- Expected
+ Received

- behavior
+ SteeringSystem failed for entity 7e380bc9-c520-4564-9071-2b227851700c: Error: SteeringSystem requires Position component

 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:240:10
    238|       expect(() => {
    239|         system.update(world, world.getAllEntities(), 1.0);
    240|       }).toThrow('behavior');
       |          ^
    241|     });
    242| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[65/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing Velocity component
AssertionError: expected [Function] to throw error including 'Velocity' but got 'SteeringSystem failed for entity ed2bâ€¦'

- Expected
+ Received

- Velocity
+ SteeringSystem failed for entity ed2b7811-b849-4d67-8eb9-b697ccb83725: Error: SteeringSystem requires Position component

 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:270:10
    268|       expect(() => {
    269|         system.update(world, world.getAllEntities(), 1.0);
    270|       }).toThrow('Velocity');
       |          ^
    271|     });
    272|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[66/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > combined behaviors > should blend seek and obstacle avoidance
Error: SteeringSystem failed for entity 844def7e-9a5a-47a7-a27e-0b3fe0242a17: Error: SteeringSystem requires Position component
 â¯ SteeringSystem.update packages/core/src/systems/SteeringSystem.ts:45:15
     43|       } catch (error) {
     44|         // Per CLAUDE.md, re-throw with context
     45|         throw new Error(`SteeringSystem failed for entity ${entity.id}â€¦
       |               ^
     46|       }
     47|     }
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:296:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[67/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TamingComplete.integration.test.ts > TamingSystem + AnimalSystem + InventorySystem Integration > should failed taming still increase trust
Error: Unknown animal species: wolf
 â¯ Module.getAnimalSpecies packages/core/src/data/animalSpecies.ts:427:11
    425|   const species = ANIMAL_SPECIES[speciesId];
    426|   if (!species) {
    427|     throw new Error(`Unknown animal species: ${speciesId}`);
       |           ^
    428|   }
    429|   return species;
 â¯ TamingSystem.attemptTaming packages/core/src/systems/TamingSystem.ts:52:21
 â¯ packages/core/src/systems/__tests__/TamingComplete.integration.test.ts:145:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[68/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TamingComplete.integration.test.ts > TamingSystem + AnimalSystem + InventorySystem Integration > should taming emit animal_tamed event on success
AssertionError: expected +0 to be 1 // Object.is equality

- Expected
+ Received

- 1
+ 0

 â¯ packages/core/src/systems/__tests__/TamingComplete.integration.test.ts:398:34
    396|     if (result.success) {
    397|       const tamedEvents = harness.getEmittedEvents('animal_tamed');
    398|       expect(tamedEvents.length).toBe(1);
       |                                  ^
    399|       expect(tamedEvents[0].data.animalId).toBe('chicken-1');
    400|       expect(tamedEvents[0].data.agentId).toBe(agent.id);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[69/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should emit events in correct order: time â†’ weather â†’ temperature
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:66:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[70/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should apply weather temperature modifiers to ambient temperature
TypeError: Cannot read properties of undefined (reading 'currentTemp')
 â¯ TemperatureSystem.update packages/core/src/systems/TemperatureSystem.ts:59:56
     57|       // Gradually adjust body temperature toward environmental temperâ€¦
     58|       // Body temperature changes slowly, not instantly
     59|       const tempDiff = effectiveTemp - currentTempComp.currentTemp;
       |                                                        ^
     60|       const tempChange = tempDiff * this.THERMAL_RATE * deltaTime;
     61|       const newTemp = currentTempComp.currentTemp + tempChange;
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:104:18

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[71/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should show temperature variation over day/night cycle
TypeError: Cannot read properties of undefined (reading 'currentTemp')
 â¯ TemperatureSystem.update packages/core/src/systems/TemperatureSystem.ts:59:56
     57|       // Gradually adjust body temperature toward environmental temperâ€¦
     58|       // Body temperature changes slowly, not instantly
     59|       const tempDiff = effectiveTemp - currentTempComp.currentTemp;
       |                                                        ^
     60|       const tempChange = tempDiff * this.THERMAL_RATE * deltaTime;
     61|       const newTemp = currentTempComp.currentTemp + tempChange;
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:142:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[72/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should weather transitions affect temperature over time
TypeError: Cannot read properties of undefined (reading 'currentTemp')
 â¯ TemperatureSystem.update packages/core/src/systems/TemperatureSystem.ts:59:56
     57|       // Gradually adjust body temperature toward environmental temperâ€¦
     58|       // Body temperature changes slowly, not instantly
     59|       const tempDiff = effectiveTemp - currentTempComp.currentTemp;
       |                                                        ^
     60|       const tempChange = tempDiff * this.THERMAL_RATE * deltaTime;
     61|       const newTemp = currentTempComp.currentTemp + tempChange;
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:195:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[73/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should handle snow weather with extreme cold temperatures
TypeError: Cannot read properties of undefined (reading 'currentTemp')
 â¯ TemperatureSystem.update packages/core/src/systems/TemperatureSystem.ts:59:56
     57|       // Gradually adjust body temperature toward environmental temperâ€¦
     58|       // Body temperature changes slowly, not instantly
     59|       const tempDiff = effectiveTemp - currentTempComp.currentTemp;
       |                                                        ^
     60|       const tempChange = tempDiff * this.THERMAL_RATE * deltaTime;
     61|       const newTemp = currentTempComp.currentTemp + tempChange;
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:253:18

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[74/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should time speed multiplier affect weather duration correctly
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:286:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[75/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should thermal inertia prevent instant temperature changes
TypeError: Cannot read properties of undefined (reading 'currentTemp')
 â¯ TemperatureSystem.update packages/core/src/systems/TemperatureSystem.ts:59:56
     57|       // Gradually adjust body temperature toward environmental temperâ€¦
     58|       // Body temperature changes slowly, not instantly
     59|       const tempDiff = effectiveTemp - currentTempComp.currentTemp;
       |                                                        ^
     60|       const tempChange = tempDiff * this.THERMAL_RATE * deltaTime;
     61|       const newTemp = currentTempComp.currentTemp + tempChange;
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:323:16

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[76/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should verify resource claim when agent arrives at location
AssertionError: expected 0.5 to be greater than 0.5
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:71:21
     69| 
     70|       // Trust should increase for correct claim
     71|       expect(trust).toBeGreaterThan(0.5);
       |                     ^
     72|     });
     73| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[77/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect stale information (resource depleted)
AssertionError: expected 0.5 to be close to 0.4, received difference is 0.09999999999999998, but expected 0.005
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:101:21
     99| 
    100|       // Minor penalty for stale info (-0.1)
    101|       expect(trust).toBeCloseTo(0.4, 2);
       |                     ^
    102|     });
    103| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[78/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect misidentified resources
AssertionError: expected 0.5 to be close to 0.1, received difference is 0.4, but expected 0.005
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:134:21
    132| 
    133|       // Moderate penalty for misidentification (-0.4)
    134|       expect(trust).toBeCloseTo(0.1, 2);
       |                     ^
    135|     });
    136| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[79/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect false reports (no resource at all)
AssertionError: expected 0.5 to be close to 0.3, received difference is 0.2, but expected 0.005
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:164:21
    162| 
    163|       // Penalty for false report (-0.2)
    164|       expect(trust).toBeCloseTo(0.3, 2);
       |                     ^
    165|     });
    166| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[80/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect pattern of unreliable information
AssertionError: expected 0.5 to be less than 0.2
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:201:21
    199| 
    200|       // Severe penalty for pattern (-0.8)
    201|       expect(trust).toBeLessThan(0.2);
       |                     ^
    202|     });
    203|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[81/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC7: Trust Affects Cooperation - Public Callouts > should broadcast correction for false information
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:232:33
    230| 
    231|       // Should broadcast correction
    232|       expect(broadcasts.length).toBeGreaterThan(0);
       |                                 ^
    233|       expect(broadcasts[0].data.message).toContain('no wood');
    234|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[82/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification range > should verify when agent reaches claimed location
AssertionError: expected 0.5 to be greater than 0.5
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:298:21
    296|       // Verification should occur - trust score for bob should be set
    297|       const trust = trustNetwork.getTrustScore('bob');
    298|       expect(trust).toBeGreaterThan(0.5); // Should increase from defaâ€¦
       |                     ^
    299|     });
    300|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[83/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_verified event for correct claims
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:404:29
    402|       system.update(world, world.getAllEntities(), 200);
    403| 
    404|       expect(events.length).toBeGreaterThan(0);
       |                             ^
    405|       expect(events[0].data.result).toBe('correct');
    406|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[84/85]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_violated event for false claims
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:435:29
    433|       system.update(world, world.getAllEntities(), 150);
    434| 
    435|       expect(events.length).toBeGreaterThan(0);
       |                             ^
    436|       expect(events[0].data.result).toBe('false_report');
    437|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[85/85]âŽ¯

 Test Files  15 failed | 74 passed | 2 skipped (91)
      Tests  85 failed | 1556 passed | 57 skipped (1698)
   Start at  20:28:47
   Duration  2.54s (transform 2.26s, setup 16.73s, collect 4.14s, tests 705ms, environment 843ms, prepare 2.93s)

