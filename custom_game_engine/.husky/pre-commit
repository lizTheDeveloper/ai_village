#!/usr/bin/env sh

echo "ğŸ” Running pre-commit checks..."

# Change to the custom_game_engine directory
cd custom_game_engine

# Step 1: Type checking
echo "ğŸ“ Checking TypeScript types..."
npm run build --if-present || {
  echo "âŒ TypeScript build failed. Please fix type errors before committing."
  exit 1
}

# Step 2: Linting (fail on errors only, warnings are OK for now)
echo "ğŸ§¹ Running ESLint..."
npm run lint -- --max-warnings -1 2>/dev/null || {
  # Check if there were actual errors (not just warnings)
  npm run lint:errors || {
    echo "âŒ ESLint found errors. Please fix them before committing."
    echo "   Run 'npm run lint' to see all issues."
    exit 1
  }
}

# Step 3: Tests
echo "ğŸ§ª Running tests..."
npm test || {
  echo "âŒ Tests failed. Please fix failing tests before committing."
  exit 1
}

echo "âœ… All pre-commit checks passed!"
