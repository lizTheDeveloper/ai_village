
> @ai-village/game-engine@0.1.0 test
> vitest run


 RUN  v1.6.1 /Users/annhoward/src/ai_village/custom_game_engine

 ‚úì packages/core/src/metrics/events/__tests__/MetricEvents.test.ts  (26 tests) 5ms
 ‚úì packages/renderer/src/__tests__/DragDropSystem.test.ts  (29 tests) 7ms
 ‚úì packages/core/src/buildings/__tests__/BuildingDefinitions.test.ts  (44 tests) 8ms
 ‚úì packages/core/src/__tests__/AnimalHousingCleanliness.test.ts  (24 tests) 4ms
 ‚úì packages/core/src/__tests__/AnimalHousing.test.ts  (27 tests | 5 skipped) 4ms
stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should change grass tile to dirt terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 71.54
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.54', phosphorus: '57.23', potassium: '64.39' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.53932049014314,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set tilled flag to true
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 79.76
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.76', phosphorus: '63.81', potassium: '71.78' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.75861989675649,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set plantability counter to 3
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 77.13
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.13', phosphorus: '61.70', potassium: '69.41' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.12716270614678,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set fertility based on biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 77.95
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.95', phosphorus: '62.36', potassium: '70.15' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.94874253148487,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should initialize nutrients (N, P, K) based on fertility
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 73.31
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.31', phosphorus: '58.65', potassium: '65.98' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.31324835238726,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Valid Terrain Tilling > should allow tilling grass terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 76.16
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.16', phosphorus: '60.93', potassium: '68.55' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.16347314043954,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Valid Terrain Tilling > should allow tilling dirt terrain (re-tilling)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 79.55
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.55', phosphorus: '63.64', potassium: '71.59' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.54579501075291,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling stone terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling stone terrain
[SoilSystem] ‚ùå ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling water terrain
[SoilSystem] ===== TILLING TILE AT (3, 8) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling water terrain
[SoilSystem] ‚ùå ERROR: Cannot till water terrain at (3,8). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling sand terrain
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 20,
  moisture: 10,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling sand terrain
[SoilSystem] ‚ùå ERROR: Cannot till sand terrain at (10,10). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should NOT modify tile state on invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should NOT modify tile state on invalid terrain
[SoilSystem] ‚ùå ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should emit soil:tilled event when tilling succeeds
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 70.81
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.81', phosphorus: '56.65', potassium: '63.73' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 70.80917774293201,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include position in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (15, 20) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'forest': 0.00 ‚Üí 67.02
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '67.02', phosphorus: '53.61', potassium: '60.31' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 15, y: 20 },
    fertility: 67.01608339071288,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include fertility in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 73.45
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.45', phosphorus: '58.76', potassium: '66.11' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.45227002768326,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include biome in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'river': 0.00 ‚Üí 76.43
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.43', phosphorus: '61.14', potassium: '68.79' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.43049932730372,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should NOT emit soil:tilled event on invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should NOT emit soil:tilled event on invalid terrain
[SoilSystem] ‚ùå ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set plains fertility to ~70-80
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 ‚Üí 76.08
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.08', phosphorus: '60.86', potassium: '68.47' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.0760580349975,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set forest fertility to ~60-70
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'forest': 0.00 ‚Üí 60.82
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '60.82', phosphorus: '48.65', potassium: '54.74' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 60.817353334243954,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set river fertility to ~75-85
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'river': 0.00 ‚Üí 81.14
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '81.14', phosphorus: '64.91', potassium: '73.03' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 81.14230641336526,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set desert fertility to ~20-30
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'desert',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'desert': 0.00 ‚Üí 26.67
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '26.67', phosphorus: '21.34', potassium: '24.01' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 26.673128768013896,
    biome: 'desert'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set mountains fertility to ~40-50
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'mountains': 0.00 ‚Üí 43.99
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '43.99', phosphorus: '35.19', potassium: '39.59' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 43.98725667025737,
    biome: 'mountains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set ocean fertility to 0 (not farmable)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'ocean',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'ocean': 0.00 ‚Üí 0.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '0.00', phosphorus: '0.00', potassium: '0.00' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: { position: { x: 5, y: 5 }, fertility: 0, biome: 'ocean' }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should throw error for undefined biome (CLAUDE.md: no silent fallbacks)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  fertility: 0,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should throw error for undefined biome (CLAUDE.md: no silent fallbacks)
[SoilSystem] ‚ùå CRITICAL ERROR: Tile at (5,5) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 0,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 0,
    "phosphorus": 0,
    "potassium": 0
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should allow re-tilling already tilled depleted dirt
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 71.75
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.75', phosphorus: '57.40', potassium: '64.57' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.74699649445056,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should reset plantability counter to 3 on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 70.68
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.68', phosphorus: '56.54', potassium: '63.61' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 70.68095130739412,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should refresh fertility on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 20,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 20.00 ‚Üí 79.34
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.34', phosphorus: '63.47', potassium: '71.40' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.33680990161706,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should emit tilling event on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 20,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 20.00 ‚Üí 73.52
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.52', phosphorus: '58.81', potassium: '66.16' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.51630764284205,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till before depletion
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 2
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till before depletion
[SoilSystem] ‚ùå ERROR: Tile at (5,5) is already tilled. Plantability: 2/3 uses remaining. Wait until depleted to re-till.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till with plantability=1
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 1
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till with plantability=1
[SoilSystem] ‚ùå ERROR: Tile at (5,5) is already tilled. Plantability: 1/3 uses remaining. Wait until depleted to re-till.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should throw clear error for invalid terrain type
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should throw clear error for invalid terrain type
[SoilSystem] ‚ùå ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include position in error message
[SoilSystem] ===== TILLING TILE AT (15, 20) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include position in error message
[SoilSystem] ‚ùå ERROR: Cannot till water terrain at (15,20). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include terrain type in error message
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 0,
  moisture: 10,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include terrain type in error message
[SoilSystem] ‚ùå ERROR: Cannot till sand terrain at (5,5). Only grass and dirt can be tilled.

 ‚úì packages/core/src/actions/__tests__/TillAction.test.ts  (50 tests | 8 skipped) 11ms
stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should change terrain from grass to dirt when tilled
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 79.16
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.16', phosphorus: '63.33', potassium: '71.24' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.15757898643555,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set tilled flag to true
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 75.73
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.73', phosphorus: '60.59', potassium: '68.16' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.7339686501588,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set plantability counter to 3
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 76.55
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.55', phosphorus: '61.24', potassium: '68.89' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.54546364773259,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set fertility based on biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 73.53
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.53', phosphorus: '58.83', potassium: '66.18' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.53406838670246,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should initialize nutrients (N, P, K)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 75.87
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.87', phosphorus: '60.70', potassium: '68.28' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.86943080490751,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 3: Tilling Validation - Valid Terrain > should successfully till grass terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 73.89
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.89', phosphorus: '59.11', potassium: '66.50' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.88699494172339,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 3: Tilling Validation - Valid Terrain > should successfully till dirt terrain (re-tilling)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 77.21
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.21', phosphorus: '61.77', potassium: '69.49' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.20641649203884,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till stone terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till stone terrain
[SoilSystem] ‚ùå ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till water terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till water terrain
[SoilSystem] ‚ùå ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till sand terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till sand terrain
[SoilSystem] ‚ùå ERROR: Cannot till sand terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT modify tile state when validation fails
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT modify tile state when validation fails
[SoilSystem] ‚ùå ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT emit tilling event when validation fails
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT emit tilling event when validation fails
[SoilSystem] ‚ùå ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should call SoilSystem.tillTile with correct parameters
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 79.88
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.88', phosphorus: '63.91', potassium: '71.90' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.88366741220946,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should use existing fertility calculation logic
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 78.10
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.10', phosphorus: '62.48', potassium: '70.29' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.09780900460376,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should initialize nutrients based on fertility
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 75.22
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.22', phosphorus: '60.17', potassium: '67.69' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.21544065231234,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event when tilling succeeds
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 77.55
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.55', phosphorus: '62.04', potassium: '69.79' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.54941528455392,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with position data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 73.70
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.70', phosphorus: '58.96', potassium: '66.33' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.70126497932789,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with fertility data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 75.96
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.96', phosphorus: '60.77', potassium: '68.36' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.95782402448499,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with biome data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 78.26
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.26', phosphorus: '62.61', potassium: '70.43' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.25871596654217,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 70-80 for plains biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 79.08
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.08', phosphorus: '63.26', potassium: '71.17' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.07578544571753,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 60-70 for forest biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'forest': 50.00 ‚Üí 67.63
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '67.63', phosphorus: '54.10', potassium: '60.86' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 67.62710925414206,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 75-85 for river biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'river': 50.00 ‚Üí 82.10
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '82.10', phosphorus: '65.68', potassium: '73.89' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 82.0977671381465,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 20-30 for desert biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'desert',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'desert': 50.00 ‚Üí 28.56
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '28.56', phosphorus: '22.84', potassium: '25.70' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 28.5560985560719,
    biome: 'desert'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 40-50 for mountains biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'mountains': 50.00 ‚Üí 47.72
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '47.72', phosphorus: '38.18', potassium: '42.95' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 47.72300799870922,
    biome: 'mountains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 0 for ocean biome (not tillable)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'ocean',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'ocean': 50.00 ‚Üí 0.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '0.00', phosphorus: '0.00', potassium: '0.00' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: { position: { x: 5, y: 5 }, fertility: 0, biome: 'ocean' }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when tile is null/undefined
[SoilSystem] ===== TILLING TILE AT (5, 5) =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when position is invalid
[SoilSystem] ===== TILLING TILE AT (NaN, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when position is invalid
[SoilSystem] ‚ùå ERROR: tillTile requires valid position coordinates, got (NaN,5)

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw clear error message for invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw clear error message for invalid terrain
[SoilSystem] ‚ùå ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT use fallback fertility values
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 76.78
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.78', phosphorus: '61.42', potassium: '69.10' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.77807891378279,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT catch and swallow errors
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT catch and swallow errors
[SoilSystem] ‚ùå ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should allow re-tilling an already-tilled depleted tile
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 71.56
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.56', phosphorus: '57.25', potassium: '64.40' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.56013168280187,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 71.56013168280187,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 71.56 ‚Üí 72.73
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.73', phosphorus: '58.18', potassium: '65.45' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 72.72604800639807,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should reset plantability counter to 3 when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 79.80
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.80', phosphorus: '63.84', potassium: '71.82' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.7974522081804,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should refresh fertility when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 30,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 30.00 ‚Üí 78.11
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.11', phosphorus: '62.48', potassium: '70.29' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.10527973065106,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should emit tilling event when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 73.66
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.66', phosphorus: '58.93', potassium: '66.29' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.65799833109604,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should throw error when tilling tile without biome (CLAUDE.md)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should throw error when tilling tile without biome (CLAUDE.md)
[SoilSystem] ‚ùå CRITICAL ERROR: Tile at (5,5) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 50,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 0,
    "phosphorus": 0,
    "potassium": 0
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should handle tilling at negative coordinates
[SoilSystem] ===== TILLING TILE AT (-5, -5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 75.95
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.95', phosphorus: '60.76', potassium: '68.36' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: -5, y: -5 },
    fertility: 75.95456128336689,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should handle tilling at large coordinates
[SoilSystem] ===== TILLING TILE AT (1000, 1000) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 73.65
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.65', phosphorus: '58.92', potassium: '66.29' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 1000, y: 1000 },
    fertility: 73.65449022626629,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should preserve existing moisture when tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 75,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 72.87
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.87', phosphorus: '58.29', potassium: '65.58' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 72.86722725502918,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should reset fertilizer state when tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 76.43
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.43', phosphorus: '61.15', potassium: '68.79' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.43376551737455,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with PlantSystem (planted flag check)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 72.76
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.76', phosphorus: '58.21', potassium: '65.48' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 72.75715073235574,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with WaterSystem (moisture tracking)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 77.84
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.84', phosphorus: '62.27', potassium: '70.05' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.8363289439093,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with WeatherSystem (rain effects)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] ‚úÖ Validation passed - proceeding with tilling
[SoilSystem] ‚ÑπÔ∏è MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency, 20s duration)
[SoilSystem] üí° TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] üî® Available tools: HOE (100% efficiency, 10s) > SHOVEL (80%, 12.5s) > HANDS (50%, 20s)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass ‚Üí dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 ‚Üí 78.74
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.74', phosphorus: '63.00', potassium: '70.87' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.74422230676008,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

 ‚úì packages/core/src/systems/__tests__/TillingAction.test.ts  (55 tests) 12ms
 ‚úì packages/core/src/components/__tests__/EpisodicMemoryComponent.test.ts  (29 tests) 8ms
 ‚úì packages/core/src/__tests__/AnimalHousingIntegration.test.ts  (14 tests | 1 skipped) 5ms
 ‚úì packages/core/src/__tests__/TamingSystem.test.ts  (17 tests) 5ms
 ‚úì packages/core/src/__tests__/AnimalProduction.test.ts  (15 tests) 6ms
 ‚úì packages/core/src/systems/__tests__/ResourceGathering.test.ts  (37 tests) 8ms
 ‚úì packages/core/src/systems/__tests__/JournalingSystem.test.ts  (22 tests | 17 skipped) 2ms
stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should automatically increment progress each tick for buildings < 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should calculate progress based on buildTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should not increment progress for completed buildings
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 2: Resource Deduction > should deduct resources from agent inventory on construction start
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 2: Resource Deduction > should deduct multiple resource types correctly
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit building:complete event when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (15, 20) - 99.0% ‚Üí 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] üèóÔ∏è Construction complete! tent at (15, 20)
[BuildingSystem] üéâ building:complete event emitted for entity e7b01aec

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should mark building as complete when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (10, 10) - 99.0% ‚Üí 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] üèóÔ∏è Construction complete! tent at (10, 10)
[BuildingSystem] üéâ building:complete event emitted for entity fa037179

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit event exactly once when crossing 100% threshold
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 99.0% ‚Üí 100.0% (deltaTime=10.000s, buildTime=30s, increase=33.333%)
[BuildingSystem] üèóÔ∏è Construction complete! campfire at (10, 10)
[BuildingSystem] üéâ building:complete event emitted for entity 374bcf5b
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: workbench at (42, 84) - 99.0% ‚Üí 100.0% (deltaTime=10.000s, buildTime=60s, increase=16.667%)
[BuildingSystem] üèóÔ∏è Construction complete! workbench at (42, 84)
[BuildingSystem] üéâ building:complete event emitted for entity 5ccd9b93

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should create construction site when agent initiates building
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should emit construction:started event when construction begins
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should complete full construction lifecycle
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 0.0% ‚Üí 100.0% (deltaTime=31.000s, buildTime=30s, increase=103.333%)
[BuildingSystem] üèóÔ∏è Construction complete! campfire at (10, 10)
[BuildingSystem] üéâ building:complete event emitted for entity 9d9f3dc4

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Resource Deduction Edge Cases > should handle exact resource amounts correctly
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Resource Deduction Edge Cases > should leave excess resources in inventory
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should progress from 0% to 100% over buildTime
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 0.0% ‚Üí 50.0% (deltaTime=15.000s, buildTime=30s, increase=50.000%)
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 50.0% ‚Üí 100.0% (deltaTime=15.000s, buildTime=30s, increase=50.000%)
[BuildingSystem] üèóÔ∏è Construction complete! campfire at (10, 10)
[BuildingSystem] üéâ building:complete event emitted for entity 092c611a

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should handle fractional progress increments
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Multiple Buildings Simultaneously > should handle multiple buildings under construction at once
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood
[World.initiateConstruction] Consumed resources for workbench: 20 wood
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 3 building entities (3 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (10, 10) - 0.0% ‚Üí 11.1% (deltaTime=5.000s, buildTime=45s, increase=11.111%)
[BuildingSystem] Construction progress: workbench at (20, 10) - 0.0% ‚Üí 8.3% (deltaTime=5.000s, buildTime=60s, increase=8.333%)
[BuildingSystem] Construction progress: campfire at (30, 10) - 0.0% ‚Üí 16.7% (deltaTime=5.000s, buildTime=30s, increase=16.667%)

 ‚úì packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts  (28 tests) 8ms
 ‚úì packages/core/src/systems/__tests__/StorageDeposit.test.ts  (14 tests) 5ms
 ‚úì packages/core/src/buildings/__tests__/CraftingStations.test.ts  (30 tests) 6ms
 ‚úì packages/core/src/__tests__/AnimalSystem.test.ts  (18 tests) 5ms
 ‚úì packages/core/src/buildings/__tests__/PlacementValidator.test.ts  (22 tests) 7ms
stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should trigger reflection when agent sleeps
[Reflection] üí≠ Agent 49b0698a is reflecting on 1 memories from today...
[Reflection] üí≠ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] üí≠ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should generate reflection from today's memories
[Reflection] üí≠ Agent 381dc948 is reflecting on 2 memories from today...
[Reflection] üí≠ Reflection: "Reflecting on today: 2 significant moments stand out."
[Reflection] üí≠ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should mark important memories for consolidation
[Reflection] üí≠ Agent 234defb7 is reflecting on 1 memories from today...
[Reflection] üí≠ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] üí≠ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should store reflection with timestamp
[Reflection] üí≠ Agent d5284012 is reflecting on 1 memories from today...
[Reflection] üí≠ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] üí≠ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should generate coherent reflection text via LLM
[Reflection] üí≠ Agent adbeb5c1 is reflecting on 1 memories from today...
[Reflection] üí≠ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] üí≠ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > reflection triggers > should trigger after significant event (importance > 0.7)
[Reflection] üí≠ Agent 0274a7b5 is reflecting on 1 memories from today...
[Reflection] üí≠ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] üí≠ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > reflection triggers > should NOT reflect if no memories to reflect on
[Reflection] üí≠ Agent 1ecf6c73 has no memories to reflect on today

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > event emission > should emit reflection:completed when done
[Reflection] üí≠ Agent ab7e0776 is reflecting on 1 memories from today...
[Reflection] üí≠ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] üí≠ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > event emission > should include agent ID in reflection:completed event
[Reflection] üí≠ Agent d69bf76e is reflecting on 1 memories from today...
[Reflection] üí≠ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] üí≠ Insights: 

 ‚úì packages/core/src/systems/__tests__/ReflectionSystem.test.ts  (22 tests | 4 skipped) 6ms
stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance construction progress based on time elapsed
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance different buildings at different rates based on buildTime
[BuildingSystem] Processing 2 building entities (2 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should clamp progress to 100% maximum
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% ‚Üí 100.0% (deltaTime=1000.000s, buildTime=45s, increase=2222.222%)
[BuildingSystem] üèóÔ∏è Construction complete! tent at (0, 0)
[BuildingSystem] üéâ building:complete event emitted for entity ab7811ea

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should skip completed buildings
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should handle multiple simultaneous constructions
[BuildingSystem] Processing 3 building entities (3 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 0.0% ‚Üí 11.1% (deltaTime=5.000s, buildTime=45s, increase=11.111%)
[BuildingSystem] Construction progress: workbench at (10, 0) - 0.0% ‚Üí 8.3% (deltaTime=5.000s, buildTime=60s, increase=8.333%)
[BuildingSystem] Construction progress: campfire at (20, 0) - 0.0% ‚Üí 16.7% (deltaTime=5.000s, buildTime=30s, increase=16.667%)

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should mark building as complete when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% ‚Üí 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] üèóÔ∏è Construction complete! tent at (0, 0)
[BuildingSystem] üéâ building:complete event emitted for entity 09b5a43f

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit "building:complete" event on completion
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (16, 32) - 99.0% ‚Üí 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] üèóÔ∏è Construction complete! tent at (16, 32)
[BuildingSystem] üéâ building:complete event emitted for entity 46708e06

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit event with correct entity ID and building type
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (0, 0) - 99.0% ‚Üí 100.0% (deltaTime=10.000s, buildTime=30s, increase=33.333%)
[BuildingSystem] üèóÔ∏è Construction complete! campfire at (0, 0)
[BuildingSystem] üéâ building:complete event emitted for entity 56739fbe

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should only emit event once when crossing 100% threshold
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% ‚Üí 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] üèóÔ∏è Construction complete! tent at (0, 0)
[BuildingSystem] üéâ building:complete event emitted for entity f519f855
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when entity missing BuildingComponent
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when entity missing PositionComponent
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when building type is unknown
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle construction at exactly 100% progress
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle progress from 99% to 101% (clamped to 100%)
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% ‚Üí 100.0% (deltaTime=1000.000s, buildTime=45s, increase=2222.222%)
[BuildingSystem] üèóÔ∏è Construction complete! tent at (0, 0)
[BuildingSystem] üéâ building:complete event emitted for entity 65045fab

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle zero deltaTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Integration with Building Types > should use correct buildTime for each building type
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

 ‚úì packages/core/src/systems/__tests__/ConstructionProgress.test.ts  (27 tests) 5ms
 ‚úì packages/core/src/systems/__tests__/Phase9-SoilWeatherIntegration.test.ts  (39 tests) 4ms
stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory automatically on significant event
[MemoryFormation] üß† Forming memory for agent f51cb41a-8069-466c-904c-76e4fb2e28be: {
  eventType: 'harvest:first',
  summary: 'Harvested first wheat',
  emotionalIntensity: 0.8,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on high emotional intensity (>0.6)
[MemoryFormation] üß† Forming memory for agent 96bac5ad-c0ae-473c-9e31-1d2c68e69038: {
  eventType: 'social:conflict',
  summary: 'Had a conflict with bob-123',
  emotionalIntensity: 0.9,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on high novelty
[MemoryFormation] üß† Forming memory for agent c77cd913-475e-4093-98f4-beeaf44075df: {
  eventType: 'discovery:location',
  summary: 'Discovered a new location',
  emotionalIntensity: 0,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on survival threat
[MemoryFormation] üß† Forming memory for agent 5bed8b9a-bc84-4074-9117-d6f82a9a1250: {
  eventType: 'need:critical',
  summary: 'My health became critically low',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on emotional intensity > 0.6
[MemoryFormation] üß† Forming memory for agent 07ffb95a-8dc9-4f85-8f3a-9fe5b061e24f: {
  eventType: 'agent:emotion_peak',
  summary: 'Felt strong joy',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on novelty > 0.7
[MemoryFormation] üß† Forming memory for agent 2aba5d3e-081e-4768-ba68-6e31dd36339c: {
  eventType: 'event:novel',
  summary: 'Experienced something completely new',
  emotionalIntensity: 0,
  novelty: 0.8
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on social significance > 0.5
[MemoryFormation] üß† Forming memory for agent 9815f97b-8848-4ba0-b968-5951c2820016: {
  eventType: 'social:interaction',
  summary: 'Interacted with alice-123',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on survival relevance > 0.5
[MemoryFormation] üß† Forming memory for agent 0ac4d8b0-c921-4902-a508-eff7b5ae9623: {
  eventType: 'survival:close_call',
  summary: 'Close call with starvation',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on goal relevance > 0.7
[MemoryFormation] üß† Forming memory for agent a2d619c4-71b6-472a-a04a-f01bac45a5ba: {
  eventType: 'goal:progress',
  summary: 'Made progress on build-house',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight emotional intensity at 30%
[MemoryFormation] üß† Forming memory for agent 5d81b486-9ef1-4dc3-af9b-8f5753316556: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 1,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight novelty at 30%
[MemoryFormation] üß† Forming memory for agent 8bbb74ee-7106-469c-abda-d1b150513f13: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0.8
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight goal relevance at 20%
[MemoryFormation] üß† Forming memory for agent e23b8676-2c2b-43c2-a035-756930b6638f: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight social significance at 15%
[MemoryFormation] üß† Forming memory for agent cd8c8c21-35cd-4bd6-9279-e960eec078bd: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight survival relevance at 25%
[MemoryFormation] üß† Forming memory for agent 21bfd9f1-1084-477f-ae0c-8655cbd1f2da: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should combine all factors correctly
[MemoryFormation] üß† Forming memory for agent b5971289-99eb-4db2-91e0-04eef1f2103c: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0.8,
  novelty: 0.85
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should form memory when agent speaks
[MemoryFormation] üß† Forming memory for agent 968a3a19-51ff-480b-a27f-186c893808cb: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should form memory when agent listens
[MemoryFormation] üß† Forming memory for agent a2f4c68c-663a-4b74-af6d-48947287febf: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should preserve dialogue text in memory
[MemoryFormation] üß† Forming memory for agent 90c86bcd-0244-477e-8ac2-32d3a6de38aa: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should reference same conversation in both memories
[MemoryFormation] üß† Forming memory for agent 9dcca800-6418-4e0d-a5c8-4f0086892a3d: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] üß† Forming memory for agent 373ffef9-334b-4cfd-a1da-d91f3502aec0: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > event emission > should emit memory:formed event when memory created
[MemoryFormation] üß† Forming memory for agent 6a4136bf-f858-4b65-b1d4-4305cc314d6d: {
  eventType: 'harvest:first',
  summary: 'Harvested first crop',
  emotionalIntensity: 0.8,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > event emission > should include agent ID in memory:formed event
[MemoryFormation] üß† Forming memory for agent a21eb157-cc1c-499b-b025-25a3ba18212e: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0.7,
  novelty: 0
}

 ‚úì packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts  (25 tests) 9ms
stderr | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > error handling > should throw if agent has no EpisodicMemoryComponent
[MemoryFormation] Agent 2a68b5e9-91ac-4ffd-9bb6-0b9355227aae missing EpisodicMemoryComponent
[MemoryFormation] Agent has components: []
[MemoryFormation] Event that triggered memory formation: [
  {
    eventType: 'test:event',
    data: {
      agentId: '2a68b5e9-91ac-4ffd-9bb6-0b9355227aae',
      emotionalIntensity: 0.8
    }
  }
]

 ‚úì packages/core/src/components/__tests__/SocialMemoryComponent.test.ts  (22 tests) 5ms
 ‚úì packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts  (21 tests) 8ms
 ‚úì packages/core/src/__tests__/WildAnimalSpawning.test.ts  (19 tests) 9ms
stdout | packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > WeatherSystem > should update weather duration over time
[WeatherSystem] Weather changed: clear ‚Üí snow (intensity: 75%). Temp modifier: -6.0¬∞C, Movement modifier: 78%

 ‚úì packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts  (19 tests) 9ms
 ‚úì packages/core/src/buildings/__tests__/BuildingPlacement.integration.test.ts  (14 tests) 5ms
 ‚úì packages/core/src/buildings/__tests__/BuildingBlueprintRegistry.test.ts  (16 tests) 4ms
stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define all 12 action tools
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'wander',
  thinking: 'test...',
  speaking: '(silent)',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define tools with no parameters
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define tools with no parameters
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should parse structured response with tool call
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'explore',
  thinking: 'I should explore...',
  speaking: 'Let me look around!',
  tokensUsed: 150
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should handle empty thinking field
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'rest',
  thinking: '(no thoughts)',
  speaking: 'Time to rest',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should handle empty speaking (silent action)
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'wander',
  thinking: 'Just going to wander...',
  speaking: '(silent)',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should fall back to text when no tool call
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: 'I will explore the area',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use /api/chat endpoint
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use /api/chat endpoint
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should send correct request format
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should send correct request format
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use default values when not specified
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use default values when not specified
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should throw on HTTP error
[OllamaProvider] Ollama generate error: Error: Ollama API error: 500 Internal Server Error
    at OllamaProvider.generate (/Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/OllamaProvider.ts:135:15)
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/__tests__/OllamaProvider.test.ts:255:7
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:11)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7
    at withEnv (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:83:5)
[OllamaProvider] Error details: {
  message: 'Ollama API error: 500 Internal Server Error',
  model: 'qwen3:4b',
  url: 'http://localhost:11434/api/generate'
}

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should throw on network error
[OllamaProvider] Ollama generate error: Error: Network error
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/__tests__/OllamaProvider.test.ts:260:51
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7
[OllamaProvider] Error details: {
  message: 'Network error',
  model: 'qwen3:4b',
  url: 'http://localhost:11434/api/generate'
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should log empty responses
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

 ‚úì packages/llm/src/__tests__/OllamaProvider.test.ts  (15 tests) 10ms
 ‚úì packages/core/src/crafting/__tests__/RecipeRegistry.test.ts  (15 tests) 5ms
 ‚úì packages/core/src/components/__tests__/BuildingComponent.test.ts  (35 tests) 3ms
 ‚úì packages/core/src/systems/__tests__/SoilSystem.test.ts  (27 tests) 6ms
 ‚úì packages/core/src/systems/__tests__/FertilizerAction.test.ts  (26 tests) 4ms
 ‚úì packages/core/src/components/__tests__/SemanticMemoryComponent.test.ts  (18 tests) 4ms
stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should build complete prompt with all sections
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should include personality traits in prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should describe hunger levels correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should describe energy levels correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should include heard speech in prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1' ],
  seenAgentsCount: 1,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should not show hearing section when no speech
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1' ],
  seenAgentsCount: 1,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should show agents present even if silent
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1', 'agent2' ],
  seenAgentsCount: 2,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should not show empty memories section
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should show memories when present
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should show empty area when nothing nearby
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > instruction clarity > should include "don't overthink" instruction
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

 ‚úì packages/llm/src/__tests__/StructuredPromptBuilder.test.ts  (15 tests) 5ms
stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > instruction clarity > should end with response prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe trees when wood resources are visible
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'tree1', 'tree2' ],
  seenResourcesCount: 2,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'seek_food', 'gather', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe rocks when stone resources are visible
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'rock1' ],
  seenResourcesCount: 1,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'seek_food', 'gather', 'till', 'harvest', 'build' ]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe mixed resources correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'tree1', 'rock1', 'food1' ],
  seenResourcesCount: 3,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [ 'wander', 'idle', 'seek_food', 'gather', 'till', 'harvest', 'build' ]

 ‚úì packages/core/src/components/__tests__/InventoryComponent.test.ts  (16 tests) 3ms
 ‚úì packages/core/src/__tests__/AnimalComponent.test.ts  (8 tests) 3ms
 ‚úì packages/core/src/systems/__tests__/SoilDepletion.test.ts  (14 tests) 5ms
stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce seeds when transitioning vegetative ‚Üí mature

Test: Plant created - stage=vegetative, seedsProduced=0
Emitting time:day_changed event
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
After emit - daySkipCount should be > 0
Calling plantSystem.update with entities: 1
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 98d438fd: Age increased by 1.0000 days (5.00 ‚Üí 6.00) from 24.00 hours
[PlantSystem] 98d438fd: Test Plant (vegetative) age=6.0d progress=120% health=100
[PlantSystem] 98d438fd: test-plant stage vegetative ‚Üí mature (age=6.0d, health=100)
[PlantSystem] 98d438fd: Executing 1 transition effect(s) for vegetative ‚Üí mature
[PlantSystem] 98d438fd: Plant state before effects - seedsProduced=0, flowerCount=0, fruitCount=0
[PlantSystem] 98d438fd: Processing effect: produce_seeds
[PlantSystem] 98d438fd: produce_seeds effect START - plant.seedsProduced=0
[PlantSystem] 98d438fd: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 0 ‚Üí 10
[PlantSystem] 98d438fd: All effects complete - seedsProduced=10, flowerCount=0, fruitCount=0
Test: After update - stage=mature, seedsProduced=10

stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce MORE seeds when transitioning mature ‚Üí seeding

Test: Plant created - stage=mature, seedsProduced=10
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] e31cf6fe: Age increased by 1.0000 days (10.00 ‚Üí 11.00) from 24.00 hours
[PlantSystem] e31cf6fe: Test Plant (mature) age=11.0d progress=133% health=100
[PlantSystem] e31cf6fe: test-plant stage mature ‚Üí seeding (age=11.0d, health=100)
[PlantSystem] e31cf6fe: Executing 2 transition effect(s) for mature ‚Üí seeding
[PlantSystem] e31cf6fe: Plant state before effects - seedsProduced=10, flowerCount=0, fruitCount=0
[PlantSystem] e31cf6fe: Processing effect: produce_seeds
[PlantSystem] e31cf6fe: produce_seeds effect START - plant.seedsProduced=10
[PlantSystem] e31cf6fe: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 10 ‚Üí 20
[PlantSystem] e31cf6fe: Processing effect: drop_seeds
[PlantSystem] e31cf6fe: disperseSeeds called - plant.seedsProduced=20, count param=undefined
[PlantSystem] e31cf6fe: Dispersing 6 seeds in 3-tile radius
[PlantSystem] e31cf6fe: Dispersed seed at (0.0, 4.0)
[PlantSystem] e31cf6fe: Dispersed seed at (0.0, -2.0)
[PlantSystem] e31cf6fe: Dispersed seed at (-2.0, -2.0)
[PlantSystem] e31cf6fe: Dispersed seed at (0.0, 4.0)
[PlantSystem] e31cf6fe: Placed 4/6 seeds in 3-tile radius (14 remaining)
[PlantSystem] e31cf6fe: All effects complete - seedsProduced=14, flowerCount=0, fruitCount=0
Test: After update - stage=seeding, seedsProduced=14

 ‚úì packages/core/src/__tests__/PlantSeedProduction.test.ts  (3 tests) 4ms
stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce seeds correctly through full lifecycle vegetative ‚Üí mature ‚Üí seeding

Test: Initial - stage=vegetative, seedsProduced=0
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 0db91afa: Age increased by 1.0000 days (5.00 ‚Üí 6.00) from 24.00 hours
[PlantSystem] 0db91afa: Test Plant (vegetative) age=6.0d progress=120% health=100
[PlantSystem] 0db91afa: test-plant stage vegetative ‚Üí mature (age=6.0d, health=100)
[PlantSystem] 0db91afa: Executing 1 transition effect(s) for vegetative ‚Üí mature
[PlantSystem] 0db91afa: Plant state before effects - seedsProduced=0, flowerCount=0, fruitCount=0
[PlantSystem] 0db91afa: Processing effect: produce_seeds
[PlantSystem] 0db91afa: produce_seeds effect START - plant.seedsProduced=0
[PlantSystem] 0db91afa: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 0 ‚Üí 10
[PlantSystem] 0db91afa: All effects complete - seedsProduced=10, flowerCount=0, fruitCount=0
Test: After vegetative ‚Üí mature - stage=mature, seedsProduced=10
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 0db91afa: Age increased by 1.0000 days (6.00 ‚Üí 7.00) from 24.00 hours
[PlantSystem] 0db91afa: Test Plant (mature) age=7.0d progress=133% health=100
[PlantSystem] 0db91afa: test-plant stage mature ‚Üí seeding (age=7.0d, health=100)
[PlantSystem] 0db91afa: Executing 2 transition effect(s) for mature ‚Üí seeding
[PlantSystem] 0db91afa: Plant state before effects - seedsProduced=10, flowerCount=0, fruitCount=0
[PlantSystem] 0db91afa: Processing effect: produce_seeds
[PlantSystem] 0db91afa: produce_seeds effect START - plant.seedsProduced=10
[PlantSystem] 0db91afa: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 10 ‚Üí 20
[PlantSystem] 0db91afa: Processing effect: drop_seeds
[PlantSystem] 0db91afa: disperseSeeds called - plant.seedsProduced=20, count param=undefined
[PlantSystem] 0db91afa: Dispersing 6 seeds in 3-tile radius
[PlantSystem] 0db91afa: Dispersed seed at (4.0, 0.0)
[PlantSystem] 0db91afa: Dispersed seed at (2.0, 2.0)
[PlantSystem] 0db91afa: Dispersed seed at (2.0, 1.0)
[PlantSystem] 0db91afa: Placed 3/6 seeds in 3-tile radius (14 remaining)
[PlantSystem] 0db91afa: All effects complete - seedsProduced=14, flowerCount=0, fruitCount=0
Test: After mature ‚Üí seeding - stage=seeding, seedsProduced=14

 ‚úì packages/renderer/src/__tests__/GhostPreview.test.ts  (19 tests) 7ms
 ‚úì packages/world/src/chunks/__tests__/Tile.test.ts  (10 tests) 3ms
 ‚úì packages/core/src/systems/__tests__/HearingSystem.test.ts  (5 tests) 3ms
 ‚úì packages/core/src/systems/__tests__/SleepSystem.test.ts  (17 tests) 2ms
 ‚úì packages/world/src/chunks/__tests__/Chunk.test.ts  (16 tests) 3ms
 ‚úì packages/core/src/crafting/__tests__/CraftingSystem.test.ts  (14 tests) 5ms
 ‚úì packages/world/src/terrain/__tests__/PerlinNoise.test.ts  (10 tests) 5ms
 ‚úì packages/core/src/systems/__tests__/WateringAction.test.ts  (10 tests) 5ms
 ‚úì packages/core/src/events/__tests__/EventBus.test.ts  (10 tests) 4ms
 ‚úì packages/llm/src/__tests__/ResponseParser.test.ts  (12 tests) 5ms
stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should parse valid structured response
[ResponseParser] Structured response: {
  action: 'explore',
  thinking: 'I should explore to find food',
  speaking: 'Time to look around!'
}

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should handle response with no speaking
[ResponseParser] Structured response: {
  action: 'wander',
  thinking: 'Just going to wander',
  speaking: '(silent)'
}

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should parse all 12 valid actions
[ResponseParser] Structured response: { action: 'wander', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'idle', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'seek_food', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'follow_agent', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'talk', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'gather', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'explore', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'approach', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'observe', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'rest', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'work', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'help', thinking: 'test', speaking: '(silent)' }

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Text Fallback > should parse plain text with action name
[ResponseParser] Text-based match: explore

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Text Fallback > should find action anywhere in text
[ResponseParser] Text-based match: seek_food

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseBehavior - Legacy API > should extract just the action from structured response
[ResponseParser] Structured response: { action: 'talk', thinking: 'test', speaking: 'hello' }

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseBehavior - Legacy API > should work with text response
[ResponseParser] Text-based match: idle

 ‚úì packages/core/src/ecs/__tests__/ComponentRegistry.test.ts  (9 tests) 3ms
 ‚úì packages/world/src/chunks/__tests__/ChunkManager.test.ts  (9 tests) 6ms
 ‚úì packages/core/src/ecs/__tests__/Entity.test.ts  (10 tests) 5ms
 ‚úì packages/core/src/actions/__tests__/AgentAction.test.ts  (12 tests) 4ms
 ‚Üì packages/renderer/src/__tests__/BuildingPlacementUI.test.ts  (1 test | 1 skipped)
 ‚Üì packages/renderer/src/__tests__/AgentInfoPanel-thought-speech.test.ts  (19 tests | 19 skipped)
 ‚úì packages/renderer/src/__tests__/CraftingPanelUI.test.ts  (46 tests) 52ms
 ‚úì packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts  (32 tests) 78ms
stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should render inventory section below needs section when agent is selected
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should render inventory divider line before inventory section
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should not render inventory section if agent has no inventory component
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display wood resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display stone resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display food resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display water resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display all resource types simultaneously
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should not display resources with zero quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 3: Empty Inventory State > should show "(empty)" when inventory has no items
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 3: Empty Inventory State > should show capacity as "Weight: 0/100 Slots: 0/8" when empty
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should display current weight and max weight
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should display current slots and max slots
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should calculate weight correctly for mixed resources
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use white color when weight is below 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use yellow color when weight exceeds 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use red color when weight reaches 100%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use yellow color when slots exceed 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use red color when slots reach 100%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should reflect inventory changes when entity is re-rendered
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should update capacity display when weight changes
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should show empty state when all resources are consumed
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxWeight is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxWeight is undefined
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.slots is not an array
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.slots is null
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.currentWeight is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxSlots is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle inventory with only empty slots
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle inventory with partial slots filled
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle very large resource quantities
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should not overflow panel bounds with many resources
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stderr | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should not overflow panel bounds with many resources
[AgentInfoPanel] World not available or missing getEntity method


 Test Files  55 passed | 2 skipped (57)
      Tests  1123 passed | 55 skipped (1178)
   Start at  07:30:55
   Duration  1.53s (transform 1.47s, setup 7.94s, collect 2.52s, tests 422ms, environment 562ms, prepare 2.07s)

