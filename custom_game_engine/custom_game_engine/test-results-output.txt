
> @ai-village/game-engine@0.1.0 test
> vitest run


 RUN  v1.6.1 /Users/annhoward/src/ai_village/custom_game_engine

 âœ“ packages/core/src/systems/__tests__/BehaviorCompletionSignaling.test.ts  (34 tests) 4ms
 âœ“ packages/core/src/components/__tests__/BehaviorQueue.test.ts  (38 tests) 6ms
 âœ“ packages/renderer/src/__tests__/DragDropSystem.test.ts  (29 tests) 7ms
 âœ“ packages/core/src/buildings/__tests__/BuildingDefinitions.test.ts  (44 tests) 7ms
 âœ“ packages/core/src/__tests__/AnimalHousingCleanliness.test.ts  (24 tests) 4ms
stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should change grass tile to dirt terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 76.89
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.89', phosphorus: '61.51', potassium: '69.20' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.88924290397317,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set tilled flag to true
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 76.97
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.97', phosphorus: '61.57', potassium: '69.27' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.96690815218393,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set plantability counter to 3
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 73.46
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.46', phosphorus: '58.77', potassium: '66.11' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.45645946674739,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set fertility based on biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 70.85
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.85', phosphorus: '56.68', potassium: '63.76' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 70.8499503130652,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should initialize nutrients (N, P, K) based on fertility
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 71.73
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.73', phosphorus: '57.39', potassium: '64.56' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.73139975371181,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Valid Terrain Tilling > should allow tilling grass terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 79.28
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.28', phosphorus: '63.43', potassium: '71.35' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.28219059509519,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Valid Terrain Tilling > should allow tilling dirt terrain (re-tilling)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 73.86
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.86', phosphorus: '59.09', potassium: '66.48' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.86351184531442,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling stone terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling stone terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling water terrain
[SoilSystem] ===== TILLING TILE AT (3, 8) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling water terrain
[SoilSystem] âŒ ERROR: Cannot till water terrain at (3,8). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling sand terrain
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 20,
  moisture: 10,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling sand terrain
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (10,10). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should NOT modify tile state on invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should NOT modify tile state on invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should emit soil:tilled event when tilling succeeds
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 75.87
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.87', phosphorus: '60.69', potassium: '68.28' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.86509541175761,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include position in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (15, 20) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 0.00 â†’ 60.39
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '60.39', phosphorus: '48.31', potassium: '54.35' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 15, y: 20 },
    fertility: 60.38785992183338,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include fertility in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 77.85
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.85', phosphorus: '62.28', potassium: '70.07' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.85471360600162,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include biome in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 0.00 â†’ 84.53
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '84.53', phosphorus: '67.63', potassium: '76.08' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 84.53303778985297,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should NOT emit soil:tilled event on invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should NOT emit soil:tilled event on invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set plains fertility to ~70-80
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 74.94
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.94', phosphorus: '59.95', potassium: '67.44' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 74.93870349340844,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set forest fertility to ~60-70
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 0.00 â†’ 69.13
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '69.13', phosphorus: '55.30', potassium: '62.21' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 69.12663804253825,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set river fertility to ~75-85
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 0.00 â†’ 86.65
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '86.65', phosphorus: '69.32', potassium: '77.98' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 86.64773135396486,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set desert fertility to ~20-30
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'desert',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'desert': 0.00 â†’ 27.95
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '27.95', phosphorus: '22.36', potassium: '25.16' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 27.95410815704466,
    biome: 'desert'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set mountains fertility to ~40-50
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'mountains': 0.00 â†’ 45.33
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '45.33', phosphorus: '36.27', potassium: '40.80' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 45.334305656148096,
    biome: 'mountains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set ocean fertility to 0 (not farmable)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'ocean',
  fertility: 0,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'ocean': 0.00 â†’ 0.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '0.00', phosphorus: '0.00', potassium: '0.00' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: { position: { x: 5, y: 5 }, fertility: 0, biome: 'ocean' }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should throw error for undefined biome (CLAUDE.md: no silent fallbacks)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  fertility: 0,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should throw error for undefined biome (CLAUDE.md: no silent fallbacks)
[SoilSystem] âŒ CRITICAL ERROR: Tile at (5,5) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 0,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 0,
    "phosphorus": 0,
    "potassium": 0
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should allow re-tilling already tilled depleted dirt
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.77
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.77', phosphorus: '63.01', potassium: '70.89' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 78.76673655241363,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should reset plantability counter to 3 on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 74.09
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.09', phosphorus: '59.27', potassium: '66.68' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 74.08848881854615,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should refresh fertility on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 20,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 20.00 â†’ 77.40
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.40', phosphorus: '61.92', potassium: '69.66' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.40210558160082,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should emit tilling event on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 20,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 20.00 â†’ 75.78
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.78', phosphorus: '60.62', potassium: '68.20' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.78106555233732,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till before depletion
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 2
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till before depletion
[SoilSystem] âŒ ERROR: Tile at (5,5) is already tilled. Plantability: 2/3 uses remaining. Wait until depleted to re-till.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till with plantability=1
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 1
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till with plantability=1
[SoilSystem] âŒ ERROR: Tile at (5,5) is already tilled. Plantability: 1/3 uses remaining. Wait until depleted to re-till.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should throw clear error for invalid terrain type
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 0,
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should throw clear error for invalid terrain type
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include position in error message
[SoilSystem] ===== TILLING TILE AT (15, 20) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 0,
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include position in error message
[SoilSystem] âŒ ERROR: Cannot till water terrain at (15,20). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include terrain type in error message
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 0,
  moisture: 10,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include terrain type in error message
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (5,5). Only grass and dirt can be tilled.

 âœ“ packages/core/src/actions/__tests__/TillAction.test.ts  (50 tests | 8 skipped) 10ms
 âœ“ packages/core/src/__tests__/AnimalHousing.test.ts  (27 tests | 5 skipped) 8ms
stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should change terrain from grass to dirt when tilled
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 71.67
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.67', phosphorus: '57.34', potassium: '64.50' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.67095949699745,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set tilled flag to true
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 74.18
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.18', phosphorus: '59.34', potassium: '66.76' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 74.17514906461196,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set plantability counter to 3
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.03
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.03', phosphorus: '61.63', potassium: '69.33' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.03464740979932,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set fertility based on biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 74.16
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.16', phosphorus: '59.33', potassium: '66.74' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 74.16006529956647,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should initialize nutrients (N, P, K)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 79.01
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.01', phosphorus: '63.21', potassium: '71.11' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.00896575666393,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 3: Tilling Validation - Valid Terrain > should successfully till grass terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.61
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.61', phosphorus: '60.49', potassium: '68.05' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.61322571442128,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 3: Tilling Validation - Valid Terrain > should successfully till dirt terrain (re-tilling)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.19
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.19', phosphorus: '60.15', potassium: '67.67' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.19029370415986,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till stone terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till stone terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till water terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till water terrain
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till sand terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till sand terrain
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT modify tile state when validation fails
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT modify tile state when validation fails
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT emit tilling event when validation fails
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT emit tilling event when validation fails
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should call SoilSystem.tillTile with correct parameters
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 73.12
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.12', phosphorus: '58.50', potassium: '65.81' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 73.1204949527929,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should use existing fertility calculation logic
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 79.04
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.04', phosphorus: '63.23', potassium: '71.14' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.0399997038405,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should initialize nutrients based on fertility
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.59
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.59', phosphorus: '60.47', potassium: '68.03' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.59017557456863,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event when tilling succeeds
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.95
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.95', phosphorus: '61.56', potassium: '69.25' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.94697600616189,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with position data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.83
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.83', phosphorus: '60.66', potassium: '68.25' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.82803448660242,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with fertility data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.71
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.71', phosphorus: '62.17', potassium: '69.94' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.7074812430241,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with biome data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.76
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.76', phosphorus: '62.21', potassium: '69.98' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 77.76014875078357,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 70-80 for plains biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 79.84
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.84', phosphorus: '63.87', potassium: '71.85' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.83778115477824,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 60-70 for forest biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 50.00 â†’ 68.75
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '68.75', phosphorus: '55.00', potassium: '61.87' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 68.74970422384831,
    biome: 'forest'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 80-90 for river biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 50.00 â†’ 83.03
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '83.03', phosphorus: '66.42', potassium: '74.73' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 83.02827288223702,
    biome: 'river'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 20-30 for desert biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'desert',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'desert': 50.00 â†’ 24.34
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '24.34', phosphorus: '19.47', potassium: '21.90' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 24.336385715191664,
    biome: 'desert'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 40-50 for mountains biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'mountains': 50.00 â†’ 43.97
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '43.97', phosphorus: '35.17', potassium: '39.57' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 43.967244955917195,
    biome: 'mountains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 0 for ocean biome (not tillable)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'ocean',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'ocean': 50.00 â†’ 0.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '0.00', phosphorus: '0.00', potassium: '0.00' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: { position: { x: 5, y: 5 }, fertility: 0, biome: 'ocean' }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when tile is null/undefined
[SoilSystem] ===== TILLING TILE AT (5, 5) =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when position is invalid
[SoilSystem] ===== TILLING TILE AT (NaN, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when position is invalid
[SoilSystem] âŒ ERROR: tillTile requires valid position coordinates, got (NaN,5)

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw clear error message for invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw clear error message for invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT use fallback fertility values
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 71.73
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.73', phosphorus: '57.39', potassium: '64.56' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.73458117487075,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT catch and swallow errors
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT catch and swallow errors
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should allow re-tilling an already-tilled depleted tile
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.08
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.08', phosphorus: '60.06', potassium: '67.57' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.0767788669229,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 75.0767788669229,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 75.08 â†’ 76.96
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.96', phosphorus: '61.57', potassium: '69.26' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.9578839818049,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should reset plantability counter to 3 when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.73
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.73', phosphorus: '61.38', potassium: '69.06' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 76.72920301404739,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should refresh fertility when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 30,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 30.00 â†’ 79.96
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.96', phosphorus: '63.97', potassium: '71.96' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.95988950429135,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should emit tilling event when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 71.65
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.65', phosphorus: '57.32', potassium: '64.49' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 71.65356692351178,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should throw error when tilling tile without biome (CLAUDE.md)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  fertility: 50,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should throw error when tilling tile without biome (CLAUDE.md)
[SoilSystem] âŒ CRITICAL ERROR: Tile at (5,5) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 50,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 0,
    "phosphorus": 0,
    "potassium": 0
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should handle tilling at negative coordinates
[SoilSystem] ===== TILLING TILE AT (-5, -5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.27
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.27', phosphorus: '61.02', potassium: '68.64' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: -5, y: -5 },
    fertility: 76.27111250607012,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should handle tilling at large coordinates
[SoilSystem] ===== TILLING TILE AT (1000, 1000) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.71
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.71', phosphorus: '58.17', potassium: '65.44' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 1000, y: 1000 },
    fertility: 72.70710684161733,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should preserve existing moisture when tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 75,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.52
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.52', phosphorus: '60.42', potassium: '67.97' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.52439261540353,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should reset fertilizer state when tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.48
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.48', phosphorus: '60.38', potassium: '67.93' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.48107298297097,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with PlantSystem (planted flag check)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.00', phosphorus: '60.80', potassium: '68.40' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.99975776226371,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with WaterSystem (moisture tracking)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 79.94
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.94', phosphorus: '63.95', potassium: '71.94' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 79.93640532527839,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with WeatherSystem (rain effects)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  fertility: 50,
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.85
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.85', phosphorus: '60.68', potassium: '68.26' }
[SoilSystem] Emitting soil:tilled event: {
  type: 'soil:tilled',
  source: 'soil-system',
  data: {
    position: { x: 5, y: 5 },
    fertility: 75.84689849247658,
    biome: 'plains'
  }
}
[SoilSystem] ===== TILLING COMPLETE =====

 âœ“ packages/core/src/systems/__tests__/TillingAction.test.ts  (55 tests) 16ms
 âœ“ packages/core/src/__tests__/TamingSystem.test.ts  (17 tests) 7ms
 âœ“ packages/core/src/__tests__/AnimalHousingIntegration.test.ts  (14 tests | 1 skipped) 4ms
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts  (37 tests | 13 failed) 10ms
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 2: Wood Gathering (Chop Action) > should move agent toward tree when not adjacent
     â†’ expected undefined not to be undefined
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 2: Wood Gathering (Chop Action) > should harvest wood from tree when adjacent
     â†’ Entity 338cfd0f-1109-4bd9-81fd-312d88d6d919 does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 2: Wood Gathering (Chop Action) > should add harvested wood to agent inventory
     â†’ Entity b970a8c2-a873-4bd2-b99c-8ed13946c80f does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 2: Wood Gathering (Chop Action) > should emit resource:gathered event when wood is harvested
     â†’ Entity 7d220b62-18ed-4604-befc-b1e9e11e533a does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 3: Stone Gathering (Mine Action) > should move agent toward rock when not adjacent
     â†’ expected undefined not to be undefined
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 3: Stone Gathering (Mine Action) > should harvest stone from rock when adjacent
     â†’ Entity 2c5c1f7a-6064-43c1-b295-a73c6d77356b does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 3: Stone Gathering (Mine Action) > should add harvested stone to agent inventory
     â†’ Entity 933a5c5f-4d80-42eb-94d3-0ef976278964 does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 3: Stone Gathering (Mine Action) > should emit resource:gathered event when stone is mined
     â†’ Entity 7f9f22a0-46e2-43d4-86b7-90fee6f3246c does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 6: Inventory Weight Limit > should reject gathering when at maxWeight
     â†’ Entity f222bc71-2d55-4046-8aa3-c3a30dc93c65 does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 6: Inventory Weight Limit > should gather partial amount when weight limit allows
     â†’ Entity afe01bbc-1b22-4472-9baa-83d689b521cf does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 7: Gather Behavior for AISystem > should move toward nearest resource
     â†’ Agent missing PositionComponent
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 7: Gather Behavior for AISystem > should harvest when adjacent to resource
     â†’ Entity 8c4ba12e-5e15-4ae1-85eb-d6cab45e33a6 does not have component of type "position"
   â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Edge Cases > should handle multiple agents gathering same resource
     â†’ Entity bf2a2a9e-c330-44be-ad7d-b0f8ab0e5d3f does not have component of type "position"
 âœ“ packages/core/src/components/__tests__/EpisodicMemoryComponent.test.ts  (29 tests) 9ms
stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should automatically increment progress each tick for buildings < 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should calculate progress based on buildTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should not increment progress for completed buildings
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 2: Resource Deduction > should deduct resources from agent inventory on construction start
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 2: Resource Deduction > should deduct multiple resource types correctly
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit building:complete event when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should mark building as complete when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit event exactly once when crossing 100% threshold
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should create construction site when agent initiates building
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should emit construction:started event when construction begins
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should complete full construction lifecycle
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Resource Deduction Edge Cases > should handle exact resource amounts correctly
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Resource Deduction Edge Cases > should leave excess resources in inventory
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should progress from 0% to 100% over buildTime
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should handle fractional progress increments
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Multiple Buildings Simultaneously > should handle multiple buildings under construction at once
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood
[World.initiateConstruction] Consumed resources for workbench: 20 wood
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 3 building entities (3 under construction) at tick 0

 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts  (28 tests | 12 failed) 15ms
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should automatically increment progress each tick for buildings < 100%
     â†’ Entity a4b8cbec-4b57-401f-8826-fd44a85d278f missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should calculate progress based on buildTime
     â†’ Entity 36c5dd5f-83e2-482e-a23c-8b0932b46a83 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should not increment progress for completed buildings
     â†’ Entity 42bf7e62-b928-4845-903a-796d3b06f77f missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit building:complete event when progress reaches 100%
     â†’ Entity 621a9999-504b-4bb8-8ed5-f0d554b9ae29 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should mark building as complete when progress reaches 100%
     â†’ Entity 88c835a2-cbf6-4887-bb71-07d393a790dc missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit event exactly once when crossing 100% threshold
     â†’ Entity 1e339b1f-2d96-4ab2-975e-983b1df19f42 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
     â†’ Entity c9dd2339-c635-4add-9c78-7f6cbfcadf11 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should create construction site when agent initiates building
     â†’ Missing position component
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should complete full construction lifecycle
     â†’ Entity 6db28019-0ae5-4469-b9f5-c5c56530fdf1 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should progress from 0% to 100% over buildTime
     â†’ Entity 5f357b45-43c3-466d-9fb1-444757bc7520 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should handle fractional progress increments
     â†’ Entity fe3570ee-eb30-4db9-bd3f-61ca6ebd73a5 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Multiple Buildings Simultaneously > should handle multiple buildings under construction at once
     â†’ Entity b1ee2ef5-9f08-4a64-a404-d972cdaa10fc missing PositionComponent in BuildingSystem
 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts  (14 tests | 8 failed) 15ms
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 2: Deposit Behavior Handler > should find nearest storage and navigate toward it
     â†’ expected 'wander' to be 'deposit_items' // Object.is equality
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 2: Deposit Behavior Handler > should transfer items when adjacent to storage
     â†’ expected 50 to be +0 // Object.is equality
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 2: Deposit Behavior Handler > should emit items:deposited event with correct data
     â†’ expected null not to be null
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 3: Inventory Full Event Handler > should switch to deposit_items when inventory full during gathering
     â†’ expected 'gather' to be 'deposit_items' // Object.is equality
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 5: Item Transfer Logic > should transfer partial items when storage has limited space
     â†’ expected 480 to be greater than 480
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 5: Item Transfer Logic > should emit items:deposited event even for partial transfers
     â†’ expected false to be true // Object.is equality
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 6: Return to Previous Behavior > should return to previous behavior after depositing all items
     â†’ expected 'wander' to be 'gather' // Object.is equality
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Edge Cases > should emit storage:full when all storage buildings are at capacity
     â†’ expected false to be true // Object.is equality
 âœ“ packages/core/src/systems/__tests__/JournalingSystem.test.ts  (22 tests | 17 skipped) 4ms
 âœ“ packages/core/src/metrics/events/__tests__/MetricEvents.test.ts  (26 tests) 5ms
stderr | packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts > Behavior Queue Processing in AISystem > Timeout Safety > should timeout behavior after 5 minutes (300000ms)
Behavior wander timed out after 5 minutes

stderr | packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts > Behavior Queue Processing in AISystem > Timeout Safety > should log warning when behavior times out
Behavior wander timed out after 5 minutes

 âœ“ packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts  (18 tests) 5ms
 âœ“ packages/core/src/__tests__/AnimalProduction.test.ts  (15 tests) 5ms
 âœ“ packages/core/src/buildings/__tests__/CraftingStations.test.ts  (30 tests) 6ms
stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should trigger reflection when agent sleeps
[Reflection] ðŸ’­ Agent 0af7dbac is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should generate reflection from today's memories
[Reflection] ðŸ’­ Agent 795d19c8 is reflecting on 2 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 2 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should mark important memories for consolidation
[Reflection] ðŸ’­ Agent 8fc8c485 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should store reflection with timestamp
[Reflection] ðŸ’­ Agent 549c2186 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should generate coherent reflection text via LLM
[Reflection] ðŸ’­ Agent 69c3f2e4 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > reflection triggers > should trigger after significant event (importance > 0.7)
[Reflection] ðŸ’­ Agent 1c138b82 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > reflection triggers > should NOT reflect if no memories to reflect on
[Reflection] ðŸ’­ Agent abc94f8e has no memories to reflect on today

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > event emission > should emit reflection:completed when done
[Reflection] ðŸ’­ Agent 883d1981 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > event emission > should include agent ID in reflection:completed event
[Reflection] ðŸ’­ Agent ddcd39d1 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

 âœ“ packages/core/src/systems/__tests__/ReflectionSystem.test.ts  (22 tests | 4 skipped) 7ms
 âœ“ packages/core/src/__tests__/AnimalSystem.test.ts  (18 tests) 6ms
 âœ“ packages/core/src/buildings/__tests__/PlacementValidator.test.ts  (22 tests) 8ms
stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance construction progress based on time elapsed
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance different buildings at different rates based on buildTime
[BuildingSystem] Processing 2 building entities (2 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should clamp progress to 100% maximum
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should skip completed buildings
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should handle multiple simultaneous constructions
[BuildingSystem] Processing 3 building entities (3 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should mark building as complete when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit "building:complete" event on completion
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit event with correct entity ID and building type
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should only emit event once when crossing 100% threshold
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when entity missing BuildingComponent
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when entity missing PositionComponent
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when building type is unknown
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle construction at exactly 100% progress
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle progress from 99% to 101% (clamped to 100%)
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle zero deltaTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Integration with Building Types > should use correct buildTime for each building type
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts  (27 tests | 14 failed) 11ms
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance construction progress based on time elapsed
     â†’ Entity ee9a5d3e-282b-4526-9e7a-277d1a829e78 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance different buildings at different rates based on buildTime
     â†’ Entity cd0d6287-95d0-46d0-aa96-d790720abcb2 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should clamp progress to 100% maximum
     â†’ Entity 5af38c65-53d1-4b3b-b88e-faa2cbb31d9f missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should skip completed buildings
     â†’ Entity 72822e0e-ca6d-4a0f-aacc-66e015af87e0 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should handle multiple simultaneous constructions
     â†’ Entity d3789755-77cb-4f0c-ab0b-93eb3d1f4784 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should mark building as complete when progress reaches 100%
     â†’ Entity 5b9b6b42-cfa7-4062-b8c0-1fefbe7cde64 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit "building:complete" event on completion
     â†’ Entity 33e3ccec-380a-4194-a735-e7903aec600a missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit event with correct entity ID and building type
     â†’ Entity a806b47f-27ad-4378-8502-c9de945ca431 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should only emit event once when crossing 100% threshold
     â†’ Entity 2fd5b54d-aee7-44bc-a26e-bd89975ca22a missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when building type is unknown
     â†’ expected [Function] to throw error matching /unknown building type/i but got 'Entity 31c8f178-be0d-4659-9f85-90fc63â€¦'
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle construction at exactly 100% progress
     â†’ Entity 36930e2d-893a-4128-9bd9-51162c11890b missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle progress from 99% to 101% (clamped to 100%)
     â†’ Entity 4d255e53-772c-487c-9568-d9e6d4d90af3 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle zero deltaTime
     â†’ Entity da0242f7-8e53-467c-8f13-f56fc7c87b70 missing PositionComponent in BuildingSystem
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Integration with Building Types > should use correct buildTime for each building type
     â†’ Entity b50cb9a2-1c62-4fbc-953e-9f4f03209be6 missing PositionComponent in BuildingSystem
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts  (12 tests | 10 failed) 9ms
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should query memory, navigate to location, and arrive successfully
     â†’ Unknown component type: SpatialMemory. Add it to the component registry in World.ts
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should navigate across chunk boundaries without issues
     â†’ expected 250 to be greater than 256
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should parse gradient from speech, store it, and navigate
     â†’ gradientSystem is not defined
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should blend multiple gradients from different agents
     â†’ gradientSystem is not defined
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should verify accurate claim and increase trust
     â†’ expected 0.5 to be greater than 0.5
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should detect false claim and decrease trust
     â†’ expected 0.5 to be less than 0.5
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should form belief after 3 accurate claims from agent
     â†’ Unknown component type: Belief. Add it to the component registry in World.ts
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should update belief confidence with new evidence
     â†’ Unknown component type: Belief. Add it to the component registry in World.ts
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > AC8: Epistemic Humility Emergence > should show epistemic humility after trust violations
     â†’ Unknown component type: Belief. Add it to the component registry in World.ts
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Performance Test: 20 Agents @ 20 TPS > should handle 20 agents with full navigation stack
     â†’ Unknown component type: SpatialMemory. Add it to the component registry in World.ts
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts  (18 tests | 9 failed) 9ms
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should verify resource claim when agent arrives at location
     â†’ expected 0.5 to be greater than 0.5
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect stale information (resource depleted)
     â†’ expected 0.5 to be close to 0.4, received difference is 0.09999999999999998, but expected 0.005
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect misidentified resources
     â†’ expected 0.5 to be close to 0.1, received difference is 0.4, but expected 0.005
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect false reports (no resource at all)
     â†’ expected 0.5 to be close to 0.3, received difference is 0.2, but expected 0.005
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect pattern of unreliable information
     â†’ expected 0.5 to be less than 0.2
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC7: Trust Affects Cooperation - Public Callouts > should broadcast correction for false information
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification range > should verify when agent reaches claimed location
     â†’ expected 0.5 to be greater than 0.5
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_verified event for correct claims
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_violated event for false claims
     â†’ expected 0 to be greater than 0
stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory automatically on significant event
[MemoryFormation] ðŸ§  Forming memory for agent 869f2228-e205-43d4-9f35-201c028647bd: {
  eventType: 'harvest:first',
  summary: 'Harvested first wheat',
  emotionalIntensity: 0.8,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on high emotional intensity (>0.6)
[MemoryFormation] ðŸ§  Forming memory for agent ef26ad29-195c-40aa-99e9-ff43d94147a6: {
  eventType: 'social:conflict',
  summary: 'Had a conflict with bob-123',
  emotionalIntensity: 0.9,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on high novelty
[MemoryFormation] ðŸ§  Forming memory for agent 8056584f-1e9f-4391-8105-fb6ca09f5487: {
  eventType: 'discovery:location',
  summary: 'Discovered a new location',
  emotionalIntensity: 0,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on survival threat
[MemoryFormation] ðŸ§  Forming memory for agent 99ca73ed-5e96-4fff-8fb2-75b2c822d510: {
  eventType: 'need:critical',
  summary: 'My health became critically low',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on emotional intensity > 0.6
[MemoryFormation] ðŸ§  Forming memory for agent a405518f-0e86-44ce-b808-2bf4c7b4cbfb: {
  eventType: 'agent:emotion_peak',
  summary: 'Felt strong joy',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on novelty > 0.7
[MemoryFormation] ðŸ§  Forming memory for agent fd347303-64de-40ad-bb12-0604b99a8aba: {
  eventType: 'event:novel',
  summary: 'Experienced something completely new',
  emotionalIntensity: 0,
  novelty: 0.8
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on social significance > 0.5
[MemoryFormation] ðŸ§  Forming memory for agent f4687a2d-4703-4a83-9e10-60917c02d2b7: {
  eventType: 'social:interaction',
  summary: 'Interacted with alice-123',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on survival relevance > 0.5
[MemoryFormation] ðŸ§  Forming memory for agent a09901d2-d41a-49a6-b1fd-d53af9a39ee5: {
  eventType: 'survival:close_call',
  summary: 'Close call with starvation',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on goal relevance > 0.7
[MemoryFormation] ðŸ§  Forming memory for agent 9288f939-17c5-4c31-9a61-37b99f4f09e8: {
  eventType: 'goal:progress',
  summary: 'Made progress on build-house',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight emotional intensity at 30%
[MemoryFormation] ðŸ§  Forming memory for agent cb778a7a-66e2-4da1-8b94-fe1b8e9f7bb6: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 1,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight novelty at 30%
[MemoryFormation] ðŸ§  Forming memory for agent 1c59ec43-bc5f-4e4d-b08e-1233bf99798a: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0.8
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight goal relevance at 20%
[MemoryFormation] ðŸ§  Forming memory for agent 13876504-0726-4a56-a1eb-1b39b8e23968: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight social significance at 15%
[MemoryFormation] ðŸ§  Forming memory for agent fc61861c-1d2b-4063-b2cf-e93ebea09f45: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight survival relevance at 25%
[MemoryFormation] ðŸ§  Forming memory for agent fe1b59f8-5642-406f-b12d-8795bca533bc: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should combine all factors correctly
[MemoryFormation] ðŸ§  Forming memory for agent a8f4e2ce-6c69-4d73-ba2d-e75889475a40: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0.8,
  novelty: 0.85
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should form memory when agent speaks
[MemoryFormation] ðŸ§  Forming memory for agent cf98379d-b289-4fe7-9210-3d4b219abdd9: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should form memory when agent listens
[MemoryFormation] ðŸ§  Forming memory for agent f596f5bd-c8fc-4506-9a4f-984a083099f0: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should preserve dialogue text in memory
[MemoryFormation] ðŸ§  Forming memory for agent ef096864-a459-4546-b324-4f95d28d3910: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should reference same conversation in both memories
[MemoryFormation] ðŸ§  Forming memory for agent 37443dda-b89c-464b-9fe3-b6718aae9800: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent d8d6c707-c27c-4ddc-8797-2357d3c1dc2a: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > event emission > should emit memory:formed event when memory created
[MemoryFormation] ðŸ§  Forming memory for agent f881ccea-1d44-4161-ad83-69a897cd4af9: {
  eventType: 'harvest:first',
  summary: 'Harvested first crop',
  emotionalIntensity: 0.8,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > event emission > should include agent ID in memory:formed event
[MemoryFormation] ðŸ§  Forming memory for agent 03783322-de31-4b13-a7fd-606bbe437935: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0.7,
  novelty: 0
}

stderr | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > error handling > should throw if agent has no EpisodicMemoryComponent
[MemoryFormation] Agent 79d1af6e-614c-4787-a15a-29fc011e55f0 missing EpisodicMemoryComponent
[MemoryFormation] Agent has components: []
[MemoryFormation] Event that triggered memory formation: [
  {
    eventType: 'test:event',
    data: {
      agentId: '79d1af6e-614c-4787-a15a-29fc011e55f0',
      emotionalIntensity: 0.8
    }
  }
]

 âœ“ packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts  (25 tests) 8ms
 âœ“ packages/core/src/systems/__tests__/Phase9-SoilWeatherIntegration.test.ts  (39 tests) 4ms
 âœ“ packages/core/src/__tests__/WildAnimalSpawning.test.ts  (19 tests) 7ms
 âœ“ packages/core/src/components/__tests__/SocialMemoryComponent.test.ts  (22 tests) 5ms
 âœ“ packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts  (21 tests) 6ms
 âœ“ packages/core/src/buildings/__tests__/BuildingPlacement.integration.test.ts  (14 tests) 6ms
stdout | packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > WeatherSystem > should update weather duration over time
[WeatherSystem] Weather changed: clear â†’ snow (intensity: 59%). Temp modifier: -4.7Â°C, Movement modifier: 82%

 â¯ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts  (19 tests | 3 failed) 8ms
   â¯ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > TemperatureSystem > should apply health damage when in dangerous temperature
     â†’ expected 100 to be less than 100
   â¯ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > TemperatureSystem > should apply heat bonus from campfire
     â†’ expected 10 to be greater than 10
   â¯ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > TemperatureSystem > should apply building insulation effect
     â†’ expected 5 to be greater than 5
 âœ“ packages/core/src/buildings/__tests__/BuildingBlueprintRegistry.test.ts  (16 tests) 5ms
 âœ“ packages/core/src/systems/__tests__/TimeSpeedControls.test.ts  (20 tests) 4ms
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts  (16 tests | 6 failed | 2 skipped) 9ms
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC3: Exploration Covers Territory > should create spiral pattern when exploring
     â†’ actual value must be number or bigint, received "undefined"
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > sector grid conversion > should convert sector coordinates to world position
     â†’ expected 88 to be 80 // Object.is equality
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for invalid exploration mode
     â†’ expected [Function] to throw an error
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing home base in spiral mode
     â†’ expected [Function] to throw an error
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > exploration coverage metrics > should calculate exploration coverage percentage
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > exploration coverage metrics > should emit event when coverage milestone reached
     â†’ Cannot read properties of undefined (reading 'add')
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts  (13 tests | 2 failed) 7ms
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should avoid obstacles using ray-casting
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > combined behaviors > should blend seek and obstacle avoidance
     â†’ expected 0 to be greater than 0
stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define all 12 action tools
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'wander',
  thinking: 'test...',
  speaking: '(silent)',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define tools with no parameters
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define tools with no parameters
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should parse structured response with tool call
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'explore',
  thinking: 'I should explore...',
  speaking: 'Let me look around!',
  tokensUsed: 150
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should handle empty thinking field
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'rest',
  thinking: '(no thoughts)',
  speaking: 'Time to rest',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should handle empty speaking (silent action)
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'wander',
  thinking: 'Just going to wander...',
  speaking: '(silent)',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should fall back to text when no tool call
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: 'I will explore the area',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use /api/chat endpoint
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use /api/chat endpoint
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should send correct request format
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should send correct request format
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use default values when not specified
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use default values when not specified
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should throw on HTTP error
[OllamaProvider] Ollama generate error: Error: Ollama API error: 500 Internal Server Error
    at OllamaProvider.generate (/Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/OllamaProvider.ts:135:15)
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/__tests__/OllamaProvider.test.ts:255:7
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:11)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7
    at withEnv (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:83:5)
[OllamaProvider] Error details: {
  message: 'Ollama API error: 500 Internal Server Error',
  model: 'qwen3:4b',
  url: 'http://localhost:11434/api/generate'
}

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should throw on network error
[OllamaProvider] Ollama generate error: Error: Network error
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/__tests__/OllamaProvider.test.ts:260:51
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7
[OllamaProvider] Error details: {
  message: 'Network error',
  model: 'qwen3:4b',
  url: 'http://localhost:11434/api/generate'
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should log empty responses
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

 âœ“ packages/llm/src/__tests__/OllamaProvider.test.ts  (15 tests) 11ms
 âœ“ packages/core/src/crafting/__tests__/RecipeRegistry.test.ts  (15 tests) 5ms
 âœ“ packages/core/src/parsers/__tests__/GradientParser.test.ts  (31 tests) 9ms
 âœ“ packages/core/src/systems/__tests__/SoilSystem.test.ts  (27 tests) 5ms
 âœ“ packages/core/src/components/__tests__/BuildingComponent.test.ts  (35 tests) 4ms
 âœ“ packages/core/src/systems/__tests__/FertilizerAction.test.ts  (26 tests) 5ms
 âœ“ packages/core/src/components/__tests__/SemanticMemoryComponent.test.ts  (18 tests) 4ms
 âœ“ packages/core/src/components/__tests__/BeliefComponent.test.ts  (17 tests) 3ms
stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should build complete prompt with all sections
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should include personality traits in prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should describe hunger levels correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should describe energy levels correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should include heard speech in prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1' ],
  seenAgentsCount: 1,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should not show hearing section when no speech
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1' ],
  seenAgentsCount: 1,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should show agents present even if silent
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1', 'agent2' ],
  seenAgentsCount: 2,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should not show empty memories section
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should show memories when present
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should show empty area when nothing nearby
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

 âœ“ packages/llm/src/__tests__/StructuredPromptBuilder.test.ts  (15 tests) 4ms
stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > instruction clarity > should include "don't overthink" instruction
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > instruction clarity > should end with response prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe trees when wood resources are visible
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'tree1', 'tree2' ],
  seenResourcesCount: 2,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe rocks when stone resources are visible
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'rock1' ],
  seenResourcesCount: 1,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe mixed resources correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'tree1', 'rock1', 'food1' ],
  seenResourcesCount: 3,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

 âœ“ packages/core/src/components/__tests__/SocialGradientComponent.test.ts  (17 tests) 4ms
 âœ“ packages/core/src/components/__tests__/ExplorationStateComponent.test.ts  (23 tests) 4ms
 âœ“ packages/core/src/__tests__/AnimalComponent.test.ts  (8 tests) 3ms
 âœ“ packages/core/src/components/__tests__/InventoryComponent.test.ts  (16 tests) 3ms
 âœ“ packages/core/src/components/__tests__/TrustNetworkComponent.test.ts  (18 tests) 4ms
 âœ“ packages/core/src/systems/__tests__/SoilDepletion.test.ts  (14 tests) 5ms
 âœ“ packages/world/src/chunks/__tests__/Tile.test.ts  (10 tests) 3ms
 âœ“ packages/renderer/src/__tests__/GhostPreview.test.ts  (19 tests) 6ms
stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce seeds when transitioning vegetative â†’ mature

Test: Plant created - stage=vegetative, seedsProduced=0
Emitting time:day_changed event
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
After emit - daySkipCount should be > 0
Calling plantSystem.update with entities: 1
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 121b9d43: Age increased by 1.0000 days (5.00 â†’ 6.00) from 24.00 hours
[PlantSystem] 121b9d43: Test Plant (vegetative) age=6.0d progress=120% health=100
[PlantSystem] 121b9d43: test-plant stage vegetative â†’ mature (age=6.0d, health=100)
[PlantSystem] 121b9d43: Executing 1 transition effect(s) for vegetative â†’ mature
[PlantSystem] 121b9d43: Plant state before effects - seedsProduced=0, flowerCount=0, fruitCount=0
[PlantSystem] 121b9d43: Processing effect: produce_seeds
[PlantSystem] 121b9d43: produce_seeds effect START - plant.seedsProduced=0
[PlantSystem] 121b9d43: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 0 â†’ 10
[PlantSystem] 121b9d43: All effects complete - seedsProduced=10, flowerCount=0, fruitCount=0
Test: After update - stage=mature, seedsProduced=10

stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce MORE seeds when transitioning mature â†’ seeding

Test: Plant created - stage=mature, seedsProduced=10
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] aaecacef: Age increased by 1.0000 days (10.00 â†’ 11.00) from 24.00 hours
[PlantSystem] aaecacef: Test Plant (mature) age=11.0d progress=133% health=100
[PlantSystem] aaecacef: test-plant stage mature â†’ seeding (age=11.0d, health=100)
[PlantSystem] aaecacef: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] aaecacef: Plant state before effects - seedsProduced=10, flowerCount=0, fruitCount=0
[PlantSystem] aaecacef: Processing effect: produce_seeds
[PlantSystem] aaecacef: produce_seeds effect START - plant.seedsProduced=10
[PlantSystem] aaecacef: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 10 â†’ 20
[PlantSystem] aaecacef: Processing effect: drop_seeds
[PlantSystem] aaecacef: disperseSeeds called - plant.seedsProduced=20, count param=undefined
[PlantSystem] aaecacef: Dispersing 6 seeds in 3-tile radius
[PlantSystem] aaecacef: Dispersed seed at (-2.0, -2.0)
[PlantSystem] aaecacef: Dispersed seed at (0.0, -3.0)
[PlantSystem] aaecacef: Dispersed seed at (2.0, 3.0)
[PlantSystem] aaecacef: Placed 3/6 seeds in 3-tile radius (14 remaining)
[PlantSystem] aaecacef: All effects complete - seedsProduced=14, flowerCount=0, fruitCount=0
Test: After update - stage=seeding, seedsProduced=14

 âœ“ packages/core/src/__tests__/PlantSeedProduction.test.ts  (3 tests) 3ms
stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce seeds correctly through full lifecycle vegetative â†’ mature â†’ seeding

Test: Initial - stage=vegetative, seedsProduced=0
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 3a758f76: Age increased by 1.0000 days (5.00 â†’ 6.00) from 24.00 hours
[PlantSystem] 3a758f76: Test Plant (vegetative) age=6.0d progress=120% health=100
[PlantSystem] 3a758f76: test-plant stage vegetative â†’ mature (age=6.0d, health=100)
[PlantSystem] 3a758f76: Executing 1 transition effect(s) for vegetative â†’ mature
[PlantSystem] 3a758f76: Plant state before effects - seedsProduced=0, flowerCount=0, fruitCount=0
[PlantSystem] 3a758f76: Processing effect: produce_seeds
[PlantSystem] 3a758f76: produce_seeds effect START - plant.seedsProduced=0
[PlantSystem] 3a758f76: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 0 â†’ 10
[PlantSystem] 3a758f76: All effects complete - seedsProduced=10, flowerCount=0, fruitCount=0
Test: After vegetative â†’ mature - stage=mature, seedsProduced=10
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 3a758f76: Age increased by 1.0000 days (6.00 â†’ 7.00) from 24.00 hours
[PlantSystem] 3a758f76: Test Plant (mature) age=7.0d progress=133% health=100
[PlantSystem] 3a758f76: test-plant stage mature â†’ seeding (age=7.0d, health=100)
[PlantSystem] 3a758f76: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] 3a758f76: Plant state before effects - seedsProduced=10, flowerCount=0, fruitCount=0
[PlantSystem] 3a758f76: Processing effect: produce_seeds
[PlantSystem] 3a758f76: produce_seeds effect START - plant.seedsProduced=10
[PlantSystem] 3a758f76: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 10 â†’ 20
[PlantSystem] 3a758f76: Processing effect: drop_seeds
[PlantSystem] 3a758f76: disperseSeeds called - plant.seedsProduced=20, count param=undefined
[PlantSystem] 3a758f76: Dispersing 6 seeds in 3-tile radius
[PlantSystem] 3a758f76: Dispersed seed at (0.0, -1.0)
[PlantSystem] 3a758f76: Dispersed seed at (4.0, 1.0)
[PlantSystem] 3a758f76: Placed 2/6 seeds in 3-tile radius (14 remaining)
[PlantSystem] 3a758f76: All effects complete - seedsProduced=14, flowerCount=0, fruitCount=0
Test: After mature â†’ seeding - stage=seeding, seedsProduced=14

 â¯ packages/core/src/systems/__tests__/HearingSystem.test.ts  (5 tests | 2 failed) 5ms
   â¯ packages/core/src/systems/__tests__/HearingSystem.test.ts > Hearing System > should allow agents to hear nearby speech
     â†’ expected +0 to be 1 // Object.is equality
   â¯ packages/core/src/systems/__tests__/HearingSystem.test.ts > Hearing System > should hear multiple agents speaking
     â†’ expected +0 to be 2 // Object.is equality
 âœ“ packages/core/src/systems/__tests__/SleepSystem.test.ts  (17 tests) 2ms
 âœ“ packages/world/src/chunks/__tests__/Chunk.test.ts  (16 tests) 4ms
 âœ“ packages/world/src/terrain/__tests__/PerlinNoise.test.ts  (10 tests) 5ms
 âœ“ packages/core/src/components/__tests__/SpatialMemoryComponent.test.ts  (12 tests) 4ms
 âœ“ packages/core/src/crafting/__tests__/CraftingSystem.test.ts  (14 tests) 5ms
stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should parse valid structured response
[ResponseParser] Structured response: {
  action: 'explore',
  thinking: 'I should explore to find food',
  speaking: 'Time to look around!'
}

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should handle response with no speaking
[ResponseParser] Structured response: {
  action: 'wander',
  thinking: 'Just going to wander',
  speaking: '(silent)'
}

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should parse all 12 valid actions
[ResponseParser] Structured response: { action: 'wander', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'idle', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'seek_food', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'follow_agent', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'talk', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'gather', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'explore', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'approach', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'observe', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'rest', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'work', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'help', thinking: 'test', speaking: '(silent)' }

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Text Fallback > should parse plain text with action name
[ResponseParser] Text-based match: explore

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Text Fallback > should find action anywhere in text
[ResponseParser] Text-based match: seek_food

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseBehavior - Legacy API > should extract just the action from structured response
[ResponseParser] Structured response: { action: 'talk', thinking: 'test', speaking: 'hello' }

 âœ“ packages/llm/src/__tests__/ResponseParser.test.ts  (12 tests) 4ms
stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseBehavior - Legacy API > should work with text response
[ResponseParser] Text-based match: idle

 âœ“ packages/core/src/systems/__tests__/WateringAction.test.ts  (10 tests) 5ms
 âœ“ packages/core/src/events/__tests__/EventBus.test.ts  (10 tests) 4ms
 âœ“ packages/core/src/ecs/__tests__/ComponentRegistry.test.ts  (9 tests) 2ms
 âœ“ packages/core/src/ecs/__tests__/Entity.test.ts  (10 tests) 3ms
 âœ“ packages/world/src/chunks/__tests__/ChunkManager.test.ts  (9 tests) 7ms
 âœ“ packages/core/src/systems/__tests__/BehaviorQueueIntegration.test.ts  (5 tests) 2ms
 âœ“ packages/core/src/actions/__tests__/AgentAction.test.ts  (12 tests) 3ms
 â†“ packages/renderer/src/__tests__/BuildingPlacementUI.test.ts  (1 test | 1 skipped)
 â†“ packages/renderer/src/__tests__/AgentInfoPanel-thought-speech.test.ts  (19 tests | 19 skipped)
 âœ“ packages/renderer/src/__tests__/CraftingPanelUI.test.ts  (46 tests) 62ms
 âœ“ packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts  (32 tests) 91ms
stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should render inventory section below needs section when agent is selected
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should render inventory divider line before inventory section
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should not render inventory section if agent has no inventory component
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display wood resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display stone resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display food resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display water resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display all resource types simultaneously
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should not display resources with zero quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 3: Empty Inventory State > should show "(empty)" when inventory has no items
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 3: Empty Inventory State > should show capacity as "Weight: 0/100 Slots: 0/8" when empty
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should display current weight and max weight
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should display current slots and max slots
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should calculate weight correctly for mixed resources
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use white color when weight is below 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use yellow color when weight exceeds 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use red color when weight reaches 100%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use yellow color when slots exceed 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use red color when slots reach 100%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should reflect inventory changes when entity is re-rendered
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should update capacity display when weight changes
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should show empty state when all resources are consumed
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxWeight is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxWeight is undefined
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.slots is not an array
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.slots is null
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.currentWeight is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxSlots is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle inventory with only empty slots
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle inventory with partial slots filled
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle very large resource quantities
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should not overflow panel bounds with many resources
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stderr | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should not overflow panel bounds with many resources
[AgentInfoPanel] World not available or missing getEntity method


âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯ Failed Tests 79 âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should query memory, navigate to location, and arrive successfully
Error: Unknown component type: SpatialMemory. Add it to the component registry in World.ts
 â¯ EntityImpl.entity.addComponent packages/core/src/World.ts:108:17
    106|         const factory = componentRegistry[ComponentClassOrInstance];
    107|         if (!factory) {
    108|           throw new Error(`Unknown component type: ${ComponentClassOrIâ€¦
       |                 ^
    109|         }
    110|         const component = factory(data || {});
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:37:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should navigate across chunk boundaries without issues
AssertionError: expected 250 to be greater than 256
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:95:26
     93| 
     94|       // Should have crossed boundary
     95|       expect(position.x).toBeGreaterThan(256);
       |                          ^
     96|       expect(position.y).toBeGreaterThan(256);
     97|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should parse gradient from speech, store it, and navigate
ReferenceError: gradientSystem is not defined
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:127:7
    125| 
    126|       // Gradient system parses and stores
    127|       gradientSystem.update(world, 100);
       |       ^
    128| 
    129|       const socialGradient = listener.getComponent('SocialGradient');

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should blend multiple gradients from different agents
ReferenceError: gradientSystem is not defined
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:163:7
    161|       });
    162| 
    163|       gradientSystem.update(world, 100);
       |       ^
    164| 
    165|       const socialGradient = listener.getComponent('SocialGradient');

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should verify accurate claim and increase trust
AssertionError: expected 0.5 to be greater than 0.5
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:224:24
    222| 
    223|       // Trust should increase
    224|       expect(bobTrust).toBeGreaterThan(0.5);
       |                        ^
    225|     });
    226| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should detect false claim and decrease trust
AssertionError: expected 0.5 to be less than 0.5
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:257:24
    255| 
    256|       // Trust should decrease
    257|       expect(bobTrust).toBeLessThan(0.5);
       |                        ^
    258|     });
    259|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should form belief after 3 accurate claims from agent
Error: Unknown component type: Belief. Add it to the component registry in World.ts
 â¯ EntityImpl.entity.addComponent packages/core/src/World.ts:108:17
    106|         const factory = componentRegistry[ComponentClassOrInstance];
    107|         if (!factory) {
    108|           throw new Error(`Unknown component type: ${ComponentClassOrIâ€¦
       |                 ^
    109|         }
    110|         const component = factory(data || {});
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:265:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[7/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should update belief confidence with new evidence
Error: Unknown component type: Belief. Add it to the component registry in World.ts
 â¯ EntityImpl.entity.addComponent packages/core/src/World.ts:108:17
    106|         const factory = componentRegistry[ComponentClassOrInstance];
    107|         if (!factory) {
    108|           throw new Error(`Unknown component type: ${ComponentClassOrIâ€¦
       |                 ^
    109|         }
    110|         const component = factory(data || {});
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:302:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[8/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > AC8: Epistemic Humility Emergence > should show epistemic humility after trust violations
Error: Unknown component type: Belief. Add it to the component registry in World.ts
 â¯ EntityImpl.entity.addComponent packages/core/src/World.ts:108:17
    106|         const factory = componentRegistry[ComponentClassOrInstance];
    107|         if (!factory) {
    108|           throw new Error(`Unknown component type: ${ComponentClassOrIâ€¦
       |                 ^
    109|         }
    110|         const component = factory(data || {});
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:371:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[9/79]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Performance Test: 20 Agents @ 20 TPS > should handle 20 agents with full navigation stack
Error: Unknown component type: SpatialMemory. Add it to the component registry in World.ts
 â¯ EntityImpl.entity.addComponent packages/core/src/World.ts:108:17
    106|         const factory = componentRegistry[ComponentClassOrInstance];
    107|         if (!factory) {
    108|           throw new Error(`Unknown component type: ${ComponentClassOrIâ€¦
       |                 ^
    109|         }
    110|         const component = factory(data || {});
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:436:15

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[10/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should automatically increment progress each tick for buildings < 100%
Error: Entity a4b8cbec-4b57-401f-8826-fd44a85d278f missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:79:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[11/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should calculate progress based on buildTime
Error: Entity 36c5dd5f-83e2-482e-a23c-8b0932b46a83 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:94:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[12/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should not increment progress for completed buildings
Error: Entity 42bf7e62-b928-4845-903a-796d3b06f77f missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:106:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[13/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit building:complete event when progress reaches 100%
Error: Entity 621a9999-504b-4bb8-8ed5-f0d554b9ae29 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:213:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[14/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should mark building as complete when progress reaches 100%
Error: Entity 88c835a2-cbf6-4887-bb71-07d393a790dc missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:231:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[15/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit event exactly once when crossing 100% threshold
Error: Entity 1e339b1f-2d96-4ab2-975e-983b1df19f42 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:247:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[16/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
Error: Entity c9dd2339-c635-4add-9c78-7f6cbfcadf11 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:265:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[17/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should create construction site when agent initiates building
Error: Missing position component
 â¯ getComponent packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:62:22
     60|   function getComponent<T>(entity: EntityImpl, type: string): T {
     61|     const comp = entity.getComponent<T>(type as any);
     62|     if (!comp) throw new Error(`Missing ${type} component`);
       |                      ^
     63|     return comp;
     64|   }
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:298:24

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[18/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should complete full construction lifecycle
Error: Entity 6db28019-0ae5-4469-b9f5-c5c56530fdf1 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:340:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[19/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should progress from 0% to 100% over buildTime
Error: Entity 5f357b45-43c3-466d-9fb1-444757bc7520 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:485:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[20/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should handle fractional progress increments
Error: Entity fe3570ee-eb30-4db9-bd3f-61ca6ebd73a5 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:511:24

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[21/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Multiple Buildings Simultaneously > should handle multiple buildings under construction at once
Error: Entity b1ee2ef5-9f08-4a64-a404-d972cdaa10fc missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:533:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance construction progress based on time elapsed
Error: Entity ee9a5d3e-282b-4526-9e7a-277d1a829e78 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:59:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[23/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance different buildings at different rates based on buildTime
Error: Entity cd0d6287-95d0-46d0-aa96-d790720abcb2 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:81:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[24/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should clamp progress to 100% maximum
Error: Entity 5af38c65-53d1-4b3b-b88e-faa2cbb31d9f missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:97:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[25/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should skip completed buildings
Error: Entity 72822e0e-ca6d-4a0f-aacc-66e015af87e0 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:113:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[26/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should handle multiple simultaneous constructions
Error: Entity d3789755-77cb-4f0c-ab0b-93eb3d1f4784 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:138:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[27/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should mark building as complete when progress reaches 100%
Error: Entity 5b9b6b42-cfa7-4062-b8c0-1fefbe7cde64 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:154:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[28/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit "building:complete" event on completion
Error: Entity 33e3ccec-380a-4194-a735-e7903aec600a missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:171:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[29/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit event with correct entity ID and building type
Error: Entity a806b47f-27ad-4378-8502-c9de945ca431 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:193:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[30/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should only emit event once when crossing 100% threshold
Error: Entity 2fd5b54d-aee7-44bc-a26e-bd89975ca22a missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:211:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[31/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when building type is unknown
AssertionError: expected [Function] to throw error matching /unknown building type/i but got 'Entity 31c8f178-be0d-4659-9f85-90fc63â€¦'

- Expected: 
/unknown building type/i

+ Received: 
"Entity 31c8f178-be0d-4659-9f85-90fc63106235 missing PositionComponent in BuildingSystem"

 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:281:10
    279|       expect(() => {
    280|         buildingSystem.update(world, [entity], 1);
    281|       }).toThrow(/unknown building type/i);
       |          ^
    282|     });
    283|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[32/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle construction at exactly 100% progress
Error: Entity 36930e2d-893a-4128-9bd9-51162c11890b missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:298:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[33/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle progress from 99% to 101% (clamped to 100%)
Error: Entity 4d255e53-772c-487c-9568-d9e6d4d90af3 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:311:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[34/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle zero deltaTime
Error: Entity da0242f7-8e53-467c-8f13-f56fc7c87b70 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:323:22

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[35/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Integration with Building Types > should use correct buildTime for each building type
Error: Entity b50cb9a2-1c62-4fbc-953e-9f4f03209be6 missing PositionComponent in BuildingSystem
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:232:15
    230|       }
    231|       if (!position) {
    232|         throw new Error(`Entity ${entity.id} missing PositionComponentâ€¦
       |               ^
    233|       }
    234| 
 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:359:24

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[36/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC3: Exploration Covers Territory > should create spiral pattern when exploring
TypeError: actual value must be number or bigint, received "undefined"
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:73:43
     71|       // Verify spiral pattern: spiral step should increase
     72|       const explorationState = entity.getComponent('ExplorationState');
     73|       expect(explorationState.spiralStep).toBeGreaterThan(0);
       |                                           ^
     74| 
     75|       // Should have generated targets

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[37/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > sector grid conversion > should convert sector coordinates to world position
AssertionError: expected 88 to be 80 // Object.is equality

- Expected
+ Received

- 80
+ 88

 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:194:26
    192|       const worldPos = system.sectorToWorld(sector);
    193| 
    194|       expect(worldPos.x).toBe(80); // 5 * 16 = 80 (center of sector)
       |                          ^
    195|       expect(worldPos.y).toBe(80);
    196|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[38/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for invalid exploration mode
AssertionError: expected [Function] to throw an error

- Expected: 
null

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:210:10
    208|       expect(() => {
    209|         system.update(world, world.getAllEntities(), 1.0);
    210|       }).toThrow('mode');
       |          ^
    211|     });
    212| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing home base in spiral mode
AssertionError: expected [Function] to throw an error

- Expected: 
null

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:235:10
    233|       expect(() => {
    234|         system.update(world, world.getAllEntities(), 1.0);
    235|       }).toThrow('home');
       |          ^
    236|     });
    237| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[40/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > exploration coverage metrics > should calculate exploration coverage percentage
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:288:24
    286|       const coverage = system.calculateCoverage(entity);
    287| 
    288|       expect(coverage).toBeGreaterThan(0);
       |                        ^
    289|       expect(coverage).toBeLessThanOrEqual(1);
    290|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[41/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > exploration coverage metrics > should emit event when coverage milestone reached
TypeError: Cannot read properties of undefined (reading 'add')
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:312:44
    310|       for (let x = 0; x < 10; x++) {
    311|         for (let y = 0; y < 10; y++) {
    312|           explorationState.exploredSectors.add(`${x},${y}`);
       |                                            ^
    313|         }
    314|       }

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[42/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/HearingSystem.test.ts > Hearing System > should allow agents to hear nearby speech
AssertionError: expected +0 to be 1 // Object.is equality

- Expected
+ Received

- 1
+ 0

 â¯ packages/core/src/systems/__tests__/HearingSystem.test.ts:60:39
     58|     const vision = listener.getComponent('vision') as any;
     59|     expect(vision.heardSpeech).toBeDefined();
     60|     expect(vision.heardSpeech.length).toBe(1);
       |                                       ^
     61|     expect(vision.heardSpeech[0].speaker).toBe('Alice');
     62|     expect(vision.heardSpeech[0].text).toBe('Hello, is anyone there?');

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[43/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/HearingSystem.test.ts > Hearing System > should hear multiple agents speaking
AssertionError: expected +0 to be 2 // Object.is equality

- Expected
+ Received

- 2
+ 0

 â¯ packages/core/src/systems/__tests__/HearingSystem.test.ts:107:39
    105|     const vision = listener.getComponent('vision') as any;
    106|     expect(vision.heardSpeech).toBeDefined();
    107|     expect(vision.heardSpeech.length).toBe(2);
       |                                       ^
    108| 
    109|     const speakers = vision.heardSpeech.map((s: any) => s.speaker);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[44/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > TemperatureSystem > should apply health damage when in dangerous temperature
AssertionError: expected 100 to be less than 100
 â¯ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts:166:29
    164|       const needs = agent.getComponent<NeedsComponent>('needs');
    165|       expect(needs).toBeDefined();
    166|       expect(needs!.health).toBeLessThan(initialHealth);
       |                             ^
    167|     });
    168| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[45/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > TemperatureSystem > should apply heat bonus from campfire
AssertionError: expected 10 to be greater than 10
 â¯ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts:190:33
    188|       expect(temp).toBeDefined();
    189|       // Temperature should be higher than initial due to heat source
    190|       expect(temp!.currentTemp).toBeGreaterThan(10);
       |                                 ^
    191|     });
    192| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[46/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > TemperatureSystem > should apply building insulation effect
AssertionError: expected 5 to be greater than 5
 â¯ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts:214:33
    212|       expect(temp).toBeDefined();
    213|       // Temperature should be modified by building effects
    214|       expect(temp!.currentTemp).toBeGreaterThan(5);
       |                                 ^
    215|     });
    216|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[47/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 2: Wood Gathering (Chop Action) > should move agent toward tree when not adjacent
AssertionError: expected undefined not to be undefined
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:63:31
     61|       // Agent at (0,0), tree at (2,0) - distance > 1.5
     62|       const initialPosition = agent.getComponent<PositionComponent>('pâ€¦
     63|       expect(initialPosition).toBeDefined();
       |                               ^
     64| 
     65|       // After AI system processes 'chop' behavior, agent should move â€¦

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[48/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 2: Wood Gathering (Chop Action) > should harvest wood from tree when adjacent
Error: Entity 338cfd0f-1109-4bd9-81fd-312d88d6d919 does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:75:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[49/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 2: Wood Gathering (Chop Action) > should add harvested wood to agent inventory
Error: Entity b970a8c2-a873-4bd2-b99c-8ed13946c80f does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:98:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[50/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 2: Wood Gathering (Chop Action) > should emit resource:gathered event when wood is harvested
Error: Entity 7d220b62-18ed-4604-befc-b1e9e11e533a does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:148:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[51/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 3: Stone Gathering (Mine Action) > should move agent toward rock when not adjacent
AssertionError: expected undefined not to be undefined
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:204:31
    202|       // Agent at (0,0), rock at (0,2) - distance > 1.5
    203|       const initialPosition = agent.getComponent<PositionComponent>('pâ€¦
    204|       expect(initialPosition).toBeDefined();
       |                               ^
    205| 
    206|       const distance = Math.sqrt(

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[52/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 3: Stone Gathering (Mine Action) > should harvest stone from rock when adjacent
Error: Entity 2c5c1f7a-6064-43c1-b295-a73c6d77356b does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:214:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[53/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 3: Stone Gathering (Mine Action) > should add harvested stone to agent inventory
Error: Entity 933a5c5f-4d80-42eb-94d3-0ef976278964 does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:233:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[54/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 3: Stone Gathering (Mine Action) > should emit resource:gathered event when stone is mined
Error: Entity 7f9f22a0-46e2-43d4-86b7-90fee6f3246c does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:280:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[55/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 6: Inventory Weight Limit > should reject gathering when at maxWeight
Error: Entity f222bc71-2d55-4046-8aa3-c3a30dc93c65 does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:314:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[56/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 6: Inventory Weight Limit > should gather partial amount when weight limit allows
Error: Entity afe01bbc-1b22-4472-9baa-83d689b521cf does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:344:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[57/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 7: Gather Behavior for AISystem > should move toward nearest resource
Error: Agent missing PositionComponent
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:440:15
    438|       const position = agent.getComponent<PositionComponent>('positionâ€¦
    439|       if (!position) {
    440|         throw new Error('Agent missing PositionComponent');
       |               ^
    441|       }
    442| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[58/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Acceptance Criterion 7: Gather Behavior for AISystem > should harvest when adjacent to resource
Error: Entity 8c4ba12e-5e15-4ae1-85eb-d6cab45e33a6 does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:466:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[59/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ResourceGathering.test.ts > Resource Gathering System > Edge Cases > should handle multiple agents gathering same resource
Error: Entity bf2a2a9e-c330-44be-ad7d-b0f8ab0e5d3f does not have component of type "position"
 â¯ EntityImpl.updateComponent packages/core/src/ecs/Entity.ts:59:13
     57|     const current = this._components.get(type) as T | undefined;
     58|     if (!current) {
     59|       throw new Error(
       |             ^
     60|         `Entity ${this.id} does not have component of type "${type}"`
     61|       );
 â¯ packages/core/src/systems/__tests__/ResourceGathering.test.ts:777:13

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[60/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should avoid obstacles using ray-casting
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:111:37
    109| 
    110|       // Should steer away from obstacle (north or south)
    111|       expect(Math.abs(velocity.vy)).toBeGreaterThan(0);
       |                                     ^
    112|     });
    113| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[61/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > combined behaviors > should blend seek and obstacle avoidance
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:303:37
    301|       // Should both seek target AND avoid obstacle
    302|       expect(velocity.vx).toBeGreaterThan(0); // Still moving toward tâ€¦
    303|       expect(Math.abs(velocity.vy)).toBeGreaterThan(0); // But steerinâ€¦
       |                                     ^
    304|     });
    305|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[62/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 2: Deposit Behavior Handler > should find nearest storage and navigate toward it
AssertionError: expected 'wander' to be 'deposit_items' // Object.is equality

- Expected
+ Received

- deposit_items
+ wander

 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:126:35
    124|       // Agent should still be in deposit_items mode (not switched to â€¦
    125|       const agentComp = agent.getComponent<AgentComponent>('agent');
    126|       expect(agentComp?.behavior).toBe('deposit_items');
       |                                   ^
    127|     });
    128| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[63/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 2: Deposit Behavior Handler > should transfer items when adjacent to storage
AssertionError: expected 50 to be +0 // Object.is equality

- Expected
+ Received

- 0
+ 50

 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:199:39
    197| 
    198|       // Agent inventory should be empty
    199|       expect(agentInv!.currentWeight).toBe(0);
       |                                       ^
    200| 
    201|       // Storage should have the wood

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[64/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 2: Deposit Behavior Handler > should emit items:deposited event with correct data
AssertionError: expected null not to be null
 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:264:29
    262|       eventBus.flush();
    263| 
    264|       expect(eventData).not.toBeNull();
       |                             ^
    265|       expect(eventData.agentId).toBe(agent.id);
    266|       expect(eventData.storageId).toBe(storage.id);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[65/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 3: Inventory Full Event Handler > should switch to deposit_items when inventory full during gathering
AssertionError: expected 'gather' to be 'deposit_items' // Object.is equality

- Expected
+ Received

- deposit_items
+ gather

 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:365:40
    363|       // Agent should have switched to deposit_items
    364|       const agentCompAfter = agent.getComponent<AgentComponent>('agentâ€¦
    365|       expect(agentCompAfter?.behavior).toBe('deposit_items');
       |                                        ^
    366| 
    367|       // Previous behavior should be saved

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[66/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 5: Item Transfer Logic > should transfer partial items when storage has limited space
AssertionError: expected 480 to be greater than 480
 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:477:46
    475|       // Storage should be at or near capacity (480 + 20 = 500)
    476|       expect(finalStorageInv!.currentWeight).toBeLessThanOrEqual(500);
    477|       expect(finalStorageInv!.currentWeight).toBeGreaterThan(480);
       |                                              ^
    478| 
    479|       // Agent should still have most of the wood

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[67/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 5: Item Transfer Logic > should emit items:deposited event even for partial transfers
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:543:28
    541|       eventBus.flush();
    542| 
    543|       expect(eventEmitted).toBe(true);
       |                            ^
    544|     });
    545|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[68/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 6: Return to Previous Behavior > should return to previous behavior after depositing all items
AssertionError: expected 'wander' to be 'gather' // Object.is equality

- Expected
+ Received

- gather
+ wander

 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:607:40
    605|       // Agent should return to gather behavior
    606|       const agentCompAfter = agent.getComponent<AgentComponent>('agentâ€¦
    607|       expect(agentCompAfter?.behavior).toBe('gather');
       |                                        ^
    608|       expect(agentCompAfter?.behaviorState?.targetResourceId).toBe('woâ€¦
    609|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[69/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Edge Cases > should emit storage:full when all storage buildings are at capacity
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:769:28
    767|       eventBus.flush();
    768| 
    769|       expect(eventEmitted).toBe(true);
       |                            ^
    770| 
    771|       // Agent should switch to build behavior to create more storage

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[70/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should verify resource claim when agent arrives at location
AssertionError: expected 0.5 to be greater than 0.5
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:71:21
     69| 
     70|       // Trust should increase for correct claim
     71|       expect(trust).toBeGreaterThan(0.5);
       |                     ^
     72|     });
     73| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[71/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect stale information (resource depleted)
AssertionError: expected 0.5 to be close to 0.4, received difference is 0.09999999999999998, but expected 0.005
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:101:21
     99| 
    100|       // Minor penalty for stale info (-0.1)
    101|       expect(trust).toBeCloseTo(0.4, 2);
       |                     ^
    102|     });
    103| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[72/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect misidentified resources
AssertionError: expected 0.5 to be close to 0.1, received difference is 0.4, but expected 0.005
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:134:21
    132| 
    133|       // Moderate penalty for misidentification (-0.4)
    134|       expect(trust).toBeCloseTo(0.1, 2);
       |                     ^
    135|     });
    136| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[73/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect false reports (no resource at all)
AssertionError: expected 0.5 to be close to 0.3, received difference is 0.2, but expected 0.005
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:164:21
    162| 
    163|       // Penalty for false report (-0.2)
    164|       expect(trust).toBeCloseTo(0.3, 2);
       |                     ^
    165|     });
    166| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[74/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect pattern of unreliable information
AssertionError: expected 0.5 to be less than 0.2
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:201:21
    199| 
    200|       // Severe penalty for pattern (-0.8)
    201|       expect(trust).toBeLessThan(0.2);
       |                     ^
    202|     });
    203|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[75/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC7: Trust Affects Cooperation - Public Callouts > should broadcast correction for false information
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:232:33
    230| 
    231|       // Should broadcast correction
    232|       expect(broadcasts.length).toBeGreaterThan(0);
       |                                 ^
    233|       expect(broadcasts[0].data.message).toContain('no wood');
    234|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[76/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification range > should verify when agent reaches claimed location
AssertionError: expected 0.5 to be greater than 0.5
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:298:21
    296|       // Verification should occur - trust score for bob should be set
    297|       const trust = trustNetwork.getTrustScore('bob');
    298|       expect(trust).toBeGreaterThan(0.5); // Should increase from defaâ€¦
       |                     ^
    299|     });
    300|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[77/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_verified event for correct claims
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:404:29
    402|       system.update(world, world.getAllEntities(), 200);
    403| 
    404|       expect(events.length).toBeGreaterThan(0);
       |                             ^
    405|       expect(events[0].data.result).toBe('correct');
    406|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[78/79]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_violated event for false claims
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:435:29
    433|       system.update(world, world.getAllEntities(), 150);
    434| 
    435|       expect(events.length).toBeGreaterThan(0);
       |                             ^
    436|       expect(events[0].data.result).toBe('false_report');
    437|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[79/79]âŽ¯

 Test Files  10 failed | 60 passed | 2 skipped (72)
      Tests  79 failed | 1334 passed | 57 skipped (1470)
   Start at  14:07:49
   Duration  1.93s (transform 1.67s, setup 10.82s, collect 2.95s, tests 559ms, environment 545ms, prepare 2.69s)

