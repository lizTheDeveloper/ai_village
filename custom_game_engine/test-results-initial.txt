
> @ai-village/game-engine@0.1.0 test
> vitest run


 RUN  v1.6.1 /Users/annhoward/src/ai_village/custom_game_engine

 âœ“ packages/core/src/components/__tests__/BehaviorQueue.test.ts  (38 tests) 5ms
 âœ“ packages/core/src/systems/__tests__/BehaviorCompletionSignaling.test.ts  (34 tests) 5ms
 âœ“ packages/core/src/buildings/__tests__/BuildingDefinitions.test.ts  (44 tests) 8ms
 âœ“ packages/core/src/__tests__/AnimalHousingCleanliness.test.ts  (24 tests) 4ms
 âœ“ packages/core/src/__tests__/AnimalHousing.test.ts  (27 tests | 5 skipped) 5ms
stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should change grass tile to dirt terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 76.58
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.58', phosphorus: '61.26', potassium: '68.92' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set tilled flag to true
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 72.60
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.60', phosphorus: '58.08', potassium: '65.34' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set plantability counter to 3
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 70.94
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.94', phosphorus: '56.75', potassium: '63.85' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should set fertility based on biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 74.26
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.26', phosphorus: '59.41', potassium: '66.83' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Basic Tilling Success > should initialize nutrients (N, P, K) based on fertility
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 78.09
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.09', phosphorus: '62.47', potassium: '70.28' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Valid Terrain Tilling > should allow tilling grass terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 73.28
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.28', phosphorus: '58.62', potassium: '65.95' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Valid Terrain Tilling > should allow tilling dirt terrain (re-tilling)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 79.73
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.73', phosphorus: '63.78', potassium: '71.75' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling stone terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling stone terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling water terrain
[SoilSystem] ===== TILLING TILE AT (3, 8) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling water terrain
[SoilSystem] âŒ ERROR: Cannot till water terrain at (3,8). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling sand terrain
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  moisture: 10,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should throw error when tilling sand terrain
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (10,10). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should NOT modify tile state on invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Invalid Terrain Rejection > should NOT modify tile state on invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should emit soil:tilled event when tilling succeeds
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 70.58
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.58', phosphorus: '56.46', potassium: '63.52' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include position in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (15, 20) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 0.00 â†’ 60.82
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '60.82', phosphorus: '48.66', potassium: '54.74' }
[SoilSystem] Emitting soil:tilled event for (15, 20)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include fertility in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 76.95
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.95', phosphorus: '61.56', potassium: '69.25' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include biome in soil:tilled event
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 0.00 â†’ 87.22
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '87.22', phosphorus: '69.77', potassium: '78.50' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should NOT emit soil:tilled event on invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should NOT emit soil:tilled event on invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set plains fertility to ~70-80
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 0.00 â†’ 75.02
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.02', phosphorus: '60.01', potassium: '67.52' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set forest fertility to ~60-70
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 0.00 â†’ 66.50
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '66.50', phosphorus: '53.20', potassium: '59.85' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set river fertility to ~75-85
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 0.00 â†’ 84.52
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '84.52', phosphorus: '67.62', potassium: '76.07' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set desert fertility to ~20-30
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'desert',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'desert': 0.00 â†’ 28.87
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '28.87', phosphorus: '23.10', potassium: '25.98' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set mountains fertility to ~40-50
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'mountains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'mountains': 0.00 â†’ 45.43
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '45.43', phosphorus: '36.35', potassium: '40.89' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should set ocean fertility to 0 (not farmable)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'ocean',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'ocean': 0.00 â†’ 0.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '0.00', phosphorus: '0.00', potassium: '0.00' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should throw error for undefined biome (CLAUDE.md: no silent fallbacks)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Biome-Specific Fertility > should throw error for undefined biome (CLAUDE.md: no silent fallbacks)
[SoilSystem] âŒ CRITICAL ERROR: Tile at (5,5) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 0,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 0,
    "phosphorus": 0,
    "potassium": 0
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should allow re-tilling already tilled depleted dirt
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.64
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.64', phosphorus: '62.11', potassium: '69.87' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should reset plantability counter to 3 on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 71.34
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.34', phosphorus: '57.07', potassium: '64.21' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should refresh fertility on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 20.00 â†’ 78.79
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.79', phosphorus: '63.03', potassium: '70.91' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should emit tilling event on re-till
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 20.00 â†’ 75.19
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.19', phosphorus: '60.15', potassium: '67.67' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till before depletion
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 2
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till before depletion
[SoilSystem] âŒ ERROR: Tile at (5,5) is already tilled. Plantability: 2/3 uses remaining. Wait until depleted to re-till.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till with plantability=1
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 1
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Re-tilling Behavior > should throw error when attempting to re-till with plantability=1
[SoilSystem] âŒ ERROR: Tile at (5,5) is already tilled. Plantability: 1/3 uses remaining. Wait until depleted to re-till.

 â¯ packages/core/src/actions/__tests__/TillAction.test.ts  (50 tests | 3 failed | 8 skipped) 16ms
   â¯ packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include position in soil:tilled event
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "position": Object {
+   Object {
+     "data": Object {
        "x": 15,
        "y": 20,
-       },
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974718,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

   â¯ packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include fertility in soil:tilled event
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "fertility": Any<Number>,
+   Object {
+     "data": Object {
+       "x": 5,
+       "y": 5,
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974723,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

   â¯ packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include biome in soil:tilled event
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "biome": "river",
+   Object {
+     "data": Object {
+       "x": 5,
+       "y": 5,
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974724,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should throw clear error for invalid terrain type
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  moisture: 0,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should throw clear error for invalid terrain type
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include position in error message
[SoilSystem] ===== TILLING TILE AT (15, 20) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include position in error message
[SoilSystem] âŒ ERROR: Cannot till water terrain at (15,20). Only grass and dirt can be tilled.

stdout | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include terrain type in error message
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  moisture: 10,
  plantability: 0
}

stderr | packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > Error Handling - CLAUDE.md Compliance > should include terrain type in error message
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should change terrain from grass to dirt when tilled
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 71.29
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.29', phosphorus: '57.03', potassium: '64.16' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set tilled flag to true
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.16
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.16', phosphorus: '61.73', potassium: '69.45' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set plantability counter to 3
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.09
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.09', phosphorus: '60.07', potassium: '67.58' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should set fertility based on biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.48
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.48', phosphorus: '57.99', potassium: '65.24' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 2: Basic Tilling Success > should initialize nutrients (N, P, K)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.16
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.16', phosphorus: '61.72', potassium: '69.44' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 3: Tilling Validation - Valid Terrain > should successfully till grass terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 70.70
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.70', phosphorus: '56.56', potassium: '63.63' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 3: Tilling Validation - Valid Terrain > should successfully till dirt terrain (re-tilling)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.65
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.65', phosphorus: '62.92', potassium: '70.78' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till stone terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till stone terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till water terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till water terrain
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till sand terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'sand',
  tilled: false,
  biome: 'desert',
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should throw error when attempting to till sand terrain
[SoilSystem] âŒ ERROR: Cannot till sand terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT modify tile state when validation fails
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT modify tile state when validation fails
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT emit tilling event when validation fails
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 4: Tilling Validation - Invalid Terrain > should NOT emit tilling event when validation fails
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should call SoilSystem.tillTile with correct parameters
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 70.88
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.88', phosphorus: '56.70', potassium: '63.79' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should use existing fertility calculation logic
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.80
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.80', phosphorus: '62.24', potassium: '70.02' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 6: SoilSystem Integration > should initialize nutrients based on fertility
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 79.97
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.97', phosphorus: '63.97', potassium: '71.97' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event when tilling succeeds
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.01
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.01', phosphorus: '60.81', potassium: '68.41' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with position data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.77
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.77', phosphorus: '58.22', potassium: '65.50' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with fertility data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.19
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.19', phosphorus: '57.75', potassium: '64.97' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with biome data
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 75.29
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '75.29', phosphorus: '60.23', potassium: '67.76' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 70-80 for plains biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 80.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '80.00', phosphorus: '64.00', potassium: '72.00' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 60-70 for forest biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'forest',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'forest': 50.00 â†’ 65.19
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '65.19', phosphorus: '52.15', potassium: '58.67' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 80-90 for river biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'river',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'river': 50.00 â†’ 83.78
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '83.78', phosphorus: '67.03', potassium: '75.41' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 20-30 for desert biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'desert',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'desert': 50.00 â†’ 26.59
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '26.59', phosphorus: '21.28', potassium: '23.93' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 40-50 for mountains biome
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'mountains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'mountains': 50.00 â†’ 44.63
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '44.63', phosphorus: '35.70', potassium: '40.17' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 8: Fertility by Biome > should set fertility 0 for ocean biome (not tillable)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'ocean',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'ocean': 50.00 â†’ 0.00
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '0.00', phosphorus: '0.00', potassium: '0.00' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when tile is null/undefined
[SoilSystem] ===== TILLING TILE AT (5, 5) =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when position is invalid
[SoilSystem] ===== TILLING TILE AT (NaN, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw when position is invalid
[SoilSystem] âŒ ERROR: tillTile requires valid position coordinates, got (NaN,5)

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw clear error message for invalid terrain
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'stone',
  tilled: false,
  biome: 'mountains',
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should throw clear error message for invalid terrain
[SoilSystem] âŒ ERROR: Cannot till stone terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT use fallback fertility values
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.89
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.89', phosphorus: '58.31', potassium: '65.60' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT catch and swallow errors
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 11: CLAUDE.md Compliance - No Silent Fallbacks > should NOT catch and swallow errors
[SoilSystem] âŒ ERROR: Cannot till water terrain at (5,5). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should allow re-tilling an already-tilled depleted tile
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.21
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.21', phosphorus: '61.77', potassium: '69.49' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 77.21 â†’ 78.82
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.82', phosphorus: '63.05', potassium: '70.94' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should reset plantability counter to 3 when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 74.53
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.53', phosphorus: '59.63', potassium: '67.08' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should refresh fertility when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 30.00 â†’ 79.88
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '79.88', phosphorus: '63.91', potassium: '71.89' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 12: Idempotency - Re-tilling > should emit tilling event when re-tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.82
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.82', phosphorus: '61.46', potassium: '69.14' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should throw error when tilling tile without biome (CLAUDE.md)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should throw error when tilling tile without biome (CLAUDE.md)
[SoilSystem] âŒ CRITICAL ERROR: Tile at (5,5) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 50,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 0,
    "phosphorus": 0,
    "potassium": 0
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should handle tilling at negative coordinates
[SoilSystem] ===== TILLING TILE AT (-5, -5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 76.32
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '76.32', phosphorus: '61.06', potassium: '68.69' }
[SoilSystem] Emitting soil:tilled event for (-5, -5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should handle tilling at large coordinates
[SoilSystem] ===== TILLING TILE AT (1000, 1000) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 72.05
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '72.05', phosphorus: '57.64', potassium: '64.84' }
[SoilSystem] Emitting soil:tilled event for (1000, 1000)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should preserve existing moisture when tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 75,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 71.52
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '71.52', phosphorus: '57.22', potassium: '64.37' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Edge Cases > should reset fertilizer state when tilling
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'dirt',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: dirt â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.88
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.88', phosphorus: '62.30', potassium: '70.09' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with PlantSystem (planted flag check)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 74.79
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '74.79', phosphorus: '59.83', potassium: '67.31' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with WaterSystem (moisture tracking)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 78.36
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '78.36', phosphorus: '62.69', potassium: '70.52' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Integration with Other Systems > should work with WeatherSystem (rain effects)
[SoilSystem] ===== TILLING TILE AT (5, 5) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 50.00 â†’ 77.36
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '77.36', phosphorus: '61.89', potassium: '69.63' }
[SoilSystem] Emitting soil:tilled event for (5, 5)
[SoilSystem] ===== TILLING COMPLETE =====

 â¯ packages/core/src/systems/__tests__/TillingAction.test.ts  (55 tests | 3 failed) 15ms
   â¯ packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with position data
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "position": Object {
+   Object {
+     "data": Object {
        "x": 5,
        "y": 5,
      },
-     },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974722,
      "type": "soil:tilled",
    },
  ]


Number of calls: 1

   â¯ packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with fertility data
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "fertility": Any<Number>,
+   Object {
+     "data": Object {
+       "x": 5,
+       "y": 5,
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974726,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

   â¯ packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with biome data
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "biome": "plains",
+   Object {
+     "data": Object {
+       "x": 5,
+       "y": 5,
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974727,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

 âœ“ packages/core/src/systems/__tests__/SeedSystem.integration.test.ts  (35 tests) 10ms
 âœ“ packages/core/src/__tests__/AnimalHousingIntegration.test.ts  (14 tests | 1 skipped) 4ms
 â¯ packages/core/src/__tests__/TamingSystem.test.ts  (17 tests | 2 failed) 9ms
   â¯ packages/core/src/__tests__/TamingSystem.test.ts > Taming System > Acceptance Criterion 5: Taming System - Feeding Method > should successfully tame animal when attempt succeeds
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
+   Object {
+     "data": Object {
        "agentId": "agent-1",
        "animalId": "animal-4",
-       "method": "feeding",
+       "tamerId": "agent-1",
      },
      "source": "agent-1",
+     "tick": 0,
+     "timestamp": 1766648974764,
      "type": "animal_tamed",
    },
  ]


Number of calls: 1

   â¯ packages/core/src/__tests__/TamingSystem.test.ts > Taming System > Acceptance Criterion 6: Bond System > should emit bond_level_changed event when bond increases across threshold
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
+   Object {
+     "data": Object {
        "agentId": "agent-1",
        "animalId": "animal-11",
-       "bondLevel": 41,
-       "newLevel": "friendly",
-       "oldLevel": "accepting",
+       "newLevel": 41,
+       "oldLevel": 39,
      },
      "source": "agent-1",
+     "tick": 0,
+     "timestamp": 1766648974770,
      "type": "bond_level_changed",
    },
  ]


Number of calls: 1

 âœ“ packages/core/src/systems/__tests__/ResourceGathering.test.ts  (37 tests) 6ms
stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Memory Formation from Events > should automatically create memory when harvest event fires
[MemoryFormation] ðŸ§  Forming memory for agent 11c5309d-3564-4aeb-8cb9-83753f56cf77: {
  eventType: 'agent:harvested',
  summary: 'Harvested  wheat',
  emotionalIntensity: 0.6,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Memory Formation from Events > should create memories for both participants in conversation
[MemoryFormation] ðŸ§  Forming memory for agent 7e25111c-82b1-418c-91bb-45af27906d14: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0.5,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent b5330883-0501-4190-b528-d01e9e395e95: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0.5,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Memory Formation from Events > should create high-importance memory for survival events
[MemoryFormation] ðŸ§  Forming memory for agent 660a4935-1e8f-495d-a85b-b5d29b4baf6b: {
  eventType: 'need:critical',
  summary: 'My hunger became critically low',
  emotionalIntensity: 0.9,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Memory Formation from Events > should handle multiple events in sequence
[MemoryFormation] ðŸ§  Forming memory for agent e1d678c5-b7e3-4434-9e0a-ee7da4fcbf1a: {
  eventType: 'agent:harvested',
  summary: 'Harvested  wheat',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent e1d678c5-b7e3-4434-9e0a-ee7da4fcbf1a: {
  eventType: 'resource:gathered',
  summary: 'Gathered  wood',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent e1d678c5-b7e3-4434-9e0a-ee7da4fcbf1a: {
  eventType: 'agent:sleep_start',
  summary: 'Started sleeping',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Full Memory Lifecycle > should handle complete memory lifecycle: form -> recall -> consolidate -> decay
[MemoryFormation] ðŸ§  Forming memory for agent 4b2364b8-a257-4564-9c86-752ab670fe5d: {
  eventType: 'agent:harvested',
  summary: 'Harvested  wheat',
  emotionalIntensity: 0.9,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Full Memory Lifecycle > should handle multiple agents with independent memory systems
[MemoryFormation] ðŸ§  Forming memory for agent 8d931dc3-c140-4b62-822d-e55e82f80d92: {
  eventType: 'agent:harvested',
  summary: 'Harvested  wheat',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent 898536a1-d1d4-4d4b-9a8f-1916fd644898: {
  eventType: 'resource:gathered',
  summary: 'Gathered  wood',
  emotionalIntensity: 0,
  novelty: 0
}

stderr | packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts > Episodic Memory Integration > Error Handling > should skip events with missing agentId without crashing
[MemoryFormation] Event agent:harvested missing required agentId. Event data: { resourceType: 'wheat' }
[MemoryFormation] This is a programming error - the system emitting 'agent:harvested' events must include agentId in the event data.

 âœ“ packages/core/src/systems/__tests__/EpisodicMemory.integration.test.ts  (17 tests) 8ms
stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should automatically increment progress each tick for buildings < 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should calculate progress based on buildTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 1: Construction Progress Automation > should not increment progress for completed buildings
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 2: Resource Deduction > should deduct resources from agent inventory on construction start
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 2: Resource Deduction > should deduct multiple resource types correctly
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit building:complete event when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (15, 20) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (15, 20)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 7462ad5a

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should mark building as complete when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (10, 10) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity e233f0fb

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should emit event exactly once when crossing 100% threshold
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=30s, increase=33.333%)
[BuildingSystem] ðŸ—ï¸ Construction complete! campfire at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity ed8a742f
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: workbench at (42, 84) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=60s, increase=16.667%)
[BuildingSystem] ðŸ—ï¸ Construction complete! workbench at (42, 84)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 38e6aa06

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should create construction site when agent initiates building
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should emit construction:started event when construction begins
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should complete full construction lifecycle
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 0.0% â†’ 100.0% (deltaTime=31.000s, buildTime=30s, increase=103.333%)
[BuildingSystem] ðŸ—ï¸ Construction complete! campfire at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 1b446a07

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Resource Deduction Edge Cases > should handle exact resource amounts correctly
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Resource Deduction Edge Cases > should leave excess resources in inventory
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood

 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts  (28 tests | 2 failed) 13ms
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
     â†’ expected undefined to deeply equal { x: 42, y: 84 }
   â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should emit construction:started event when construction begins
     â†’ expected undefined to be 'tent' // Object.is equality
stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should progress from 0% to 100% over buildTime
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 0.0% â†’ 50.0% (deltaTime=15.000s, buildTime=30s, increase=50.000%)
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (10, 10) - 50.0% â†’ 100.0% (deltaTime=15.000s, buildTime=30s, increase=50.000%)
[BuildingSystem] ðŸ—ï¸ Construction complete! campfire at (10, 10)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity fcfd1873

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Construction Progress Integration > should handle fractional progress increments
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Multiple Buildings Simultaneously > should handle multiple buildings under construction at once
[World.initiateConstruction] Consumed resources for tent: 10 cloth, 5 wood
[World.initiateConstruction] Consumed resources for workbench: 20 wood
[World.initiateConstruction] Consumed resources for campfire: 10 stone, 5 wood
[BuildingSystem] Processing 3 building entities (3 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (10, 10) - 0.0% â†’ 11.1% (deltaTime=5.000s, buildTime=45s, increase=11.111%)
[BuildingSystem] Construction progress: workbench at (20, 10) - 0.0% â†’ 8.3% (deltaTime=5.000s, buildTime=60s, increase=8.333%)
[BuildingSystem] Construction progress: campfire at (30, 10) - 0.0% â†’ 16.7% (deltaTime=5.000s, buildTime=30s, increase=16.667%)

 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts  (14 tests | 1 failed) 10ms
   â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 2: Deposit Behavior Handler > should emit items:deposited event with correct data
     â†’ expected undefined to be 'stone' // Object.is equality
 âœ“ packages/core/src/systems/__tests__/JournalingSystem.test.ts  (22 tests | 17 skipped) 5ms
 âœ“ packages/core/src/metrics/events/__tests__/MetricEvents.test.ts  (26 tests) 5ms
 âœ“ packages/core/src/components/__tests__/EpisodicMemoryComponent.test.ts  (29 tests) 5ms
 â¯ packages/core/src/__tests__/AnimalProduction.test.ts  (15 tests | 1 failed) 8ms
   â¯ packages/core/src/__tests__/AnimalProduction.test.ts > Animal Production System > Acceptance Criterion 7: Animal Products - Periodic > should produce quantity within min/max range
     â†’ expected undefined to be 1 // Object.is equality
stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should trigger reflection when agent sleeps
[Reflection] ðŸ’­ Agent 2d3c4999 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should generate reflection from today's memories
[Reflection] ðŸ’­ Agent 42757d97 is reflecting on 2 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 2 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should mark important memories for consolidation
[Reflection] ðŸ’­ Agent dc307b78 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should store reflection with timestamp
[Reflection] ðŸ’­ Agent a5f27569 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > end-of-day reflection > should generate coherent reflection text via LLM
[Reflection] ðŸ’­ Agent 3ea3740e is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > reflection triggers > should trigger after significant event (importance > 0.7)
[Reflection] ðŸ’­ Agent 71879c10 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > reflection triggers > should NOT reflect if no memories to reflect on
[Reflection] ðŸ’­ Agent 90040436 has no memories to reflect on today

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > event emission > should emit reflection:completed when done
[Reflection] ðŸ’­ Agent 1069ea27 is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

stdout | packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > event emission > should include agent ID in reflection:completed event
[Reflection] ðŸ’­ Agent 65e56a7d is reflecting on 1 memories from today...
[Reflection] ðŸ’­ Reflection: "Reflecting on today: 1 significant moments stand out."
[Reflection] ðŸ’­ Insights: 

 â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts  (22 tests | 6 failed | 4 skipped) 10ms
   â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should trigger on week boundary (every 7 days)
     â†’ Cannot read properties of undefined (reading 'type')
   â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should trigger on season change
     â†’ Cannot read properties of undefined (reading 'type')
   â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should analyze memories since last deep reflection
     â†’ Cannot read properties of undefined (reading 'memoryIds')
   â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should identify recurring themes in memories
     â†’ Cannot read properties of undefined (reading 'themes')
   â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should update agent identity/values
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should create narrative summary
     â†’ Cannot read properties of undefined (reading 'narrative')
stderr | packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts > Behavior Queue Processing in AISystem > Timeout Safety > should timeout behavior after 5 minutes (300000ms)
Behavior wander timed out after 5 minutes

stderr | packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts > Behavior Queue Processing in AISystem > Timeout Safety > should log warning when behavior times out
Behavior wander timed out after 5 minutes

 âœ“ packages/core/src/systems/__tests__/BehaviorQueueProcessing.test.ts  (18 tests) 6ms
 âœ“ packages/renderer/src/__tests__/DragDropSystem.test.ts  (29 tests) 9ms
 âœ“ packages/core/src/buildings/__tests__/CraftingStations.test.ts  (30 tests) 7ms
 âœ“ packages/core/src/__tests__/AnimalSystem.test.ts  (18 tests) 8ms
stdout | packages/core/src/systems/__tests__/CraftingStations.integration.test.ts > CraftingStations Integration > Fuel System Integration > should consume fuel when forge has active recipe
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/CraftingStations.integration.test.ts > CraftingStations Integration > Fuel System Integration > should NOT consume fuel when forge has no active recipe
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/CraftingStations.integration.test.ts > CraftingStations Integration > Fuel System Integration > should emit station:fuel_low event when fuel drops below 20%
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/CraftingStations.integration.test.ts > CraftingStations Integration > Fuel System Integration > should emit station:fuel_empty event and stop crafting when fuel runs out
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/CraftingStations.integration.test.ts > CraftingStations Integration > Fuel System Integration > should not consume fuel below 0 (clamp at 0)
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

 âœ“ packages/core/src/systems/__tests__/CraftingStations.integration.test.ts  (19 tests) 16ms
stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance construction progress based on time elapsed
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should advance different buildings at different rates based on buildTime
[BuildingSystem] Processing 2 building entities (2 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should clamp progress to 100% maximum
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% â†’ 100.0% (deltaTime=1000.000s, buildTime=45s, increase=2222.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 75f1e3fc

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should skip completed buildings
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Progress Advancement > should handle multiple simultaneous constructions
[BuildingSystem] Processing 3 building entities (3 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 0.0% â†’ 11.1% (deltaTime=5.000s, buildTime=45s, increase=11.111%)
[BuildingSystem] Construction progress: workbench at (10, 0) - 0.0% â†’ 8.3% (deltaTime=5.000s, buildTime=60s, increase=8.333%)
[BuildingSystem] Construction progress: campfire at (20, 0) - 0.0% â†’ 16.7% (deltaTime=5.000s, buildTime=30s, increase=16.667%)

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should mark building as complete when progress reaches 100%
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 374390a3

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit "building:complete" event on completion
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (16, 32) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (16, 32)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity e78631b1

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit event with correct entity ID and building type
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: campfire at (0, 0) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=30s, increase=33.333%)
[BuildingSystem] ðŸ—ï¸ Construction complete! campfire at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity aefb4530

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should only emit event once when crossing 100% threshold
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% â†’ 100.0% (deltaTime=10.000s, buildTime=45s, increase=22.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity 8fbbcd39
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when entity missing BuildingComponent
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when entity missing PositionComponent
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Error Handling per CLAUDE.md > should throw when building type is unknown
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle construction at exactly 100% progress
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle progress from 99% to 101% (clamped to 100%)
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Construction progress: tent at (0, 0) - 99.0% â†’ 100.0% (deltaTime=1000.000s, buildTime=45s, increase=2222.222%)
[BuildingSystem] ðŸ—ï¸ Construction complete! tent at (0, 0)
[BuildingSystem] ðŸŽ‰ building:complete event emitted for entity c983b83b

stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Edge Cases > should handle zero deltaTime
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts  (27 tests | 1 failed) 9ms
   â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit "building:complete" event on completion
     â†’ expected undefined to deeply equal { x: 16, y: 32 }
stdout | packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Integration with Building Types > should use correct buildTime for each building type
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Sequential Execution > should advance queue when behavior completes
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Critical Need Interruption > should pause queue when hunger drops below 10
[AISystem] Queue processing - autonomicResult: { behavior: 'seek_food' } queuePaused: undefined hunger: 5 energy: 50
[AISystem] Autonomic interrupt - hasQueue: true hasBehaviorQueue: true queuePaused: undefined
[AISystem] After update - queuePaused: true queueInterruptedBy: seek_food

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Critical Need Interruption > should resume queue when hunger rises above 40
[AISystem] Queue processing - autonomicResult: { behavior: 'seek_food' } queuePaused: true hunger: 5 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: true hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: false hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: false hunger: 50 energy: 50

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Critical Need Interruption > should pause queue when energy drops to zero
[AISystem] Queue processing - autonomicResult: { behavior: 'forced_sleep' } queuePaused: undefined hunger: 50 energy: 0
[AISystem] Autonomic interrupt - hasQueue: true hasBehaviorQueue: true queuePaused: undefined
[AISystem] After update - queuePaused: true queueInterruptedBy: forced_sleep

stdout | packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts > Behavior Queue System Integration > Queue Lifecycle > should emit agent:queue:completed event when queue finishes
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50
[AISystem] Queue processing - autonomicResult: null queuePaused: undefined hunger: 50 energy: 50

 âœ“ packages/core/src/systems/__tests__/BehaviorQueue.integration.test.ts  (12 tests) 6ms
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts  (12 tests | 10 failed) 10ms
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should query memory, navigate to location, and arrive successfully
     â†’ entities.filter is not a function
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should navigate across chunk boundaries without issues
     â†’ expected 250 to be greater than 256
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should parse gradient from speech, store it, and navigate
     â†’ Cannot read properties of undefined (reading 'length')
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should blend multiple gradients from different agents
     â†’ Cannot read properties of undefined (reading 'length')
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should verify accurate claim and increase trust
     â†’ expected 0.5 to be greater than 0.5
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should detect false claim and decrease trust
     â†’ expected 0.5 to be less than 0.5
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should form belief after 3 accurate claims from agent
     â†’ entities.filter is not a function
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should update belief confidence with new evidence
     â†’ entities.filter is not a function
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Exploration Flow: Frontier â†’ Navigate â†’ Mark Explored > should explore frontier sectors systematically
     â†’ expected 1 to be greater than 1
   â¯ packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > AC8: Epistemic Humility Emergence > should show epistemic humility after trust violations
     â†’ world.getLLMContext is not a function
stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory automatically on significant event
[MemoryFormation] ðŸ§  Forming memory for agent 78df7e64-cf2a-48a0-b3fd-70dee2bff7b3: {
  eventType: 'harvest:first',
  summary: 'Harvested first wheat',
  emotionalIntensity: 0.8,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on high emotional intensity (>0.6)
[MemoryFormation] ðŸ§  Forming memory for agent 68ca98b5-5c85-4e8a-952b-3a54316f9f52: {
  eventType: 'social:conflict',
  summary: 'Had a conflict with bob-123',
  emotionalIntensity: 0.9,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on high novelty
[MemoryFormation] ðŸ§  Forming memory for agent 62a36df8-1aa6-4c70-a51e-0f87723f4c51: {
  eventType: 'discovery:location',
  summary: 'Discovered a new location',
  emotionalIntensity: 0,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > autonomic memory formation > should form memory on survival threat
[MemoryFormation] ðŸ§  Forming memory for agent 2b7f28fe-cba7-4ede-94e8-3c6acfe05d67: {
  eventType: 'need:critical',
  summary: 'My health became critically low',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on emotional intensity > 0.6
[MemoryFormation] ðŸ§  Forming memory for agent d9c2518e-13e3-481a-9a92-a3cdaafa2593: {
  eventType: 'agent:emotion_peak',
  summary: 'Felt strong joy',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on novelty > 0.7
[MemoryFormation] ðŸ§  Forming memory for agent 0b258528-afa0-4978-bd9c-ce62ea89acfb: {
  eventType: 'event:novel',
  summary: 'Experienced something completely new',
  emotionalIntensity: 0,
  novelty: 0.8
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on social significance > 0.5
[MemoryFormation] ðŸ§  Forming memory for agent 56302c70-be7a-4af3-bd25-a3825408e83f: {
  eventType: 'social:interaction',
  summary: 'Interacted with alice-123',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on survival relevance > 0.5
[MemoryFormation] ðŸ§  Forming memory for agent f30cc876-3ac4-4921-a9bd-137d466d65c3: {
  eventType: 'survival:close_call',
  summary: 'Close call with starvation',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > memory formation triggers > should trigger on goal relevance > 0.7
[MemoryFormation] ðŸ§  Forming memory for agent 5600b46a-e920-47e9-92eb-41564e393303: {
  eventType: 'goal:progress',
  summary: 'Made progress on build-house',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight emotional intensity at 30%
[MemoryFormation] ðŸ§  Forming memory for agent 879dcb6b-4152-4253-9bda-a5c4ad0c6dba: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 1,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight novelty at 30%
[MemoryFormation] ðŸ§  Forming memory for agent c5306296-9cb5-4cdd-ab96-26f43b5f7687: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0.8
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight goal relevance at 20%
[MemoryFormation] ðŸ§  Forming memory for agent e0d6d2d5-4ea9-4750-8123-f4f853d5ba9a: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight social significance at 15%
[MemoryFormation] ðŸ§  Forming memory for agent 2e2148f4-499f-4663-970a-48ca9982f93b: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should weight survival relevance at 25%
[MemoryFormation] ðŸ§  Forming memory for agent 2a82f10d-f5cc-4bdd-aaf5-9a9c4b67afa4: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > importance calculation > should combine all factors correctly
[MemoryFormation] ðŸ§  Forming memory for agent befd0c34-365d-4b1d-a129-0b279743b860: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0.8,
  novelty: 0.85
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should form memory when agent speaks
[MemoryFormation] ðŸ§  Forming memory for agent ae14b7f3-1c7c-414e-9046-8402995f7196: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should form memory when agent listens
[MemoryFormation] ðŸ§  Forming memory for agent 4598203f-2e58-4791-8822-e277a165beb5: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should preserve dialogue text in memory
[MemoryFormation] ðŸ§  Forming memory for agent b29cb7ba-bffa-482e-8f96-c07cb71c5a3c: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > conversation memory formation > should reference same conversation in both memories
[MemoryFormation] ðŸ§  Forming memory for agent c824d581-4539-455a-846b-5b969d80f8e0: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent 08ba4569-6b70-41fd-a9b2-dd8de08670fd: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > event emission > should emit memory:formed event when memory created
[MemoryFormation] ðŸ§  Forming memory for agent 822c1246-8e26-43f1-9808-8e99b12fc238: {
  eventType: 'harvest:first',
  summary: 'Harvested first crop',
  emotionalIntensity: 0.8,
  novelty: 1
}

stdout | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > event emission > should include agent ID in memory:formed event
[MemoryFormation] ðŸ§  Forming memory for agent e8ff1fcc-7bb4-4b74-9309-1b8bb1cdd33f: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0.7,
  novelty: 0
}

 âœ“ packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts  (25 tests) 9ms
stderr | packages/core/src/systems/__tests__/MemoryFormationSystem.test.ts > MemoryFormationSystem > error handling > should throw if agent has no EpisodicMemoryComponent
[MemoryFormation] Agent 9144f1a5-7a24-413b-8105-678ae67b745c missing EpisodicMemoryComponent
[MemoryFormation] Agent has components: []
[MemoryFormation] Event that triggered memory formation: [
  {
    eventType: 'test:event',
    data: {
      agentId: '9144f1a5-7a24-413b-8105-678ae67b745c',
      emotionalIntensity: 0.8
    }
  }
]

 âœ“ packages/core/src/buildings/__tests__/PlacementValidator.test.ts  (22 tests) 7ms
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts  (18 tests | 6 failed) 8ms
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should verify resource claim when agent arrives at location
     â†’ expected 0.09999999999999998 to be greater than 0.5
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect stale information (resource depleted)
     â†’ expected 0.3 to be close to 0.4, received difference is 0.10000000000000003, but expected 0.005
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect pattern of unreliable information
     â†’ expected 0.3 to be less than 0.2
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC7: Trust Affects Cooperation - Public Callouts > should broadcast correction for false information
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification range > should verify when agent reaches claimed location
     â†’ expected 0.09999999999999998 to be greater than 0.5
   â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_verified event for correct claims
     â†’ expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts  (21 tests | 2 failed) 8ms
   â¯ packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts > MemoryConsolidationSystem > memory strengthening > should strengthen recalled memories
     â†’ expected 0.79999952506223 to be greater than 0.8
   â¯ packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts > MemoryConsolidationSystem > memory strengthening > should increase importance of repeatedly recalled memories
     â†’ expected 0.5 to be greater than 0.5
 âœ“ packages/core/src/systems/__tests__/Phase9-SoilWeatherIntegration.test.ts  (39 tests) 5ms
stdout | packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts > Phase 8: Weather & Temperature Systems > WeatherSystem > should update weather duration over time
[WeatherSystem] Weather changed: clear â†’ rain (intensity: 43%). Movement modifier: 91%

 âœ“ packages/core/src/systems/__tests__/Phase8-WeatherTemperature.test.ts  (19 tests) 7ms
stdout | packages/core/src/systems/__tests__/SeedDispersal.integration.test.ts > Seed Dispersal Integration (Bug Fix Verification) > should emit seed:dispersed event WITH seed object (NOT undefined)
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 4b50d243: Age increased by 1.0000 days (10.00 â†’ 11.00) from 24.00 hours
[PlantSystem] 4b50d243: Grass (mature) age=11.0d progress=133% health=100
[PlantSystem] 4b50d243: grass stage mature â†’ seeding (age=11.0d, health=100)
[PlantSystem] unknown: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] unknown: Plant state before effects - seedsProduced=5, flowerCount=0, fruitCount=0
[PlantSystem] unknown: Processing effect: produce_seeds
[PlantSystem] unknown: produce_seeds effect START - plant.seedsProduced=5
[PlantSystem] unknown: produce_seeds effect EXECUTED - species.seedsPerPlant=5, yieldModifier=1.00, calculated=5, plant.seedsProduced 5 â†’ 10
[PlantSystem] unknown: Processing effect: drop_seeds
[PlantSystem] plant_17: disperseSeeds called - plant.seedsProduced=10, count param=undefined
[PlantSystem] plant_17: Dispersing 3 seeds in 2-tile radius
[PlantSystem] plant_17: Dispersed seed at (10.0, 12.0)
[PlantSystem] plant_17: Placed 1/3 seeds in 2-tile radius (7 remaining)
[PlantSystem] unknown: All effects complete - seedsProduced=7, flowerCount=0, fruitCount=0

stdout | packages/core/src/systems/__tests__/SeedDispersal.integration.test.ts > Seed Dispersal Integration (Bug Fix Verification) > should seed object have required genetics field
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 5924e1fc: Age increased by 1.0000 days (10.00 â†’ 11.00) from 24.00 hours
[PlantSystem] 5924e1fc: Grass (mature) age=11.0d progress=140% health=100
[PlantSystem] 5924e1fc: grass stage mature â†’ seeding (age=11.0d, health=100)
[PlantSystem] unknown: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] unknown: Plant state before effects - seedsProduced=5, flowerCount=0, fruitCount=0
[PlantSystem] unknown: Processing effect: produce_seeds
[PlantSystem] unknown: produce_seeds effect START - plant.seedsProduced=5
[PlantSystem] unknown: produce_seeds effect EXECUTED - species.seedsPerPlant=5, yieldModifier=1.30, calculated=6, plant.seedsProduced 5 â†’ 11
[PlantSystem] unknown: Processing effect: drop_seeds
[PlantSystem] plant_17: disperseSeeds called - plant.seedsProduced=11, count param=undefined
[PlantSystem] plant_17: Dispersing 3 seeds in 2-tile radius
[PlantSystem] plant_17: Dispersed seed at (16.0, 14.0)
[PlantSystem] plant_17: Placed 1/3 seeds in 2-tile radius (8 remaining)
[PlantSystem] unknown: All effects complete - seedsProduced=8, flowerCount=0, fruitCount=0

stdout | packages/core/src/systems/__tests__/SeedDispersal.integration.test.ts > Seed Dispersal Integration (Bug Fix Verification) > should seed inherit genetics from parent plant
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 2b2028ad: Age increased by 1.0000 days (10.00 â†’ 11.00) from 24.00 hours
[PlantSystem] 2b2028ad: Grass (mature) age=11.0d progress=150% health=100
[PlantSystem] 2b2028ad: grass stage mature â†’ seeding (age=11.0d, health=100)
[PlantSystem] unknown: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] unknown: Plant state before effects - seedsProduced=5, flowerCount=0, fruitCount=0
[PlantSystem] unknown: Processing effect: produce_seeds
[PlantSystem] unknown: produce_seeds effect START - plant.seedsProduced=5
[PlantSystem] unknown: produce_seeds effect EXECUTED - species.seedsPerPlant=5, yieldModifier=1.40, calculated=7, plant.seedsProduced 5 â†’ 12
[PlantSystem] unknown: Processing effect: drop_seeds
[PlantSystem] plant_17: disperseSeeds called - plant.seedsProduced=12, count param=undefined
[PlantSystem] plant_17: Dispersing 3 seeds in 2-tile radius
[PlantSystem] plant_17: Dispersed seed at (20.0, 22.0)
[PlantSystem] plant_17: Placed 1/3 seeds in 2-tile radius (9 remaining)
[PlantSystem] unknown: All effects complete - seedsProduced=9, flowerCount=0, fruitCount=0

stdout | packages/core/src/systems/__tests__/SeedDispersal.integration.test.ts > Seed Dispersal Integration (Bug Fix Verification) > should event handler not crash when accessing seed properties
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 83ab9e10: Age increased by 1.0000 days (10.00 â†’ 11.00) from 24.00 hours
[PlantSystem] 83ab9e10: Grass (mature) age=11.0d progress=133% health=100
[PlantSystem] 83ab9e10: grass stage mature â†’ seeding (age=11.0d, health=100)
[PlantSystem] unknown: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] unknown: Plant state before effects - seedsProduced=5, flowerCount=0, fruitCount=0
[PlantSystem] unknown: Processing effect: produce_seeds
[PlantSystem] unknown: produce_seeds effect START - plant.seedsProduced=5
[PlantSystem] unknown: produce_seeds effect EXECUTED - species.seedsPerPlant=5, yieldModifier=1.00, calculated=5, plant.seedsProduced 5 â†’ 10
[PlantSystem] unknown: Processing effect: drop_seeds
[PlantSystem] plant_17: disperseSeeds called - plant.seedsProduced=10, count param=undefined
[PlantSystem] plant_17: Dispersing 3 seeds in 2-tile radius
[PlantSystem] plant_17: Dispersed seed at (24.0, 27.0)
[PlantSystem] plant_17: Placed 1/3 seeds in 2-tile radius (7 remaining)
[PlantSystem] unknown: All effects complete - seedsProduced=7, flowerCount=0, fruitCount=0

stdout | packages/core/src/systems/__tests__/SeedDispersal.integration.test.ts > Seed Dispersal Integration (Bug Fix Verification) > should seed have quality, viability, and vigor calculated
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] baa6adac: Age increased by 1.0000 days (10.00 â†’ 11.00) from 24.00 hours
[PlantSystem] baa6adac: Grass (mature) age=11.0d progress=133% health=100
[PlantSystem] baa6adac: grass stage mature â†’ seeding (age=11.0d, health=100)
[PlantSystem] unknown: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] unknown: Plant state before effects - seedsProduced=5, flowerCount=0, fruitCount=0
[PlantSystem] unknown: Processing effect: produce_seeds
[PlantSystem] unknown: produce_seeds effect START - plant.seedsProduced=5
[PlantSystem] unknown: produce_seeds effect EXECUTED - species.seedsPerPlant=5, yieldModifier=1.00, calculated=5, plant.seedsProduced 5 â†’ 10
[PlantSystem] unknown: Processing effect: drop_seeds
[PlantSystem] plant_17: disperseSeeds called - plant.seedsProduced=10, count param=undefined
[PlantSystem] plant_17: Dispersing 3 seeds in 2-tile radius
[PlantSystem] plant_17: Dispersed seed at (28.0, 28.0)
[PlantSystem] plant_17: Dispersed seed at (32.0, 29.0)
[PlantSystem] plant_17: Placed 2/3 seeds in 2-tile radius (7 remaining)
[PlantSystem] unknown: All effects complete - seedsProduced=7, flowerCount=0, fruitCount=0

 âœ“ packages/core/src/systems/__tests__/SeedDispersal.integration.test.ts  (5 tests) 5ms
 âœ“ packages/core/src/buildings/__tests__/BuildingPlacement.integration.test.ts  (14 tests) 6ms
stdout | packages/core/src/systems/__tests__/Performance.integration.test.ts > Performance Monitoring Integration > should handle single agent efficiently
[PERF] Single agent update: 1.05ms (Goal: <100ms)

stdout | packages/core/src/systems/__tests__/Performance.integration.test.ts > Performance Monitoring Integration > should scale to 10 agents
[PERF] 10 agents update: 0.09ms (Goal: <500ms)

stdout | packages/core/src/systems/__tests__/Performance.integration.test.ts > Performance Monitoring Integration > should maintain performance over multiple frames
[PERF] 100 frames - Avg: 0.00ms, Min: 0.00ms, Max: 0.05ms (Goal avg: <50ms)

stdout | packages/core/src/systems/__tests__/Performance.integration.test.ts > Performance Monitoring Integration > should not leak memory over extended run
[PERF] 1000 iterations: 1.32ms total, 0.00ms per iteration

stdout | packages/core/src/systems/__tests__/Performance.integration.test.ts > Performance Monitoring Integration > should handle mixed entity types efficiently
[PlantSystem] Active with 10 plants, accumulated 0.04 game hours
[PERF] Mixed entities (5 agents + 5 animals): 0.59ms (Goal: <500ms)

stdout | packages/core/src/systems/__tests__/Performance.integration.test.ts > Performance Monitoring Integration > should event bus scale with listeners
[PERF] Event emit with 10 listeners: 0.00ms (Goal: <50ms)

stdout | packages/core/src/systems/__tests__/Performance.integration.test.ts > Performance Monitoring Integration > should movement system handle many agents
[PERF] Movement system with 25 agents: 0.08ms (Goal: <200ms)

stdout | packages/core/src/systems/__tests__/Performance.integration.test.ts > Performance Monitoring Integration > should system updates remain consistent
[PERF] 50 updates - Avg: 0.00ms, StdDev: 0.00ms (Goal: StdDev < 2x avg)

 âœ“ packages/core/src/systems/__tests__/Performance.integration.test.ts  (10 tests) 9ms
 âœ“ packages/core/src/__tests__/WildAnimalSpawning.test.ts  (19 tests) 7ms
 â¯ packages/core/src/systems/__tests__/AnimalComplete.integration.test.ts  (10 tests | 1 failed) 6ms
   â¯ packages/core/src/systems/__tests__/AnimalComplete.integration.test.ts > AnimalSystem + AnimalProductionSystem + AnimalHousingSystem Integration > should critical hunger cause health loss
     â†’ expected 100 to be less than 100
 âœ“ packages/core/src/components/__tests__/SocialMemoryComponent.test.ts  (22 tests) 30ms
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts  (7 tests | 4 failed) 5ms
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should emit events in correct order: time â†’ weather â†’ temperature
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should show temperature variation over day/night cycle
     â†’ expected 17.30563420590567 to be greater than or equal to 18.51462008078213
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should weather transitions affect temperature over time
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should time speed multiplier affect weather duration correctly
     â†’ Cannot read properties of undefined (reading 'duration')
 âœ“ packages/core/src/buildings/__tests__/BuildingBlueprintRegistry.test.ts  (16 tests) 4ms
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts  (16 tests | 1 failed | 2 skipped) 10ms
   â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > exploration coverage metrics > should emit event when coverage milestone reached
     â†’ ExplorationSystem failed for entity 617ff802-e449-4983-a156-5f6c1ac2bb77: Error: ExplorationSystem: Entity 617ff802-e449-4983-a156-5f6c1ac2bb77 missing required components for milestone event
 âœ“ packages/core/src/systems/__tests__/AnimalHusbandryCycle.integration.test.ts  (12 tests) 5ms
 â¯ packages/core/src/systems/__tests__/TamingComplete.integration.test.ts  (9 tests | 1 failed) 6ms
   â¯ packages/core/src/systems/__tests__/TamingComplete.integration.test.ts > TamingSystem + AnimalSystem + InventorySystem Integration > should failed taming still increase trust
     â†’ Unknown animal species: wolf
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts  (13 tests | 3 failed) 8ms
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should avoid obstacles using ray-casting
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing Position component
     â†’ expected [Function] to throw error including 'Position' but got 'SteeringSystem failed for entity ce6aâ€¦'
   â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > combined behaviors > should blend seek and obstacle avoidance
     â†’ expected 0 to be greater than 0
stdout | packages/core/src/systems/__tests__/MemoryComplete.integration.test.ts > MemoryFormationSystem + MemorySystem + EventBus Integration > should test event trigger memory formation
[MemoryFormation] ðŸ§  Forming memory for agent a861aac8-fee0-40f5-a6f6-696e416d2520: {
  eventType: 'test:event',
  summary: 'Test event',
  emotionalIntensity: 0,
  novelty: 0
}

stdout | packages/core/src/systems/__tests__/MemoryComplete.integration.test.ts > MemoryFormationSystem + MemorySystem + EventBus Integration > should conversation events create memories for both participants
[MemoryFormation] ðŸ§  Forming memory for agent 588f3d1d-f678-406a-9c8c-f444e0fb1fb5: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}
[MemoryFormation] ðŸ§  Forming memory for agent 4ef36423-3792-4070-97dc-b192ccbe2728: {
  eventType: 'conversation:utterance',
  summary: 'Experienced conversation:utterance',
  emotionalIntensity: 0,
  novelty: 0
}

 âœ“ packages/core/src/systems/__tests__/MemoryComplete.integration.test.ts  (10 tests) 4ms
stderr | packages/core/src/systems/__tests__/MemoryComplete.integration.test.ts > MemoryFormationSystem + MemorySystem + EventBus Integration > should memory formation handle missing agentId gracefully
[MemoryFormation] Event resource:gathered missing required agentId. Event data: { resourceType: 'berry', amount: 5 }
[MemoryFormation] This is a programming error - the system emitting 'resource:gathered' events must include agentId in the event data.

stdout | packages/core/src/systems/__tests__/MemoryComplete.integration.test.ts > MemoryFormationSystem + MemorySystem + EventBus Integration > should survival events create memories
[MemoryFormation] ðŸ§  Forming memory for agent 53cf637b-9007-4c3e-ae33-0d2d70bbcd97: {
  eventType: 'agent:starved',
  summary: "I'm starving and exhausted",
  emotionalIntensity: 0,
  novelty: 0
}

 âœ“ packages/core/src/systems/__tests__/TimeSpeedControls.test.ts  (20 tests) 4ms
stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define all 12 action tools
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'wander',
  thinking: 'test...',
  speaking: '(silent)',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define tools with no parameters
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Tool Definition > should define tools with no parameters
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should parse structured response with tool call
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'explore',
  thinking: 'I should explore...',
  speaking: 'Let me look around!',
  tokensUsed: 150
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should handle empty thinking field
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'rest',
  thinking: '(no thoughts)',
  speaking: 'Time to rest',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should handle empty speaking (silent action)
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: 'wander',
  thinking: 'Just going to wander...',
  speaking: '(silent)',
  tokensUsed: undefined
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Response Parsing > should fall back to text when no tool call
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: 'I will explore the area',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use /api/chat endpoint
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use /api/chat endpoint
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should send correct request format
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should send correct request format
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use default values when not specified
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > API Configuration > should use default values when not specified
[OllamaProvider] Empty response from Ollama: { message: { content: '', tool_calls: [] } }

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should throw on HTTP error
[OllamaProvider] Ollama generate error: Error: Ollama API error: 500 Internal Server Error
    at OllamaProvider.generate (/Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/OllamaProvider.ts:142:15)
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/__tests__/OllamaProvider.test.ts:255:7
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:11)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7
    at withEnv (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:83:5)
[OllamaProvider] Error details: {
  message: 'Ollama API error: 500 Internal Server Error',
  model: 'qwen3:4b',
  url: 'http://localhost:11434/api/generate'
}

stderr | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should throw on network error
[OllamaProvider] Ollama generate error: Error: Network error
    at /Users/annhoward/src/ai_village/custom_game_engine/packages/llm/src/__tests__/OllamaProvider.test.ts:260:51
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/annhoward/src/ai_village/custom_game_engine/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7
[OllamaProvider] Error details: {
  message: 'Network error',
  model: 'qwen3:4b',
  url: 'http://localhost:11434/api/generate'
}

stdout | packages/llm/src/__tests__/OllamaProvider.test.ts > OllamaProvider > Error Handling > should log empty responses
[OllamaProvider] Response: {
  model: 'qwen3:4b',
  action: '(no action)',
  thinking: '(no thoughts)',
  speaking: '(silent)',
  tokensUsed: undefined
}
[OllamaProvider] No tool call, using text fallback

 âœ“ packages/llm/src/__tests__/OllamaProvider.test.ts  (15 tests) 10ms
 âœ“ packages/core/src/crafting/__tests__/RecipeRegistry.test.ts  (15 tests) 4ms
 âœ“ packages/core/src/parsers/__tests__/GradientParser.test.ts  (31 tests) 8ms
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts  (7 tests | 4 failed) 6ms
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should apply steering forces to velocity which affects movement
     â†’ expected NaN to be greater than 10
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should apply fatigue penalties to reduce movement speed
     â†’ expected NaN to be greater than 0
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should handle obstacle avoidance with buildings
     â†’ Cannot read properties of undefined (reading 'velocityX')
   â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should combined steering behavior use obstacle avoidance
     â†’ expected 0 to be greater than 0
stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should track construction progress over time
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should emit building:complete event when construction finishes
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should initialize fuel for forge buildings on completion
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should resources regenerate over time for gathering
[ResourceGatheringSystem] berry regenerated +3.0 (now 8.0/10) on entity 25745746-2717-4216-8b7b-92ef1580d328

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should resources not regenerate beyond max amount
[ResourceGatheringSystem] wood regenerated +50.0 (now 10.0/10) on entity 35131f9d-569a-4388-815a-ba0170a2dc4e
[ResourceGatheringSystem] wood fully regenerated to 10 on entity 35131f9d-569a-4388-815a-ba0170a2dc4e

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should emit resource:regenerated event when fully regenerated
[ResourceGatheringSystem] stone regenerated +3.0 (now 10.0/10) on entity 34dbd31e-b426-46b7-ad06-1f59d32ab830
[ResourceGatheringSystem] stone fully regenerated to 10 on entity 34dbd31e-b426-46b7-ad06-1f59d32ab830

stdout | packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should construction progress be calculated based on buildTime
[BuildingSystem] Processing 1 building entities (0 under construction) at tick 0

 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts  (9 tests | 3 failed) 5ms
   â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should track construction progress over time
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should building placement confirmed event create building entity
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should construction progress be calculated based on buildTime
     â†’ expected 0 to be greater than 40
stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants advance growth over time
[PlantSystem] Active with 2 plants, accumulated 1800.00 game hours
[PlantSystem] Hourly update for 2 plants (accumulated 1800.00 hours)

stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plant health affect growth rate
[PlantSystem] Active with 3 plants, accumulated 1800.00 game hours
[PlantSystem] Hourly update for 3 plants (accumulated 1800.00 hours)

stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants emit stage transition events
[PlantSystem] Active with 2 plants, accumulated 500.00 game hours
[PlantSystem] Hourly update for 2 plants (accumulated 500.00 hours)

stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should multiple plants update independently
[PlantSystem] Active with 3 plants, accumulated 1800.00 game hours
[PlantSystem] Hourly update for 3 plants (accumulated 1800.00 hours)

stdout | packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should dead plants not grow
[PlantSystem] Active with 2 plants, accumulated 1800.00 game hours
[PlantSystem] Hourly update for 2 plants (accumulated 1800.00 hours)

 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts  (9 tests | 5 failed) 10ms
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants advance growth over time
     â†’ Plant hydration not set - required for lifecycle
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plant health affect growth rate
     â†’ Plant hydration not set - required for lifecycle
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants emit stage transition events
     â†’ Plant hydration not set - required for lifecycle
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should multiple plants update independently
     â†’ Plant hydration not set - required for lifecycle
   â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should dead plants not grow
     â†’ Plant hydration not set - required for lifecycle
stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should tilling grass create farmable soil
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 80.00 â†’ 70.20
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '70.20', phosphorus: '56.16', potassium: '63.18' }
[SoilSystem] Emitting soil:tilled event for (10, 10)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should tilling require grass or dirt terrain
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'water',
  tilled: false,
  biome: 'river',
  moisture: 100,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should tilling require grass or dirt terrain
[SoilSystem] âŒ ERROR: Cannot till water terrain at (10,10). Only grass and dirt can be tilled.

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should prevent re-tilling already tilled soil with plantability remaining
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 2
}

stderr | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should prevent re-tilling already tilled soil with plantability remaining
[SoilSystem] âŒ ERROR: Tile at (10,10) is already tilled. Plantability: 2/3 uses remaining. Wait until depleted to re-till.

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should allow re-tilling when soil is depleted
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: true,
  biome: 'plains',
  moisture: 50,
  plantability: 0
}
[SoilSystem] âœ… Validation passed - proceeding with tilling
[SoilSystem] â„¹ï¸ MANUAL TILLING (keyboard shortcut T) - Using HANDS by default (50% efficiency)
[SoilSystem] ðŸ’¡ TIP: To use agent tools, SELECT AN AGENT FIRST, then press T
[SoilSystem] ðŸ”¨ Available tools: HOE (100% efficiency) > SHOVEL (80%) > HANDS (50%)
[SoilSystem] Tool: hands, Estimated duration: 20.0s (efficiency: 50%)
[SoilSystem] Changed terrain: grass â†’ dirt
[SoilSystem] Set fertility based on biome 'plains': 80.00 â†’ 73.52
[SoilSystem] Set tile as plantable: tilled=true, plantability=3/3 uses, lastTilled=0
[SoilSystem] Initialized nutrients (NPK): { nitrogen: '73.52', phosphorus: '58.81', potassium: '66.16' }
[SoilSystem] Emitting soil:tilled event for (10, 10)
[SoilSystem] ===== TILLING COMPLETE =====

stdout | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should require biome data for tilling
[SoilSystem] ===== TILLING TILE AT (10, 10) =====
[SoilSystem] Current tile state: {
  terrain: 'grass',
  tilled: false,
  biome: undefined,
  moisture: 50,
  plantability: 0
}

stderr | packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should require biome data for tilling
[SoilSystem] âŒ CRITICAL ERROR: Tile at (10,10) has no biome data. Terrain generation failed or chunk not generated. Cannot determine fertility for farming.
[SoilSystem] Tile state: {
  "terrain": "grass",
  "moisture": 50,
  "fertility": 80,
  "tilled": false,
  "plantability": 0,
  "nutrients": {
    "nitrogen": 50,
    "phosphorus": 50,
    "potassium": 50
  },
  "fertilized": false,
  "fertilizerDuration": 0,
  "lastWatered": 0,
  "lastTilled": 0,
  "composted": false
}

 â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts  (13 tests | 2 failed) 8ms
   â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should weather system emit rain events that affect soil
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should soil system track daily updates
     â†’ Cannot set property tick of #<WorldImpl> which has only a getter
stderr | packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should hunger not decay during sleep
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!
[NeedsSystem] Entity 90dd4f59-ed90-42c1-a932-adb0dba5c78d has no needs component!

stderr | packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should temperature extremes increase needs decay when awake
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!
[NeedsSystem] Entity b6295f63-f3ad-4dc0-ac70-a9653a56f301 has no needs component!
[NeedsSystem] Entity 626f1e59-c18b-40c9-91bd-1597c9526224 has no needs component!

 â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts  (7 tests | 2 failed) 7ms
   â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should hunger not decay during sleep
     â†’ expected 0 to be greater than or equal to 75
   â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should extreme cold temperature damage health
     â†’ expected 100 to be less than 100
 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts  (9 tests | 5 failed) 10ms
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should propagate events to multiple listening systems
     â†’ Cannot read properties of undefined (reading 'subscribe')
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should maintain event ordering: time â†’ weather â†’ temperature
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should allow event listeners to modify world state
     â†’ expected 100 to be 50 // Object.is equality
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should support multiple subscribers to same event
     â†’ expected false to be true // Object.is equality
   â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should properly unsubscribe event listeners
     â†’ expected +0 to be 1 // Object.is equality
 âœ“ packages/core/src/systems/__tests__/SoilSystem.test.ts  (27 tests) 10ms
 âœ“ packages/core/src/systems/__tests__/FarmingCycle.integration.test.ts  (12 tests) 3ms
 âœ“ packages/core/src/components/__tests__/BuildingComponent.test.ts  (35 tests) 5ms
stdout | packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts > AnimalHousingSystem + AnimalSystem + BuildingSystem Integration > should building system integrate with housing system
[BuildingSystem] Processing 1 building entities (1 under construction) at tick 0

 â¯ packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts  (9 tests | 1 failed) 10ms
   â¯ packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts > AnimalHousingSystem + AnimalSystem + BuildingSystem Integration > should building system integrate with housing system
     â†’ Unknown building type: chicken_coop. Cannot determine construction time.
 âœ“ packages/core/src/systems/__tests__/FertilizerAction.test.ts  (26 tests) 5ms
stdout | packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should time advance through full day cycle
[TimeSystem] Phase changed: day â†’ dusk at 17:00
[TimeSystem] Phase changed: dusk â†’ night at 19:00
[TimeSystem] Phase changed: night â†’ dawn at 05:00

stderr | packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should needs decay over time
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!
[NeedsSystem] Entity 54b61429-85aa-445d-adfe-23ce23430097 has no needs component!

stdout | packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should multiple systems integrate over full day
[TimeSystem] Phase changed: day â†’ dusk at 17:00

stderr | packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should multiple systems integrate over full day
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!
[NeedsSystem] Entity 655abac0-f1ec-4be7-9ffb-79fbd7fe8fe3 has no needs component!

stdout | packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should day counter increment correctly
[TimeSystem] Phase changed: day â†’ dusk at 17:00
[TimeSystem] Phase changed: dusk â†’ night at 19:00
[TimeSystem] Phase changed: night â†’ dawn at 05:00
[TimeSystem] Phase changed: dawn â†’ day at 07:00
[TimeSystem] Phase changed: day â†’ dusk at 17:00
[TimeSystem] Phase changed: dusk â†’ night at 19:00
[TimeSystem] Phase changed: night â†’ dawn at 05:00
[TimeSystem] Phase changed: dawn â†’ day at 07:00
[TimeSystem] Phase changed: day â†’ dusk at 17:00
[TimeSystem] Phase changed: dusk â†’ night at 19:00
[TimeSystem] Phase changed: night â†’ dawn at 05:00

stderr | packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should temperature system affect health over time
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!
[NeedsSystem] Entity 88dcfa3f-7f79-43a4-90a7-f1be964bbdd8 has no needs component!

stdout | packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should full day cycle emit all expected events
[TimeSystem] Phase changed: day â†’ dusk at 17:00
[TimeSystem] Phase changed: dusk â†’ night at 19:00
[TimeSystem] Phase changed: night â†’ dawn at 05:00

 â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts  (11 tests | 4 failed) 7ms
   â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should time advance through full day cycle
     â†’ expected NaN to be less than 2
   â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should weather change during day
     â†’ Cannot read properties of undefined (reading 'duration')
   â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should temperature vary with time of day
     â†’ actual value must be number or bigint, received "undefined"
   â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should full day cycle emit all expected events
     â†’ expected 0 to be greater than 0
 âœ“ packages/core/src/components/__tests__/BeliefComponent.test.ts  (17 tests) 4ms
 âœ“ packages/core/src/components/__tests__/SemanticMemoryComponent.test.ts  (18 tests) 4ms
 â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts  (10 tests | 7 failed) 7ms
   â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should social gradient component initialize
     â†’ expected undefined not to be undefined
   â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should gradients detect nearby agents
     â†’ Cannot read properties of undefined (reading 'length')
   â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should trust levels influence social force
     â†’ expected undefined not to be undefined
   â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should low trust create repulsion
     â†’ expected undefined not to be undefined
   â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should multiple agents create combined gradient field
     â†’ Cannot read properties of undefined (reading 'nearbyAgents')
   â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should gradient strength decay with distance
     â†’ Cannot read properties of undefined (reading 'nearbyAgents')
   â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should social force vectors have valid magnitude
     â†’ Cannot read properties of undefined (reading 'x')
 âœ“ packages/core/src/systems/__tests__/CraftingComplete.integration.test.ts  (10 tests) 5ms
stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should build complete prompt with all sections
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should include personality traits in prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should describe hunger levels correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > buildPrompt > should describe energy levels correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should include heard speech in prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1' ],
  seenAgentsCount: 1,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should not show hearing section when no speech
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1' ],
  seenAgentsCount: 1,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > hearing system integration > should show agents present even if silent
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [ 'agent1', 'agent2' ],
  seenAgentsCount: 2,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'talk',
  'follow_agent',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should not show empty memories section
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should show memories when present
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > context collapse > should show empty area when nothing nearby
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > instruction clarity > should include "don't overthink" instruction
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > instruction clarity > should end with response prompt
[StructuredPromptBuilder] Vision state: {
  seenResources: [],
  seenResourcesCount: 0,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe trees when wood resources are visible
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'tree1', 'tree2' ],
  seenResourcesCount: 2,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe rocks when stone resources are visible
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'rock1' ],
  seenResourcesCount: 1,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

stdout | packages/llm/src/__tests__/StructuredPromptBuilder.test.ts > StructuredPromptBuilder > resource type descriptions > should describe mixed resources correctly
[StructuredPromptBuilder] Vision state: {
  seenResources: [ 'tree1', 'rock1', 'food1' ],
  seenResourcesCount: 3,
  seenAgents: [],
  seenAgentsCount: 0,
  canSeeResources: undefined
}
[StructuredPromptBuilder] Final available actions: [
  'wander',
  'idle',
  'seek_food',
  'gather',
  'till',
  'harvest',
  'build',
  'navigate',
  'explore_frontier',
  'explore_spiral'
]

 âœ“ packages/llm/src/__tests__/StructuredPromptBuilder.test.ts  (15 tests) 5ms
 âœ“ packages/core/src/components/__tests__/SocialGradientComponent.test.ts  (17 tests) 4ms
 â¯ packages/core/src/systems/__tests__/SaveLoad.integration.test.ts  (16 tests | 1 failed) 6ms
   â¯ packages/core/src/systems/__tests__/SaveLoad.integration.test.ts > Save/Load Persistence Integration > should preserve component data structure
     â†’ expected undefined to be 75 // Object.is equality
 âœ“ packages/core/src/components/__tests__/ExplorationStateComponent.test.ts  (23 tests) 5ms
 âœ“ packages/core/src/__tests__/PlantSeedProduction.test.ts  (3 tests) 4ms
stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce seeds when transitioning vegetative â†’ mature

Test: Plant created - stage=vegetative, seedsProduced=0
Emitting time:day_changed event
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
After emit - daySkipCount should be > 0
Calling plantSystem.update with entities: 1
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] ba03ed6a: Age increased by 1.0000 days (5.00 â†’ 6.00) from 24.00 hours
[PlantSystem] ba03ed6a: Test Plant (vegetative) age=6.0d progress=120% health=100
[PlantSystem] ba03ed6a: test-plant stage vegetative â†’ mature (age=6.0d, health=100)
[PlantSystem] ba03ed6a: Executing 1 transition effect(s) for vegetative â†’ mature
[PlantSystem] ba03ed6a: Plant state before effects - seedsProduced=0, flowerCount=0, fruitCount=0
[PlantSystem] ba03ed6a: Processing effect: produce_seeds
[PlantSystem] ba03ed6a: produce_seeds effect START - plant.seedsProduced=0
[PlantSystem] ba03ed6a: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 0 â†’ 10
[PlantSystem] ba03ed6a: All effects complete - seedsProduced=10, flowerCount=0, fruitCount=0
Test: After update - stage=mature, seedsProduced=10

stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce MORE seeds when transitioning mature â†’ seeding

Test: Plant created - stage=mature, seedsProduced=10
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] c2f8a468: Age increased by 1.0000 days (10.00 â†’ 11.00) from 24.00 hours
[PlantSystem] c2f8a468: Test Plant (mature) age=11.0d progress=133% health=100
[PlantSystem] c2f8a468: test-plant stage mature â†’ seeding (age=11.0d, health=100)
[PlantSystem] c2f8a468: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] c2f8a468: Plant state before effects - seedsProduced=10, flowerCount=0, fruitCount=0
[PlantSystem] c2f8a468: Processing effect: produce_seeds
[PlantSystem] c2f8a468: produce_seeds effect START - plant.seedsProduced=10
[PlantSystem] c2f8a468: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 10 â†’ 20
[PlantSystem] c2f8a468: Processing effect: drop_seeds
[PlantSystem] c2f8a468: disperseSeeds called - plant.seedsProduced=20, count param=undefined
[PlantSystem] c2f8a468: Dispersing 6 seeds in 3-tile radius
[PlantSystem] c2f8a468: Dispersed seed at (2.0, -2.0)
[PlantSystem] c2f8a468: Dispersed seed at (-2.0, -1.0)
[PlantSystem] c2f8a468: Dispersed seed at (-2.0, 2.0)
[PlantSystem] c2f8a468: Dispersed seed at (-2.0, 3.0)
[PlantSystem] c2f8a468: Dispersed seed at (0.0, -4.0)
[PlantSystem] c2f8a468: Placed 5/6 seeds in 3-tile radius (14 remaining)
[PlantSystem] c2f8a468: All effects complete - seedsProduced=14, flowerCount=0, fruitCount=0
Test: After update - stage=seeding, seedsProduced=14

stdout | packages/core/src/__tests__/PlantSeedProduction.test.ts > PlantSeedProduction Integration > should produce seeds correctly through full lifecycle vegetative â†’ mature â†’ seeding

Test: Initial - stage=vegetative, seedsProduced=0
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Active with 1 plants, accumulated 0.00 game hours
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 426f54c9: Age increased by 1.0000 days (5.00 â†’ 6.00) from 24.00 hours
[PlantSystem] 426f54c9: Test Plant (vegetative) age=6.0d progress=120% health=100
[PlantSystem] 426f54c9: test-plant stage vegetative â†’ mature (age=6.0d, health=100)
[PlantSystem] 426f54c9: Executing 1 transition effect(s) for vegetative â†’ mature
[PlantSystem] 426f54c9: Plant state before effects - seedsProduced=0, flowerCount=0, fruitCount=0
[PlantSystem] 426f54c9: Processing effect: produce_seeds
[PlantSystem] 426f54c9: produce_seeds effect START - plant.seedsProduced=0
[PlantSystem] 426f54c9: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 0 â†’ 10
[PlantSystem] 426f54c9: All effects complete - seedsProduced=10, flowerCount=0, fruitCount=0
Test: After vegetative â†’ mature - stage=mature, seedsProduced=10
[PlantSystem] New day started - will advance all plants by 1 day (total pending: 1 days)
[PlantSystem] Processing 1 skipped day(s) = 24 hours for 1 plants
[PlantSystem] 426f54c9: Age increased by 1.0000 days (6.00 â†’ 7.00) from 24.00 hours
[PlantSystem] 426f54c9: Test Plant (mature) age=7.0d progress=133% health=100
[PlantSystem] 426f54c9: test-plant stage mature â†’ seeding (age=7.0d, health=100)
[PlantSystem] 426f54c9: Executing 2 transition effect(s) for mature â†’ seeding
[PlantSystem] 426f54c9: Plant state before effects - seedsProduced=10, flowerCount=0, fruitCount=0
[PlantSystem] 426f54c9: Processing effect: produce_seeds
[PlantSystem] 426f54c9: produce_seeds effect START - plant.seedsProduced=10
[PlantSystem] 426f54c9: produce_seeds effect EXECUTED - species.seedsPerPlant=10, yieldModifier=1.00, calculated=10, plant.seedsProduced 10 â†’ 20
[PlantSystem] 426f54c9: Processing effect: drop_seeds
[PlantSystem] 426f54c9: disperseSeeds called - plant.seedsProduced=20, count param=undefined
[PlantSystem] 426f54c9: Dispersing 6 seeds in 3-tile radius
[PlantSystem] 426f54c9: Dispersed seed at (-2.0, -2.0)
[PlantSystem] 426f54c9: Dispersed seed at (2.0, -2.0)
[PlantSystem] 426f54c9: Placed 2/6 seeds in 3-tile radius (14 remaining)
[PlantSystem] 426f54c9: All effects complete - seedsProduced=14, flowerCount=0, fruitCount=0
Test: After mature â†’ seeding - stage=seeding, seedsProduced=14

 âœ“ packages/core/src/__tests__/AnimalComponent.test.ts  (8 tests) 3ms
stdout | packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should transition hungry agent to seek_food behavior
[AISystem] Autonomic interrupt - hasQueue: false hasBehaviorQueue: false queuePaused: undefined
[AISystem] After update - queuePaused: undefined queueInterruptedBy: undefined

 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts  (6 tests | 3 failed) 7ms
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should respect think interval before updating behavior
     â†’ expected 0 to be greater than 0
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should handle behavior queue timeouts
     â†’ Cannot set property tick of #<WorldImpl> which has only a getter
   â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should enforce LLM rate limiting
     â†’ Cannot set property tick of #<WorldImpl> which has only a getter
 âœ“ packages/renderer/src/__tests__/GhostPreview.test.ts  (19 tests) 6ms
 âœ“ packages/core/src/systems/__tests__/VerificationTrust.integration.test.ts  (8 tests) 3ms
 âœ“ packages/core/src/components/__tests__/InventoryComponent.test.ts  (16 tests) 3ms
 âœ“ packages/core/src/systems/__tests__/AnimalSpawning.integration.test.ts  (10 tests) 2ms
 âœ“ packages/core/src/systems/__tests__/SleepSystem.integration.test.ts  (5 tests) 3ms
 âœ“ packages/core/src/systems/__tests__/CommunicationSocial.integration.test.ts  (7 tests) 3ms
 âœ“ packages/world/src/chunks/__tests__/Tile.test.ts  (10 tests) 3ms
 âœ“ packages/core/src/systems/__tests__/SoilDepletion.test.ts  (14 tests) 5ms
 âœ“ packages/core/src/components/__tests__/TrustNetworkComponent.test.ts  (18 tests) 4ms
 âœ“ packages/core/src/crafting/__tests__/CraftingSystem.test.ts  (14 tests) 6ms
 âœ“ packages/world/src/chunks/__tests__/Chunk.test.ts  (16 tests) 7ms
 âœ“ packages/core/src/systems/__tests__/HearingSystem.test.ts  (5 tests) 3ms
 âœ“ packages/core/src/systems/__tests__/SleepSystem.test.ts  (17 tests) 5ms
 âœ“ packages/core/src/components/__tests__/SpatialMemoryComponent.test.ts  (12 tests) 3ms
 âœ“ packages/world/src/terrain/__tests__/PerlinNoise.test.ts  (10 tests) 6ms
 âœ“ packages/core/src/systems/__tests__/WateringAction.test.ts  (10 tests) 3ms
stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should parse valid structured response
[ResponseParser] Structured response: {
  action: 'explore',
  thinking: 'I should explore to find food',
  speaking: 'Time to look around!'
}

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should handle response with no speaking
[ResponseParser] Structured response: {
  action: 'wander',
  thinking: 'Just going to wander',
  speaking: '(silent)'
}

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Structured JSON > should parse all 12 valid actions
[ResponseParser] Structured response: { action: 'wander', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'idle', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'seek_food', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'follow_agent', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'talk', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'gather', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'explore', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'approach', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'observe', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'rest', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'work', thinking: 'test', speaking: '(silent)' }
[ResponseParser] Structured response: { action: 'help', thinking: 'test', speaking: '(silent)' }

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Text Fallback > should parse plain text with action name
[ResponseParser] Text-based match: explore

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseResponse - Text Fallback > should find action anywhere in text
[ResponseParser] Text-based match: seek_food

 âœ“ packages/llm/src/__tests__/ResponseParser.test.ts  (12 tests) 5ms
stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseBehavior - Legacy API > should extract just the action from structured response
[ResponseParser] Structured response: { action: 'talk', thinking: 'test', speaking: 'hello' }

stdout | packages/llm/src/__tests__/ResponseParser.test.ts > ResponseParser > parseBehavior - Legacy API > should work with text response
[ResponseParser] Text-based match: idle

 âœ“ packages/core/src/ecs/__tests__/ComponentRegistry.test.ts  (9 tests) 3ms
 âœ“ packages/core/src/events/__tests__/EventBus.test.ts  (10 tests) 4ms
 â¯ packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts  (3 tests | 3 failed) 6ms
   â¯ packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts > MemoryConsolidationSystem + SleepSystem + MemorySystem Integration > should consolidation system process sleeping agents
     â†’ Cannot read properties of undefined (reading 'subscribe')
   â¯ packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts > MemoryConsolidationSystem + SleepSystem + MemorySystem Integration > should sleep system affect memory decay
     â†’ Cannot read properties of undefined (reading 'decayRate')
   â¯ packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts > MemoryConsolidationSystem + SleepSystem + MemorySystem Integration > should awake agents not trigger consolidation
     â†’ Cannot read properties of undefined (reading 'subscribe')
 â¯ packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts  (3 tests | 3 failed) 6ms
   â¯ packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts > ReflectionSystem + MemorySystem + JournalingSystem Integration > should reflection system process agents
     â†’ Cannot read properties of undefined (reading 'subscribe')
   â¯ packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts > ReflectionSystem + MemorySystem + JournalingSystem Integration > should journaling system integrate with reflection
     â†’ Cannot read properties of undefined (reading 'subscribe')
   â¯ packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts > ReflectionSystem + MemorySystem + JournalingSystem Integration > should memory system work with reflection system
     â†’ Cannot read properties of undefined (reading 'subscribe')
 âœ“ packages/core/src/actions/__tests__/AgentAction.test.ts  (12 tests) 3ms
 âœ“ packages/core/src/ecs/__tests__/Entity.test.ts  (10 tests) 3ms
 âœ“ packages/world/src/chunks/__tests__/ChunkManager.test.ts  (9 tests) 9ms
 âœ“ packages/core/src/systems/__tests__/BehaviorQueueIntegration.test.ts  (5 tests) 2ms
 â¯ packages/core/src/systems/__tests__/BeliefFormation.integration.test.ts  (2 tests | 1 failed) 4ms
   â¯ packages/core/src/systems/__tests__/BeliefFormation.integration.test.ts > BeliefFormationSystem + MemorySystem + SocialSystem Integration > should beliefs integrate with memory system
     â†’ expected undefined not to be undefined
 âœ“ packages/core/src/systems/__tests__/SpatialMemory.integration.test.ts  (2 tests) 3ms
 âœ“ packages/core/src/systems/__tests__/VerificationSystem.debug.test.ts  (1 test) 2ms
stdout | packages/core/src/systems/__tests__/VerificationSystem.debug.test.ts > VerificationSystem Debug > should find verifiers with correct component names

=== DEBUG: Component names on entity ===
  "agent": (type field: "agent")
  "position": (type field: "position")
  "social_gradient": (type field: "social_gradient")

=== DEBUG: Component checks ===
  has("agent"): true
  has("position"): true
  has("social_gradient"): true

=== DEBUG: Verifier filter results ===
  Total entities: 1
  Verifiers found: 1

 â†“ packages/renderer/src/__tests__/BuildingPlacementUI.test.ts  (1 test | 1 skipped)
 â†“ packages/renderer/src/__tests__/AgentInfoPanel-thought-speech.test.ts  (19 tests | 19 skipped)
 âœ“ packages/renderer/src/__tests__/CraftingPanelUI.test.ts  (46 tests) 58ms
 âœ“ packages/renderer/src/__tests__/InventoryUI.integration.test.ts  (43 tests) 72ms
stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 1: Inventory Panel Opens and Closes > should open inventory when I key is pressed
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 1: Inventory Panel Opens and Closes > should open inventory when Tab key is pressed
[InventoryUI] Toggled inventory via 'Tab': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 1: Inventory Panel Opens and Closes > should close inventory when pressing I while open
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 1: Inventory Panel Opens and Closes > should close inventory when pressing Escape while open
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Closed inventory via Escape: isOpen=false

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 1: Inventory Panel Opens and Closes > should toggle inventory multiple times without errors
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 2: Equipment Section Displays > should display equipment section when inventory is open
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 2: Equipment Section Displays > should display all equipment slots
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 3: Backpack Grid System > should display backpack grid with configured dimensions
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 3: Backpack Grid System > should render all backpack items
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 3: Backpack Grid System > should handle empty slots correctly
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 3: Backpack Grid System > should render to canvas without errors
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 4: Item Tooltips > should show tooltip when hovering over item
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] handleMouseMove - slotRef: { type: 'backpack', index: 0 }
[InventoryUI] handleMouseMove - slot: { itemId: 'wood', quantity: 10 }
[InventoryUI] handleMouseMove - setting hoveredSlot for item: wood

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 4: Item Tooltips > should hide tooltip when not hovering over any item
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 4: Item Tooltips > should update tooltip when moving between items
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] handleMouseMove - slotRef: { type: 'backpack', index: 0 }
[InventoryUI] handleMouseMove - slot: { itemId: 'wood', quantity: 10 }
[InventoryUI] handleMouseMove - setting hoveredSlot for item: wood

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 5: Drag and Drop - Basic Movement > should start drag operation on mouse down
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 5: Drag and Drop - Basic Movement > should update drag position during mouse move
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 5: Drag and Drop - Basic Movement > should handle drag without inventory set gracefully
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 17: Keyboard Shortcuts > should handle uppercase I key
[InventoryUI] Toggled inventory via 'I': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 17: Keyboard Shortcuts > should handle lowercase i key
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 17: Keyboard Shortcuts > should handle Tab key
[InventoryUI] Toggled inventory via 'Tab': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Acceptance Criterion 17: Keyboard Shortcuts > should handle Escape key
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Closed inventory via Escape: isOpen=false

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Rendering Integration > should render backdrop when inventory is open
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Rendering Integration > should render panel centered on screen
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Rendering Integration > should handle small screen sizes gracefully
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Rendering Integration > should handle very large screen sizes gracefully
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Edge Cases > should handle inventory with all empty slots
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Edge Cases > should handle inventory with maximum items
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Edge Cases > should handle very large quantities
[InventoryUI] Toggled inventory via 'i': isOpen=true

stdout | packages/renderer/src/__tests__/InventoryUI.integration.test.ts > InventoryUI Integration Tests > Edge Cases > should handle rapid toggling without state corruption
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false
[InventoryUI] Toggled inventory via 'i': isOpen=true
[InventoryUI] Toggled inventory via 'i': isOpen=false

 âœ“ packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts  (32 tests) 101ms
stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should render inventory section below needs section when agent is selected
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should render inventory divider line before inventory section
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 1: Inventory Section Appears > should not render inventory section if agent has no inventory component
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display wood resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display stone resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display food resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display water resources with icon and quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should display all resource types simultaneously
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 2: Resource Counts Display > should not display resources with zero quantity
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 3: Empty Inventory State > should show "(empty)" when inventory has no items
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 3: Empty Inventory State > should show capacity as "Weight: 0/100 Slots: 0/8" when empty
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should display current weight and max weight
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should display current slots and max slots
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 4: Capacity Display > should calculate weight correctly for mixed resources
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use white color when weight is below 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use yellow color when weight exceeds 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use red color when weight reaches 100%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use yellow color when slots exceed 80%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 5: Capacity Warning Colors > should use red color when slots reach 100%
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should reflect inventory changes when entity is re-rendered
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should update capacity display when weight changes
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Acceptance Criterion 6: Real-time Updates > should show empty state when all resources are consumed
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxWeight is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxWeight is undefined
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.slots is not an array
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.slots is null
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.currentWeight is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Error Handling (per CLAUDE.md) > should throw when inventory.maxSlots is missing
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle inventory with only empty slots
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle inventory with partial slots filled
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should handle very large resource quantities
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stdout | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should not overflow panel bounds with many resources
[AgentInfoPanel] setSelectedEntity called with: test-agent-12345678

stderr | packages/renderer/src/__tests__/AgentInfoPanel-inventory.test.ts > AgentInfoPanel - Inventory Display > Edge Cases > should not overflow panel bounds with many resources
[AgentInfoPanel] World not available or missing getEntity method


âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯ Failed Tests 91 âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯

 FAIL  packages/core/src/__tests__/AnimalProduction.test.ts > Animal Production System > Acceptance Criterion 7: Animal Products - Periodic > should produce quantity within min/max range
AssertionError: expected undefined to be 1 // Object.is equality

- Expected: 
1

+ Received: 
undefined

 â¯ packages/core/src/__tests__/AnimalProduction.test.ts:125:39
    123| 
    124|       // Eggs typically 1 per day (we set minQuantity=1, maxQuantity=1)
    125|       expect(eventCall.data.quantity).toBe(1);
       |                                       ^
    126|     });
    127| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/91]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should propagate events to multiple listening systems
TypeError: Cannot read properties of undefined (reading 'subscribe')
 â¯ MemoryFormationSystem._setupEventListeners packages/core/src/systems/MemoryFormationSystem.ts:151:21
    149| 
    150|     for (const eventType of memoryEventTypes) {
    151|       this.eventBus.subscribe(eventType as any, (event) => {
       |                     ^
    152|         this._handleMemoryTrigger(eventType as any, event.data as Memoâ€¦
    153|       });
 â¯ new MemoryFormationSystem packages/core/src/systems/MemoryFormationSystem.ts:32:10
 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:37:26

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/91]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should maintain event ordering: time â†’ weather â†’ temperature
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:97:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/91]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should allow event listeners to modify world state
AssertionError: expected 100 to be 50 // Object.is equality

- Expected
+ Received

- 50
+ 100

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:222:26
    220|     // Agent's state should be modified
    221|     const needs = agent.getComponent('needs') as any;
    222|     expect(needs.hunger).toBe(50);
       |                          ^
    223|   });
    224| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/91]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should support multiple subscribers to same event
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:257:31
    255| 
    256|     // All subscribers should be called
    257|     expect(subscriber1Called).toBe(true);
       |                               ^
    258|     expect(subscriber2Called).toBe(true);
    259|     expect(subscriber3Called).toBe(true);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[5/91]âŽ¯

 FAIL  packages/core/src/__tests__/EventBusPropagation.integration.test.ts > EventBus Propagation Integration > should properly unsubscribe event listeners
AssertionError: expected +0 to be 1 // Object.is equality

- Expected
+ Received

- 1
+ 0

 â¯ packages/core/src/__tests__/EventBusPropagation.integration.test.ts:278:23
    276|     });
    277| 
    278|     expect(callCount).toBe(1);
       |                       ^
    279| 
    280|     // Unsubscribe

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[6/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should query memory, navigate to location, and arrive successfully
TypeError: entities.filter is not a function
 â¯ SpatialMemoryQuerySystem.update packages/core/src/systems/SpatialMemoryQuerySystem.ts:27:37
     25|   update(_world: World, entities: ReadonlyArray<Entity>, currentTick: â€¦
     26|     // Get entities with both spatial and episodic memory
     27|     const memoryEntities = entities.filter(e =>
       |                                     ^
     28|       e.components.has('SpatialMemory') &&
     29|       e.components.has('EpisodicMemory')
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:53:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[7/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Navigation Flow: Memory â†’ Navigation â†’ Arrival > should navigate across chunk boundaries without issues
AssertionError: expected 250 to be greater than 256
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:94:26
     92| 
     93|       // Should have crossed boundary
     94|       expect(position.x).toBeGreaterThan(256);
       |                          ^
     95|       expect(position.y).toBeGreaterThan(256);
     96|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[8/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should parse gradient from speech, store it, and navigate
TypeError: Cannot read properties of undefined (reading 'length')
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:129:39
    127| 
    128|       const socialGradient = listener.getComponent('SocialGradient');
    129|       expect(socialGradient.gradients.length).toBeGreaterThan(0);
       |                                       ^
    130| 
    131|       // Navigation should use gradient

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[9/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Social Gradient Communication Flow: Broadcast â†’ Parse â†’ Navigate > should blend multiple gradients from different agents
TypeError: Cannot read properties of undefined (reading 'length')
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:165:39
    163| 
    164|       const socialGradient = listener.getComponent('SocialGradient');
    165|       expect(socialGradient.gradients.length).toBe(2);
       |                                       ^
    166| 
    167|       // Blending should produce northeast direction

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[10/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should verify accurate claim and increase trust
AssertionError: expected 0.5 to be greater than 0.5
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:223:24
    221| 
    222|       // Trust should increase
    223|       expect(bobTrust).toBeGreaterThan(0.5);
       |                        ^
    224|     });
    225| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[11/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Trust & Verification Flow: Claim â†’ Navigate â†’ Verify â†’ Update Trust > should detect false claim and decrease trust
AssertionError: expected 0.5 to be less than 0.5
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:256:24
    254| 
    255|       // Trust should decrease
    256|       expect(bobTrust).toBeLessThan(0.5);
       |                        ^
    257|     });
    258|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[12/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should form belief after 3 accurate claims from agent
TypeError: entities.filter is not a function
 â¯ BeliefFormationSystem.update packages/core/src/systems/BeliefFormationSystem.ts:35:32
     33| 
     34|     // OPTIMIZATION: Belief formation only happens during sleep (memorâ€¦
     35|     const believers = entities.filter(e =>
       |                                ^
     36|       e.components.has('Belief') &&
     37|       e.components.has('EpisodicMemory') &&
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:288:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[13/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Belief Formation Flow: Pattern Detection â†’ Belief Creation > should update belief confidence with new evidence
TypeError: entities.filter is not a function
 â¯ BeliefFormationSystem.update packages/core/src/systems/BeliefFormationSystem.ts:35:32
     33| 
     34|     // OPTIMIZATION: Belief formation only happens during sleep (memorâ€¦
     35|     const believers = entities.filter(e =>
       |                                ^
     36|       e.components.has('Belief') &&
     37|       e.components.has('EpisodicMemory') &&
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:322:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[14/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > Complete Exploration Flow: Frontier â†’ Navigate â†’ Mark Explored > should explore frontier sectors systematically
AssertionError: expected 1 to be greater than 1
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:359:34
    357| 
    358|       // Should have explored more sectors
    359|       expect(finalExplored.size).toBeGreaterThan(initialExplored.size);
       |                                  ^
    360|     });
    361|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[15/91]âŽ¯

 FAIL  packages/core/src/__tests__/NavigationIntegration.test.ts > Navigation & Exploration - Integration Tests > AC8: Epistemic Humility Emergence > should show epistemic humility after trust violations
TypeError: world.getLLMContext is not a function
 â¯ packages/core/src/__tests__/NavigationIntegration.test.ts:386:29
    384| 
    385|       // LLM context should include trust/belief info
    386|       const context = world.getLLMContext(agent);
       |                             ^
    387| 
    388|       expect(context).toContain('trust');

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[16/91]âŽ¯

 FAIL  packages/core/src/__tests__/TamingSystem.test.ts > Taming System > Acceptance Criterion 5: Taming System - Feeding Method > should successfully tame animal when attempt succeeds
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
+   Object {
+     "data": Object {
        "agentId": "agent-1",
        "animalId": "animal-4",
-       "method": "feeding",
+       "tamerId": "agent-1",
      },
      "source": "agent-1",
+     "tick": 0,
+     "timestamp": 1766648974764,
      "type": "animal_tamed",
    },
  ]


Number of calls: 1

 â¯ packages/core/src/__tests__/TamingSystem.test.ts:201:28
    199|       expect(animal.ownerId).toBe('agent-1');
    200|       expect(animal.bondLevel).toBeGreaterThan(0);
    201|       expect(eventHandler).toHaveBeenCalledWith(
       |                            ^
    202|         expect.objectContaining({
    203|           type: 'animal_tamed',

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[17/91]âŽ¯

 FAIL  packages/core/src/__tests__/TamingSystem.test.ts > Taming System > Acceptance Criterion 6: Bond System > should emit bond_level_changed event when bond increases across threshold
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
+   Object {
+     "data": Object {
        "agentId": "agent-1",
        "animalId": "animal-11",
-       "bondLevel": 41,
-       "newLevel": "friendly",
-       "oldLevel": "accepting",
+       "newLevel": 41,
+       "oldLevel": 39,
      },
      "source": "agent-1",
+     "tick": 0,
+     "timestamp": 1766648974770,
      "type": "bond_level_changed",
    },
  ]


Number of calls: 1

 â¯ packages/core/src/__tests__/TamingSystem.test.ts:453:28
    451|       eventBus.flush();
    452| 
    453|       expect(eventHandler).toHaveBeenCalledWith(
       |                            ^
    454|         expect.objectContaining({
    455|           type: 'bond_level_changed',

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[18/91]âŽ¯

 FAIL  packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include position in soil:tilled event
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "position": Object {
+   Object {
+     "data": Object {
        "x": 15,
        "y": 20,
-       },
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974718,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

 â¯ packages/core/src/actions/__tests__/TillAction.test.ts:454:23
    452|       eventBus.flush();
    453| 
    454|       expect(handler).toHaveBeenCalledWith(
       |                       ^
    455|         expect.objectContaining({
    456|           data: expect.objectContaining({

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[19/91]âŽ¯

 FAIL  packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include fertility in soil:tilled event
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "fertility": Any<Number>,
+   Object {
+     "data": Object {
+       "x": 5,
+       "y": 5,
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974723,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

 â¯ packages/core/src/actions/__tests__/TillAction.test.ts:485:23
    483|       eventBus.flush();
    484| 
    485|       expect(handler).toHaveBeenCalledWith(
       |                       ^
    486|         expect.objectContaining({
    487|           data: expect.objectContaining({

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[20/91]âŽ¯

 FAIL  packages/core/src/actions/__tests__/TillAction.test.ts > Tilling Action > EventBus Integration > should include biome in soil:tilled event
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "biome": "river",
+   Object {
+     "data": Object {
+       "x": 5,
+       "y": 5,
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974724,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

 â¯ packages/core/src/actions/__tests__/TillAction.test.ts:516:23
    514|       eventBus.flush();
    515| 
    516|       expect(handler).toHaveBeenCalledWith(
       |                       ^
    517|         expect.objectContaining({
    518|           data: expect.objectContaining({

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[21/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should respect think interval before updating behavior
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:68:38
     66|     aiSystem.update(harness.world, entities, 1 / 60);
     67|     const afterFirst = agent.getComponent('agent');
     68|     expect(afterFirst.lastThinkTick).toBeGreaterThan(0);
       |                                      ^
     69| 
     70|     // Immediate second tick - should NOT think (interval not met)

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[22/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should handle behavior queue timeouts
TypeError: Cannot set property tick of #<WorldImpl> which has only a getter
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:138:28
    136| 
    137|     // Advance world tick far past timeout
    138|     (harness.world as any).tick = 200;
       |                            ^
    139| 
    140|     const entities = Array.from(harness.world.entities.values());

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[23/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AISystem.integration.test.ts > AISystem + ActionQueue Integration > should enforce LLM rate limiting
TypeError: Cannot set property tick of #<WorldImpl> which has only a getter
 â¯ packages/core/src/systems/__tests__/AISystem.integration.test.ts:168:28
    166| 
    167|     // First update - might call LLM
    168|     (harness.world as any).tick = 0;
       |                            ^
    169|     aiSystem.update(harness.world, entities, 1 / 60);
    170| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[24/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 3: Building Completion > should include position in completion event
AssertionError: expected undefined to deeply equal { x: 42, y: 84 }

- Expected: 
Object {
  "x": 42,
  "y": 84,
}

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:269:35
    267| 
    268|       const event = eventSpy.mock.calls[0][0];
    269|       expect(event.data.position).toEqual({ x: 42, y: 84 });
       |                                   ^
    270|     });
    271|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[25/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts > Agent Building Orchestration - Phase 7 > Criterion 4: Agent Autonomous Building (Integration) > should emit construction:started event when construction begins
AssertionError: expected undefined to be 'tent' // Object.is equality

- Expected: 
"tent"

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/AgentBuildingOrchestration.test.ts:315:39
    313|       const event = eventSpy.mock.calls[0][0];
    314|       expect(event.type).toBe('construction:started');
    315|       expect(event.data.buildingType).toBe('tent');
       |                                       ^
    316|       expect(event.data.position).toEqual({ x: 10, y: 10 });
    317|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[26/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AnimalComplete.integration.test.ts > AnimalSystem + AnimalProductionSystem + AnimalHousingSystem Integration > should critical hunger cause health loss
AssertionError: expected 100 to be less than 100
 â¯ packages/core/src/systems/__tests__/AnimalComplete.integration.test.ts:175:34
    173| 
    174|     // Health should decrease from starvation
    175|     expect(updatedAnimal.health).toBeLessThan(initialHealth);
       |                                  ^
    176|   });
    177| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[27/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts > AnimalHousingSystem + AnimalSystem + BuildingSystem Integration > should building system integrate with housing system
Error: Unknown building type: chicken_coop. Cannot determine construction time.
 â¯ BuildingSystem.getConstructionTime packages/core/src/systems/BuildingSystem.ts:636:13
    634|     if (time === undefined) {
    635|       // Per CLAUDE.md: No silent fallbacks
    636|       throw new Error(`Unknown building type: ${buildingType}. Cannot â€¦
       |             ^
    637|     }
    638| 
 â¯ BuildingSystem.advanceConstruction packages/core/src/systems/BuildingSystem.ts:281:42
 â¯ BuildingSystem.update packages/core/src/systems/BuildingSystem.ts:257:14
 â¯ packages/core/src/systems/__tests__/AnimalHousing.integration.test.ts:185:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[28/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/BeliefFormation.integration.test.ts > BeliefFormationSystem + MemorySystem + SocialSystem Integration > should beliefs integrate with memory system
AssertionError: expected undefined not to be undefined
 â¯ packages/core/src/systems/__tests__/BeliefFormation.integration.test.ts:59:42
     57|     memorySystem.update(harness.world, entities, 1.0);
     58| 
     59|     expect(agent.getComponent('Belief')).toBeDefined();
       |                                          ^
     60|   });
     61| });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[29/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should track construction progress over time
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts:54:38
     52| 
     53|     // Progress should have increased
     54|     expect(updatedBuilding.progress).toBeGreaterThan(initialProgress);
       |                                      ^
     55|   });
     56| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[30/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should building placement confirmed event create building entity
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts:242:30
    240|     const finalEntityCount = harness.world.entities.size;
    241| 
    242|     expect(finalEntityCount).toBeGreaterThan(initialEntityCount);
       |                              ^
    243|   });
    244| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[31/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts > BuildingSystem + ResourceGathering + Inventory Integration > should construction progress be calculated based on buildTime
AssertionError: expected 0 to be greater than 40
 â¯ packages/core/src/systems/__tests__/BuildingConstruction.integration.test.ts:266:38
    264| 
    265|     // Progress should be approximately 50%
    266|     expect(updatedBuilding.progress).toBeGreaterThan(40);
       |                                      ^
    267|     expect(updatedBuilding.progress).toBeLessThan(100);
    268|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[32/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ConstructionProgress.test.ts > Construction Progress System - Phase 7 > Construction Completion > should emit "building:complete" event on completion
AssertionError: expected undefined to deeply equal { x: 16, y: 32 }

- Expected: 
Object {
  "x": 16,
  "y": 32,
}

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/ConstructionProgress.test.ts:182:35
    180|       expect(event.type).toBe('building:complete');
    181|       expect(event.data.buildingType).toBe('tent');
    182|       expect(event.data.position).toEqual({ x: 16, y: 32 });
       |                                   ^
    183|     });
    184| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[33/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ExplorationSystem.test.ts > ExplorationSystem > exploration coverage metrics > should emit event when coverage milestone reached
Error: ExplorationSystem failed for entity 617ff802-e449-4983-a156-5f6c1ac2bb77: Error: ExplorationSystem: Entity 617ff802-e449-4983-a156-5f6c1ac2bb77 missing required components for milestone event
 â¯ ExplorationSystem.update packages/core/src/systems/ExplorationSystem.ts:33:15
     31|       } catch (error) {
     32|         // Per CLAUDE.md, re-throw with context
     33|         throw new Error(`ExplorationSystem failed for entity ${entity.â€¦
       |               ^
     34|       }
     35|     }
 â¯ packages/core/src/systems/__tests__/ExplorationSystem.test.ts:316:14

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[34/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should weather system emit rain events that affect soil
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts:177:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[35/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts > SoilSystem + PlantSystem + WeatherSystem Integration > should soil system track daily updates
TypeError: Cannot set property tick of #<WorldImpl> which has only a getter
 â¯ packages/core/src/systems/__tests__/FarmingComplete.integration.test.ts:291:28
    289| 
    290|     // Advance world tick to trigger daily processing
    291|     (harness.world as any).tick = 0;
       |                            ^
    292|     soilSystem.update(harness.world, entities, 1.0);
    293| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[36/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should time advance through full day cycle
AssertionError: expected NaN to be less than 2
 â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts:48:43
     46| 
     47|     // Should have cycled back to approximately the same hour
     48|     expect(Math.abs(endHour - startHour)).toBeLessThan(2.0);
       |                                           ^
     49|   });
     50| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[37/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should weather change during day
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts:130:21

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[38/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should temperature vary with time of day
TypeError: actual value must be number or bigint, received "undefined"
 â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts:141:25
    139|     const morningHarness = createDawnWorld();
    140|     const morningTemp = morningHarness.getGameHour();
    141|     expect(morningTemp).toBeLessThan(12); // Before noon
       |                         ^
    142| 
    143|     // Midday should be warmer

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts > Complete Game Day Cycle Integration > should full day cycle emit all expected events
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/GameDayCycle.integration.test.ts:256:31
    254|     // Should have time-related events
    255|     const hourEvents = harness.getEmittedEvents('world:time:hour');
    256|     expect(hourEvents.length).toBeGreaterThan(0);
       |                               ^
    257|   });
    258| });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[40/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts > MemoryConsolidationSystem + SleepSystem + MemorySystem Integration > should consolidation system process sleeping agents
TypeError: Cannot read properties of undefined (reading 'subscribe')
 â¯ MemoryConsolidationSystem._setupEventListeners packages/core/src/systems/MemoryConsolidationSystem.ts:29:19
     27|   private _setupEventListeners(): void {
     28|     // Listen for consolidation triggers
     29|     this.eventBus.subscribe('agent:sleep_start', (event) => {
       |                   ^
     30|       const data = event.data as any;
     31|       if (!data.agentId) {
 â¯ new MemoryConsolidationSystem packages/core/src/systems/MemoryConsolidationSystem.ts:24:10
 â¯ packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts:31:33

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[41/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts > MemoryConsolidationSystem + SleepSystem + MemorySystem Integration > should sleep system affect memory decay
TypeError: Cannot read properties of undefined (reading 'decayRate')
 â¯ MemorySystem.update packages/core/src/systems/MemorySystem.ts:19:34
     17| 
     18|       // Decay and filter memories
     19|       const decayAmount = memory.decayRate * deltaTime;
       |                                  ^
     20|       const updatedMemories = memory.memories
     21|         .map((m) => ({
 â¯ packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts:78:18

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[42/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts > MemoryConsolidationSystem + SleepSystem + MemorySystem Integration > should awake agents not trigger consolidation
TypeError: Cannot read properties of undefined (reading 'subscribe')
 â¯ MemoryConsolidationSystem._setupEventListeners packages/core/src/systems/MemoryConsolidationSystem.ts:29:19
     27|   private _setupEventListeners(): void {
     28|     // Listen for consolidation triggers
     29|     this.eventBus.subscribe('agent:sleep_start', (event) => {
       |                   ^
     30|       const data = event.data as any;
     31|       if (!data.agentId) {
 â¯ new MemoryConsolidationSystem packages/core/src/systems/MemoryConsolidationSystem.ts:24:10
 â¯ packages/core/src/systems/__tests__/MemoryConsolidation.integration.test.ts:86:33

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[43/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts > MemoryConsolidationSystem > memory strengthening > should strengthen recalled memories
AssertionError: expected 0.79999952506223 to be greater than 0.8
 â¯ packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts:338:30
    336| 
    337|       const memory = memComp.episodicMemories[0];
    338|       expect(memory.clarity).toBeGreaterThan(0.8);
       |                              ^
    339|     });
    340| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[44/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts > MemoryConsolidationSystem > memory strengthening > should increase importance of repeatedly recalled memories
AssertionError: expected 0.5 to be greater than 0.5
 â¯ packages/core/src/systems/__tests__/MemoryConsolidationSystem.test.ts:364:31
    362| 
    363|       const finalImportance = memComp.episodicMemories[0].importance;
    364|       expect(finalImportance).toBeGreaterThan(initialImportance);
       |                               ^
    365|     });
    366|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[45/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should apply steering forces to velocity which affects movement
AssertionError: expected NaN to be greater than 10
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:88:29
     86| 
     87|     // Position should have changed
     88|     expect(finalPosition.x).toBeGreaterThan(startX);
       |                             ^
     89|     expect(finalPosition.y).toBeGreaterThan(startY);
     90|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[46/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should apply fatigue penalties to reduce movement speed
AssertionError: expected NaN to be greater than 0
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:118:27
    116| 
    117|     // Agent should have moved, but less than full speed
    118|     expect(distanceMoved).toBeGreaterThan(0);
       |                           ^
    119| 
    120|     // With 20% energy, speed multiplier is 0.6 (40% penalty)

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[47/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should handle obstacle avoidance with buildings
TypeError: Cannot read properties of undefined (reading 'velocityX')
 â¯ MovementSystem.update packages/core/src/systems/MovementSystem.ts:51:20
     49| 
     50|       // Skip if not moving
     51|       if (movement.velocityX === 0 && movement.velocityY === 0) {
       |                    ^
     52|         continue;
     53|       }
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:176:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[48/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/MovementSteering.integration.test.ts > MovementSystem + SteeringSystem Integration > should combined steering behavior use obstacle avoidance
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/MovementSteering.integration.test.ts:301:35
    299|     // Velocity should be adjusted to avoid obstacle
    300|     expect(velocity).toBeDefined();
    301|     expect(Math.abs(velocity.vy)).toBeGreaterThan(0); // Should have Yâ€¦
       |                                   ^
    302|   });
    303| });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[49/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should hunger not decay during sleep
AssertionError: expected 0 to be greater than or equal to 75
 â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts:108:31
    106| 
    107|     // Hunger should not have decayed significantly during sleep
    108|     expect(finalNeeds.hunger).toBeGreaterThanOrEqual(initialHunger - 5â€¦
       |                               ^
    109|   });
    110| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[50/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts > NeedsSystem + SleepSystem + TemperatureSystem Integration > should extreme cold temperature damage health
AssertionError: expected 100 to be less than 100
 â¯ packages/core/src/systems/__tests__/NeedsSleepHealth.integration.test.ts:150:31
    148| 
    149|     // Health should have decreased due to dangerous temperature
    150|     expect(finalNeeds.health).toBeLessThan(initialHealth);
       |                               ^
    151|   });
    152| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[51/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants advance growth over time
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:243:13
    241|     }
    242|     if (plant.hydration === undefined) {
    243|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    244|     }
    245|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:163:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:86:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[52/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plant health affect growth rate
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:243:13
    241|     }
    242|     if (plant.hydration === undefined) {
    243|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    244|     }
    245|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:163:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:194:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[53/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should plants emit stage transition events
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:243:13
    241|     }
    242|     if (plant.hydration === undefined) {
    243|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    244|     }
    245|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:163:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:230:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[54/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should multiple plants update independently
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:243:13
    241|     }
    242|     if (plant.hydration === undefined) {
    243|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    244|     }
    245|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:163:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:281:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[55/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts > PlantSystem + TimeSystem + SeedGathering Integration > should dead plants not grow
Error: Plant hydration not set - required for lifecycle
 â¯ PlantSystem.validatePlant packages/core/src/systems/PlantSystem.ts:243:13
    241|     }
    242|     if (plant.hydration === undefined) {
    243|       throw new Error('Plant hydration not set - required for lifecyclâ€¦
       |             ^
    244|     }
    245|     if (plant.nutrition === undefined) {
 â¯ PlantSystem.update packages/core/src/systems/PlantSystem.ts:163:14
 â¯ packages/core/src/systems/__tests__/PlantLifecycle.integration.test.ts:314:17

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[56/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts > ReflectionSystem + MemorySystem + JournalingSystem Integration > should reflection system process agents
TypeError: Cannot read properties of undefined (reading 'subscribe')
 â¯ ReflectionSystem._setupEventListeners packages/core/src/systems/ReflectionSystem.ts:32:19
     30| 
     31|   private _setupEventListeners(): void {
     32|     this.eventBus.subscribe('agent:sleep_start', (event) => {
       |                   ^
     33|       const data = event.data as any;
     34|       this.reflectionTriggers.set(data.agentId as string, {
 â¯ new ReflectionSystem packages/core/src/systems/ReflectionSystem.ts:28:10
 â¯ packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts:29:30

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[57/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts > ReflectionSystem + MemorySystem + JournalingSystem Integration > should journaling system integrate with reflection
TypeError: Cannot read properties of undefined (reading 'subscribe')
 â¯ ReflectionSystem._setupEventListeners packages/core/src/systems/ReflectionSystem.ts:32:19
     30| 
     31|   private _setupEventListeners(): void {
     32|     this.eventBus.subscribe('agent:sleep_start', (event) => {
       |                   ^
     33|       const data = event.data as any;
     34|       this.reflectionTriggers.set(data.agentId as string, {
 â¯ new ReflectionSystem packages/core/src/systems/ReflectionSystem.ts:28:10
 â¯ packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts:43:30

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[58/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts > ReflectionSystem + MemorySystem + JournalingSystem Integration > should memory system work with reflection system
TypeError: Cannot read properties of undefined (reading 'subscribe')
 â¯ ReflectionSystem._setupEventListeners packages/core/src/systems/ReflectionSystem.ts:32:19
     30| 
     31|   private _setupEventListeners(): void {
     32|     this.eventBus.subscribe('agent:sleep_start', (event) => {
       |                   ^
     33|       const data = event.data as any;
     34|       this.reflectionTriggers.set(data.agentId as string, {
 â¯ new ReflectionSystem packages/core/src/systems/ReflectionSystem.ts:28:10
 â¯ packages/core/src/systems/__tests__/ReflectionJournaling.integration.test.ts:61:30

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[59/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should trigger on week boundary (every 7 days)
TypeError: Cannot read properties of undefined (reading 'type')
 â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts:196:25
    194|       const reflection = reflectionComp.reflections[0];
    195| 
    196|       expect(reflection.type).toBe('deep');
       |                         ^
    197|     });
    198| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[60/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should trigger on season change
TypeError: Cannot read properties of undefined (reading 'type')
 â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts:220:25
    218|       const reflection = reflectionComp.reflections[0];
    219| 
    220|       expect(reflection.type).toBe('deep');
       |                         ^
    221|     });
    222| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[61/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should analyze memories since last deep reflection
TypeError: Cannot read properties of undefined (reading 'memoryIds')
 â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts:247:25
    245|       const reflection = reflectionComp.reflections[0];
    246| 
    247|       expect(reflection.memoryIds.length).toBeGreaterThan(5);
       |                         ^
    248|     });
    249| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[62/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should identify recurring themes in memories
TypeError: Cannot read properties of undefined (reading 'themes')
 â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts:285:25
    283|       const reflection = reflectionComp.reflections[0];
    284| 
    285|       expect(reflection.themes).toContain('farming');
       |                         ^
    286|     });
    287| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[63/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should update agent identity/values
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts:312:38
    310|       const identityBeliefs = semanticMem.getBeliefsbyCategory('identiâ€¦
    311| 
    312|       expect(identityBeliefs.length).toBeGreaterThan(0);
       |                                      ^
    313|     });
    314| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[64/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/ReflectionSystem.test.ts > ReflectionSystem > deep reflection > should create narrative summary
TypeError: Cannot read properties of undefined (reading 'narrative')
 â¯ packages/core/src/systems/__tests__/ReflectionSystem.test.ts:335:25
    333|       const reflection = reflectionComp.reflections[0];
    334| 
    335|       expect(reflection.narrative).toBeDefined();
       |                         ^
    336|       expect(reflection.narrative.length).toBeGreaterThan(50);
    337|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[65/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SaveLoad.integration.test.ts > Save/Load Persistence Integration > should preserve component data structure
AssertionError: expected undefined to be 75 // Object.is equality

- Expected: 
75

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/SaveLoad.integration.test.ts:62:35
     60|     expect(retrievedNeeds.energy).toBe(50);
     61|     expect(retrievedNeeds.health).toBe(80);
     62|     expect(retrievedNeeds.warmth).toBe(75);
       |                                   ^
     63|     expect(retrievedNeeds.comfort).toBe(85);
     64|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[66/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should social gradient component initialize
AssertionError: expected undefined not to be undefined
 â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts:53:35
     51|     agent.addComponent(gradient);
     52| 
     53|     expect(gradient.nearbyAgents).toBeDefined();
       |                                   ^
     54|     expect(gradient.socialForce).toBeDefined();
     55|     expect(gradient.socialForce.x).toBe(0);

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[67/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should gradients detect nearby agents
TypeError: Cannot read properties of undefined (reading 'length')
 â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts:79:35
     77| 
     78|     // Nearby agents should be detected
     79|     expect(gradient1.nearbyAgents.length).toBeGreaterThanOrEqual(0);
       |                                   ^
     80|   });
     81| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[68/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should trust levels influence social force
AssertionError: expected undefined not to be undefined
 â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts:103:35
    101| 
    102|     // Social force should be influenced by trust
    103|     expect(gradient1.socialForce).toBeDefined();
       |                                   ^
    104|   });
    105| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[69/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should low trust create repulsion
AssertionError: expected undefined not to be undefined
 â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts:127:35
    125| 
    126|     // Social force should exist (direction depends on implementation)
    127|     expect(gradient1.socialForce).toBeDefined();
       |                                   ^
    128|   });
    129| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[70/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should multiple agents create combined gradient field
TypeError: Cannot read properties of undefined (reading 'nearbyAgents')
 â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts:152:27
    150|     // Center agent should have social forces from all directions
    151|     const centerGradient = centerAgent.getComponent('SocialGradient') â€¦
    152|     expect(centerGradient.nearbyAgents.length).toBeGreaterThan(0);
       |                           ^
    153|   });
    154| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[71/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should gradient strength decay with distance
TypeError: Cannot read properties of undefined (reading 'nearbyAgents')
 â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts:172:21
    170|     // Nearby agents should have stronger influence than far agents
    171|     const gradient = agent1.getComponent('SocialGradient') as SocialGrâ€¦
    172|     expect(gradient.nearbyAgents).toBeDefined();
       |                     ^
    173|   });
    174| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[72/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SocialGradient.integration.test.ts > SocialGradientSystem + Memory + TrustNetwork Integration > should social force vectors have valid magnitude
TypeError: Cannot read properties of undefined (reading 'x')
 â¯ packages/core/src/systems/__tests__/SocialGradient.integration.test.ts:221:33
    219| 
    220|     // Initial force should be zero
    221|     expect(gradient.socialForce.x).toBe(0);
       |                                 ^
    222|     expect(gradient.socialForce.y).toBe(0);
    223| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[73/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC2: Navigation Reaches Targets > should avoid obstacles using ray-casting
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:111:37
    109| 
    110|       // Should steer away from obstacle (north or south)
    111|       expect(Math.abs(velocity.vy)).toBeGreaterThan(0);
       |                                     ^
    112|     });
    113| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[74/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > AC10: No Silent Fallbacks (CLAUDE.md Compliance) > should throw error for missing Position component
AssertionError: expected [Function] to throw error including 'Position' but got 'SteeringSystem failed for entity ce6aâ€¦'

- Expected
+ Received

- Position
+ SteeringSystem failed for entity ce6af83b-ffd9-4189-9162-8ae34f467213: Error: SteeringSystem requires position component

 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:255:10
    253|       expect(() => {
    254|         system.update(world, world.getAllEntities(), 1.0);
    255|       }).toThrow('Position');
       |          ^
    256|     });
    257| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[75/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/SteeringSystem.test.ts > SteeringSystem > combined behaviors > should blend seek and obstacle avoidance
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/SteeringSystem.test.ts:303:37
    301|       // Should both seek target AND avoid obstacle
    302|       expect(velocity.vx).toBeGreaterThan(0); // Still moving toward tâ€¦
    303|       expect(Math.abs(velocity.vy)).toBeGreaterThan(0); // But steerinâ€¦
       |                                     ^
    304|     });
    305|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[76/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/StorageDeposit.test.ts > Storage Deposit System > Criterion 2: Deposit Behavior Handler > should emit items:deposited event with correct data
AssertionError: expected undefined to be 'stone' // Object.is equality

- Expected: 
"stone"

+ Received: 
undefined

 â¯ packages/core/src/systems/__tests__/StorageDeposit.test.ts:268:45
    266|       expect(eventData.storageId).toBe(storage.id);
    267|       expect(eventData.items).toHaveLength(1);
    268|       expect(eventData.items[0].resourceId).toBe('stone');
       |                                             ^
    269|       expect(eventData.items[0].quantity).toBe(10);
    270|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[77/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TamingComplete.integration.test.ts > TamingSystem + AnimalSystem + InventorySystem Integration > should failed taming still increase trust
Error: Unknown animal species: wolf
 â¯ Module.getAnimalSpecies packages/core/src/data/animalSpecies.ts:427:11
    425|   const species = ANIMAL_SPECIES[speciesId];
    426|   if (!species) {
    427|     throw new Error(`Unknown animal species: ${speciesId}`);
       |           ^
    428|   }
    429|   return species;
 â¯ TamingSystem.attemptTaming packages/core/src/systems/TamingSystem.ts:52:21
 â¯ packages/core/src/systems/__tests__/TamingComplete.integration.test.ts:145:20

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[78/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with position data
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "position": Object {
+   Object {
+     "data": Object {
        "x": 5,
        "y": 5,
      },
-     },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974722,
      "type": "soil:tilled",
    },
  ]


Number of calls: 1

 â¯ packages/core/src/systems/__tests__/TillingAction.test.ts:273:23
    271|       eventBus.flush();
    272| 
    273|       expect(handler).toHaveBeenCalledWith(
       |                       ^
    274|         expect.objectContaining({
    275|           type: 'soil:tilled',

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[79/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with fertility data
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "fertility": Any<Number>,
+   Object {
+     "data": Object {
+       "x": 5,
+       "y": 5,
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974726,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

 â¯ packages/core/src/systems/__tests__/TillingAction.test.ts:291:23
    289|       eventBus.flush();
    290| 
    291|       expect(handler).toHaveBeenCalledWith(
       |                       ^
    292|         expect.objectContaining({
    293|           data: expect.objectContaining({

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[80/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TillingAction.test.ts > Tilling Action > Acceptance Criterion 7: EventBus Integration > should emit soil:tilled event with biome data
AssertionError: expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "data": ObjectContaining {
-       "biome": "plains",
+   Object {
+     "data": Object {
+       "x": 5,
+       "y": 5,
      },
+     "source": "soil-system",
+     "tick": 0,
+     "timestamp": 1766648974727,
+     "type": "soil:tilled",
    },
  ]


Number of calls: 1

 â¯ packages/core/src/systems/__tests__/TillingAction.test.ts:308:23
    306|       eventBus.flush();
    307| 
    308|       expect(handler).toHaveBeenCalledWith(
       |                       ^
    309|         expect.objectContaining({
    310|           data: expect.objectContaining({

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[81/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should emit events in correct order: time â†’ weather â†’ temperature
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:66:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[82/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should show temperature variation over day/night cycle
AssertionError: expected 17.30563420590567 to be greater than or equal to 18.51462008078213
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:160:22
    158| 
    159|     // Noon should be warmer than dawn, night should be cooler
    160|     expect(noonTemp).toBeGreaterThanOrEqual(dawnTemp - 1); // Allow smâ€¦
       |                      ^
    161|     expect(nightTemp).toBeLessThanOrEqual(dawnTemp + 1);
    162|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[83/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should weather transitions affect temperature over time
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:199:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[84/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts > TimeSystem + WeatherSystem + TemperatureSystem Integration > should time speed multiplier affect weather duration correctly
TypeError: Cannot read properties of undefined (reading 'duration')
 â¯ WeatherSystem.update packages/core/src/systems/WeatherSystem.ts:24:47
     22| 
     23|       // Tick down duration
     24|       const newDuration = Math.max(0, weather.duration - deltaTime);
       |                                               ^
     25| 
     26|       impl.updateComponent<WeatherComponent>('weather', (current) => ({
 â¯ packages/core/src/systems/__tests__/TimeWeatherTemperature.integration.test.ts:286:19

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[85/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should verify resource claim when agent arrives at location
AssertionError: expected 0.09999999999999998 to be greater than 0.5
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:71:21
     69| 
     70|       // Verifier's trust in claimant should increase for correct claim
     71|       expect(trust).toBeGreaterThan(0.5);
       |                     ^
     72|     });
     73| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[86/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect stale information (resource depleted)
AssertionError: expected 0.3 to be close to 0.4, received difference is 0.10000000000000003, but expected 0.005
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:101:21
     99| 
    100|       // Minor penalty for stale info (-0.1)
    101|       expect(trust).toBeCloseTo(0.4, 2);
       |                     ^
    102|     });
    103| 

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[87/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC5: Verification Updates Trust > should detect pattern of unreliable information
AssertionError: expected 0.3 to be less than 0.2
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:201:21
    199| 
    200|       // Severe penalty for pattern (-0.8)
    201|       expect(trust).toBeLessThan(0.2);
       |                     ^
    202|     });
    203|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[88/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > AC7: Trust Affects Cooperation - Public Callouts > should broadcast correction for false information
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:232:33
    230| 
    231|       // Should broadcast correction
    232|       expect(broadcasts.length).toBeGreaterThan(0);
       |                                 ^
    233|       expect(broadcasts[0].data.message).toContain('no wood');
    234|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[89/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification range > should verify when agent reaches claimed location
AssertionError: expected 0.09999999999999998 to be greater than 0.5
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:298:21
    296|       // Verification should occur - verifier's trust in claimant shouâ€¦
    297|       const trust = trustNetwork.getTrustScore('alice');
    298|       expect(trust).toBeGreaterThan(0.5); // Should increase from defaâ€¦
       |                     ^
    299|     });
    300|   });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[90/91]âŽ¯

 FAIL  packages/core/src/systems/__tests__/VerificationSystem.test.ts > VerificationSystem > verification events > should emit trust_verified event for correct claims
AssertionError: expected 0 to be greater than 0
 â¯ packages/core/src/systems/__tests__/VerificationSystem.test.ts:404:29
    402|       system.update(world, world.getAllEntities(), 200);
    403| 
    404|       expect(events.length).toBeGreaterThan(0);
       |                             ^
    405|       expect(events[0].data.result).toBe('correct');
    406|     });

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[91/91]âŽ¯

 Test Files  30 failed | 74 passed | 2 skipped (106)
      Tests  91 failed | 1680 passed | 57 skipped (1828)
   Start at  23:49:34
   Duration  2.90s (transform 2.20s, setup 19.20s, collect 4.51s, tests 883ms, environment 871ms, prepare 3.74s)

