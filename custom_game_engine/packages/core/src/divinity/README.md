# Divinity System

**Location**: `packages/core/src/divinity/`

Core types and systems for emergent divinity gameplay. Gods exist because mortals believe in them.

## Overview

Emergent divine entities shaped by worshipper beliefs, prayers, and myths. Deities spend **belief** (faith resource) to perform miracles, create angels, manifest avatars, and interact with pantheons. Identity emerges from stories rather than preset designs.

## Key Concepts

### Belief Economy
- **Belief**: Primary divine resource, generated by worship activities (passive faith, prayer, ritual, sacrifice, miracle witnessing)
- **Thresholds**: Power tiers unlock at 10/100/500/2000/5000 belief
- **Decay**: Unused belief decays; inactive deities fade to dormancy

### Deities
- **Domains**: 28 domains (harvest, war, wisdom, death, etc.) define deity specialization
- **Identity**: Emergent from myths, prayers, and perceived actions (not hardcoded)
- **Alignment**: Moral spectrum (law/chaos, good/evil) shaped by followers
- **Origin**: Player-controlled or AI-emergent from worship patterns

### Divine Powers
- **Categories**: Miracles, visions, blessings, curses, manifestations, creation, transformation
- **Costs**: Domain-aligned powers cost less; off-domain powers risk identity conflicts
- **Visibility**: Public miracles generate more belief but attract rival attention

### Prayers & Miracles
- **Prayer Types**: Gratitude, petition, intercession, confession, dedication
- **Responses**: Deities answer prayers by spending belief
- **Attribution**: Mortals attribute events to deities (can misattribute natural events)

### Angels & Avatars
- **Angels**: Divine servants (messengers, guardians, warriors). Ranked (seraph > cherub > guardian). Require 2000 belief to create, ongoing maintenance costs.
- **Avatars**: Physical manifestations of deities. Limited duration, high maintenance, vulnerable to harm.

### Myths & Stories
- **Categories**: Creation, miracle tales, parables, warnings, relationship stories
- **Mutation**: Stories change through retelling (embellishment, distortion, fusion)
- **Canonization**: Popular myths become holy texts, shape deity identity

### Pantheons
- **Relationships**: Rivalry, alliance, neutrality between deities
- **Politics**: Divine councils, treaties, conflicts over domains
- **Chat System**: Real-time deity communication (public rooms, private DMs)

### Religion
- **Temples**: Sacred sites boost belief generation
- **Priests**: Religious specialists perform rituals, interpret doctrine
- **Holy Texts**: Codified mythology with canonical status
- **Movements**: Schisms, syncretism, conversions

### Multiverse
- **Crossing**: Deities can cross universes (high belief cost, compatibility matters)
- **Passages**: Permanent portals, collective passages, divine projections
- **Presence Extension**: Maintain influence across multiple universes

### Afterlife
- **Policies**: Judgment, reincarnation, transformation, annihilation
- **Criteria**: Deeds, devotion, alignment determine soul fate
- **Underworld**: Death domain primordial manages default policy

## Main Classes

**Types** (no systems - all type definitions):
- `BeliefTypes.ts` - Belief generation, decay, thresholds
- `DeityTypes.ts` - Deity structure, identity, domains
- `DivinePowerTypes.ts` - Powers, prayers, blessings, curses
- `MythTypes.ts` - Stories, mutation, canonization
- `PantheonTypes.ts` - Relationships, politics, conflicts
- `AngelTypes.ts` - Divine servants, ranks, abilities
- `AvatarTypes.ts` - Physical manifestations
- `ReligionTypes.ts` - Temples, priests, rituals, texts
- `DivineChatTypes.ts` - God communication system

**Utilities**:
- `VisionDeliverySystem.ts` - Send visions to mortals
- `LLMVisionGenerator.ts` - Generate vision content via LLM
- `AttributionSystem.ts` - Mortals attributing events to deities
- `MultiverseCrossing.ts` - Cross-universe deity mechanics
- `AIGodPersonality.ts` - Emergent deity personality generation
- `UniverseConfig.ts` - Per-universe divinity settings/presets

**Entity Helpers**:
- `GodOfDeathEntity.ts` - Underworld deity singleton
- `GoddessOfWisdomEntity.ts` - Wisdom deity singleton
- `RiddleGenerator.ts` - Generate wisdom challenges
- `SoulNameGenerator.ts` - Generate soul names by culture

**Race Templates**:
- `races/index.ts` - Divine/mythological races (angels, nymphs, valkyries, etc.) organized by pantheon

## Usage Example

```typescript
import {
  createEmergentIdentity,
  createPrayer,
  canUsePower,
  calculateBeliefGeneration,
  BELIEF_GENERATION_RATES
} from '@ai-village/core/divinity';

// Belief generation
const generation = calculateBeliefGeneration({
  faith: 0.8,
  devotionTime: 2.5,
  activityType: 'prayer',
  intensity: 1.0
}); // Returns belief points

// Prayer creation
const prayer = createPrayer({
  believerId: agentId,
  deityId: deityId,
  prayerType: 'petition',
  request: 'Bless our harvest',
  emotion: 'hopeful'
});

// Power usage check
const canUse = canUsePower(
  deity.belief.currentBelief,
  powerCost,
  deity.tier
); // Returns boolean
```

## Architecture

Pure type system - no ECS systems in this directory. Divinity components and systems live in:
- **Components**: `packages/core/src/components/DivineChatComponent.ts`
- **Systems**: `packages/divinity/` (dedicated package for runtime systems)

All divinity types export through `index.ts` with organized sections (Belief, Deity, Myth, Powers, Pantheon, Angels, Avatars, Religion, Multiverse, Race Templates).
